---
title: [WIP]实现一个基于Git的存储和自动构建服务
date: 2023-04-10T11:45:14+08:00
tags: [Development]
categories: [Development]
---

在后端处理题目方面，我经过长时间思索，最后感觉整个模型就是一个 Git + CI/CD。出题人通过 Git 将题目部署上去，然后平台自动根据对应的 Checker 类型来执行构建操作，并根据构建结果来确认题目状态，在选手访问题目时，就可以直接提供服务。这样一来，整套题目服务系统就能够高度自动化运作，出题人只需要写好build脚本，设置一下题目相关的配置文件然后推送上去就可以了。

但是…… Rust下面没有能够直接提供远程Git服务的crate啊，有一个libgit2的绑定，libgit2本来就没有服务端功能；有一个gixoide，大部分功能还在alpha……

于是我根据[Git文档](https://git-scm.com/book/zh/v2/Git-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86-%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE)手撸了一份HTTP协议处理。好，接下来是另一个大问题，内部协议怎么办？我总不能从头开始实现一个git吧…… 遇事不决看看现有方案怎么做的。于是我打开了Gitea。Gitea告诉我，你可以 subprocess.popen("git") ……

![啊？](https://files.catbox.moe/0up7lu.jpg)

那就这吧，我也popen……

彳亍了，这个大问题解决了。

接下来是 CI/CD 部分，这里我现在完全没有思路了，和 git 一样，网上也没找到一个合适的 crate 能当 runner 使的。整个技术栈似乎都是基于 golang 的，似乎没有冤大头来移植这个吃力不讨好的东西，那可能真的得自己写了，写完了估计都能当另一个毕设了，我在干什么啊.jpg
