---
title: Cyber Terminal å¼€å‘å°è®°
date: 2022-10-26T10:08:19+08:00
tags: [Development]
categories: [Development]
---

è®°å½•ä¸€äº›ç‹—è¡€å†ç¨‹, ä¾›å¤§å®¶å˜²ç¬‘.

## æŠ€æœ¯é€‰å‹

ã€€ã€€åœ¨å¼€å‘æ–°å¹³å°ä¹‹å‰, æˆ‘ä»”ç»†æ€è€ƒäº†ä¸€ä¸‹æˆ‘ä»¬çš„éœ€æ±‚:

> èƒ½å¤Ÿä¸€æ¬¡éƒ¨ç½²å¤šæ¬¡åŠæ¯”èµ›, åŒæ—¶å¸¸é©»ç»ƒä¹ å¹³å°, é™ä½è¿ç»´å‹åŠ›.

ã€€ã€€è€ƒè™‘åˆ°åä¼šæ¯å¹´è¦ä¸¾åŠçš„æ¯”èµ›è‡³å°‘æœ‰å››åœº:  MoeCTFã€Mini LCTFã€D3CTF/LCTFã€ä¸­å­¦ç”Ÿæ¯”èµ›, æ¯æ¬¡æ¯”èµ›ç»“æŸä¹‹åéƒ½è¦è¾›è‹¦è¿ç»´æŠŠæ‰€æœ‰é¢˜ç›®éƒ½æ¬è¿åˆ°archiveå¹³å°ä¸Š. å¯¹äºMoeCTFå’ŒMini LCTFæ¥è¯´, å¯èƒ½è¿˜éœ€è¦åœ¨archiveå¹³å°ä¸Šç›´æ¥ä¸¾åŠæ¯”èµ›, ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„CTFdå°±å‡ºç°äº†ä¸€äº›é—®é¢˜:

* åªèƒ½å¤Ÿä¸¾åŠå•æ¬¡æ¯”èµ›;
* éƒ¨ç½²å‡çº§ç¨éº»çƒ¦;
* æ€§èƒ½å­˜åœ¨å¾ˆå¤§é—®é¢˜;
* è¿ç§»åˆå¹¶æ¯”èµ›æ•°æ®ç®€ç›´æ˜¯ç¾éš¾;

ã€€ã€€ä¸ºäº†è®©ä»¥ååŠæ¯”èµ›ä¸å†è¿™ä¹ˆæŠ˜è…¾, è¿˜æ˜¯æ¢ä¸€ä¸ªå¹³å°æ¯”è¾ƒå¥½.

### å‰è¨€

ã€€ã€€ä»å‰å¹´æˆ‘è¿ç»´moeCTF 2020å¼€å§‹, æˆ‘å°±ä¸€ç›´è¯•å›¾å¯»æ‰¾ä¸€ä¸ªèƒ½è§£å†³CTFdç—›ç‚¹çš„æ–°å¹³å°. å…·ä½“äº†è§£è¿‡çš„å¹³å°ä¸æ’ä»¶æœ‰:

* èµµæ€»çš„ [buuoj.cn](https://buuoj.cn/), å¤šåœºæ¯”èµ›çš„è§£å†³æ–¹æ¡ˆä¼¼ä¹ä¸å¼€æº, ä¹Ÿä¸æ˜¯å¾ˆæƒ³ç»§ç»­åœ¨CTFdä¸Šåšmonkey edit;
* [HackTheBox](https://ctf.hackthebox.com/), ä¸å¼€æº, ä¸è¿‡æ¨¡å¼å¯ä»¥å‚è€ƒ;
* [Mellivora](https://github.com/Nakiami/mellivora), PHPå†™çš„, çœ‹äº†çœ‹åŠŸèƒ½æ„Ÿè§‰ä¹Ÿä¸å¤ªç¬¦åˆéœ€æ±‚.

ã€€ã€€ç„¶åä»20å¹´ç£¨è¹­åˆ°22å¹´ä¸ŠåŠå¹´, æœŸé—´ç»å†äº†å„ç§å„æ ·çš„éº»çƒ¦äº‹, ä¹Ÿæ²¡æœ‰æŠ½å‡ºæ¥æ•´å—æ•´å—çš„æ—¶é—´å†™è¾ƒå¤§çš„å·¥ç¨‹é¡¹ç›®, äºæ˜¯å°±ä¸€ç›´æç½®äº†.

ã€€ã€€ç„¶åå°±åˆ°äº†22å¹´çš„æš‘å‡å‰, å¤§æ¦‚äº”æœˆçš„æ—¶å€™.

> miniLå‰ä¸€ä¸ªæœˆ ğŸ‘´: ä»Šå¹´miniLå¿…ä¸Šæ–°å¹³å°
>
> miniLèµ›å‰ä¸¤å¤© ğŸ‘´: å†™ä¸å®Œäº†, å¯„, CTFdæ•‘æ•‘
>
> miniLç»“æŸä¹‹å ğŸ‘´: ä»Šå¹´MoeCTFå¿…ä¸Šæ–°å¹³å°
>

ã€€ã€€ç„¶åå°±å¼€å§‹è¿™åœºè‹¦é€¼æ—…é€”äº†.

### è¯­è¨€ï¼Ÿæ¡†æ¶ï¼Ÿ

ã€€ã€€å…ˆåè€ƒå¯Ÿäº†

* Java: è¯­è¨€å’Œç”Ÿæ€éƒ½å¾ˆæˆç†Ÿ, ä½†æ˜¯è¯»äº†è¯»ä¸€äº›æ®è¯´è´¨é‡å¾ˆé«˜çš„å¼€æºé¡¹ç›®, ä¸€ä¸ªå‡½æ•°èƒ½å¥—å‡ºæ¥`xxxWrapperHandlerControllerImpl`â€‹â€‹è¿™ç§åå­—â€¦â€¦;
* Python: åˆ°æˆ‘å¼€å†™çš„æ—¶å€™, Python 3.9è¿˜å¸¦ç€GIL, å•æ ¸æˆ˜å£«;
* C#: ä¹‹å‰å†™è¿‡ä¸€ç‚¹Winform, æ„Ÿè§‰è¿™é—¨è¯­è¨€çš„è®¾è®¡å¥½NB, äºæ˜¯å»çœ‹ASP.NETçš„æ–‡æ¡£, ä½†æ˜¯çœ‹äº†ä¸€éä¹Ÿæ²¡æ˜ç™½ä¸€æ¬¡è¯·æ±‚æ˜¯æ€ä¹ˆèµ°åˆ°Endpointçš„, è«åå…¶å¦™å°±è·‘èµ·æ¥äº†, ç»§ç»­å¾€ä¸‹è¯»è¢«å¾®è½¯çš„æœºç¿»æ–‡æ¡£å’Œå¥‡æ€ªçš„å…¼å®¹æ€§æ”¹åŠ¨åŠé€€;
* C++: è¿˜çœŸè€ƒè™‘è¿‡ç”¨Qtçš„SocketServerå†™ä¸€ä¸ª, ä½†â€¦â€¦ä½•å¿…å‘¢.jpg, ormå•¥çš„è½®å­è¿˜å¾—è‡ªå·±é€ ;
* NodeJS: è¯­è¨€æœ¬èº«ç‰¹æ€§å°±æŒºåŠé€€çš„;
* Go:  (åƒå®Œæ™š (æ—©ï¼Ÿ) é¥­çœ‹äº†å‡ ä¸ªå°æ—¶å…¥é—¨æ•™ç¨‹) å¥½ï¼å¤§é“è‡³ç®€ï¼æˆ‘ç°åœ¨æ˜¯Golangå¸¦å¸ˆï¼

ã€€ã€€äºæ˜¯æœ€åå…¥äº†goçš„å‘, Webè¯·æ±‚æ¡†æ¶ç”¨äº†gin, æ•°æ®åº“ç”¨äº†PostgreSQL + GORM.

ã€€ã€€åœ¨å‰ç«¯é€‰å‹ä¸Šçº ç»“äº†ä¸€ä¼šå„¿vueå’Œreact, æœ€ç»ˆé€‰æ‹©äº†vue3, æ„Ÿè§‰å‰ç«¯æ¡†æ¶ç”¨èµ·æ¥éƒ½å¤§å·®ä¸å·®, vue3çš„ç»„ç»‡æ–¹å¼æ›´ç¬¦åˆæˆ‘çš„ç›´è§‰ä¸€äº›.

ã€€ã€€å‰ç«¯ç»„ä»¶åº“ç”¨çš„è¿™ä¸ª: [Naive UI](https://www.naiveui.com/).

### SSRï¼ŸCSRï¼Ÿ

ã€€ã€€å…¶å®æˆ‘æ˜¯æ¯”è¾ƒåå‘æœåŠ¡ç«¯æ¸²æŸ“çš„, è¿™æ ·ç”¨æˆ·ç‚¹å¼€é¡µé¢å°±èƒ½çœ‹è§ä¿¡æ¯, å‰ç«¯ç¼–å†™éš¾åº¦ä¹Ÿä¼šé™ä½ä¸€äº›, ä¸ç”¨ä¸ºäº†ä¸€äº›å¼‚æ­¥è¯·æ±‚æå ä½ç¬¦ã€skeletonå•¥çš„. ä¸è¿‡è€ƒå¯Ÿäº†ä¸€åœˆå­vueçš„åº“å‘ç°æƒ…å†µå¹¶æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆå¥½, å¤§éƒ¨åˆ†æ–¹æ¡ˆéƒ½æ˜¯é’ˆå¯¹NodeJSä½œä¸ºåç«¯çš„, è€Œä¸”å¹¶æ²¡æœ‰ä¸€ä¸ªèƒ½è·Ÿgoåç«¯é…åˆå¾ˆå¥½è¿˜ç‰¹æ€§ç¨³å®šçš„æ–¹æ¡ˆ. åŸºæœ¬ä¸Šæœèµ·æ¥go+vueéƒ½æ˜¯å‰åç«¯åˆ†ç¦»å¼é¡¹ç›®.

ã€€ã€€åæ¥å†³å®šä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“, å› ä¸ºå‰åç«¯éƒ½åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Š, å€’ä¹Ÿä¸å¤ªæ‹…å¿ƒä¼šå¯¹ç”¨æˆ·ä½“éªŒé€ æˆä»€ä¹ˆå¤ªå¤§çš„å½±å“.

ã€€ã€€æœ€åå†³å®šä¸‹æ¥å°±æ‹¿ Go å’Œ Vue 3 å†™ä¸€ä¸ªå‰åç«¯åˆ†ç¦»å¼çš„å¹³å°äº†.

## æ•°æ®åº“è®¾è®¡

ã€€ã€€æŠ€æœ¯æ ˆç¡®è®¤ä¸‹æ¥ä¹‹å, æ¥ä¸‹æ¥ç®€å•æ­å»ºäº†ä¸€ä¸‹è„šæ‰‹æ¶, ä¸‹ä¸€æ­¥å°±æ˜¯è¿›è¡Œæ•°æ®åº“è®¾è®¡.

ã€€ã€€Cyber Terminal ä¸ CTFd æœ€å¤§çš„åŒºåˆ«å°±æ˜¯æ‹¥æœ‰ä¸¾åŠç”šè‡³åŒæ—¶ä¸¾åŠå¤šåœºæ¯”èµ›çš„èƒ½åŠ›, åŒæ—¶èƒ½å¤Ÿè‡ªåŠ¨è¿›è¡Œé¢˜ç›®å½’æ¡£ç­‰å·¥ä½œ. æ‰€ä»¥æ•°æ®åº“è®¾è®¡ä¸Šé™¤äº†å‚è€ƒ CTFd çš„ç°æœ‰è®¾è®¡ä¹‹å¤–, è¿˜è¦å¤šå‡ºä¸€äº›è€ƒè™‘.

ã€€ã€€å…·ä½“çš„æ•°æ®åº“è®¾è®¡å¦‚ä¸‹:

![æ•°æ®åº“E-R](https://files.catbox.moe/ex7kst.png)

ã€€ã€€æ•´ä½“ç½‘ç«™æ¶æ„çš„è®¾è®¡å¦‚ä¸‹:

![ç½‘ç«™æ¶æ„](https://files.catbox.moe/djxw7h.png)

ã€€ã€€å…¶ä¸­å°† game å’Œ category åˆ†å¼€å±äºè®¾è®¡å¤±è¯¯, æ‰“ç®—åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬æ›´æ–°ä¸­è¿ç§»åˆå¹¶.

ã€€ã€€å½“æ—¶è®¾è®¡çš„æ—¶å€™æˆ‘æƒ³ç€, å¦‚æœè¦ç»™å¹³å°æ·»åŠ ç»ƒä¹ åœºçš„è¯, åº”å½“æœ‰ä¸€ä¸ªâ€œåˆ†ç±»â€çš„æ¦‚å¿µ, è€Œæ¯”èµ›å½’æ¡£æ—¶åˆšå¥½å°±å¯ä»¥ä½œä¸ºåŒä¸€ä¸ªâ€œåˆ†ç±»â€è€Œå½’æ¡£. è€Œå¯¹äºé¢˜ç›®æœ¬èº«çš„æ€§è´¨è€Œè¨€, ä¸€é“é¢˜ç›®åªèƒ½å½’ç±»äºä¸€ä¸ªâ€œåˆ†ç±»â€æœ‰äº›ç”Ÿç¡¬, äºæ˜¯æˆ‘å°†ç±»ä¼¼äºâ€œwebâ€ã€â€œpwnâ€è¿™ä¸€ç±»æ¦‚å¿µä»â€œcategoryâ€æ”¹ä¸ºäº†â€œtagâ€, è¿™æ ·ä¸€é“é¢˜ç›®å°±å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾, ä¹Ÿèµ·åˆ°äº†åˆ†ç±»çš„ä½œç”¨. è€ŒåŸæœ‰çš„åˆ†ç±», å°±ä½œä¸ºç»„ç»‡é¢˜ç›®æ¥æºçš„ä¸€ç§æ–¹å¼æ¥ä½¿ç”¨. ä½†æ˜¯åæ¥åœ¨å®ç°ä¸Šå‘ç° category ä¸ game æœ¬èº«å°±æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³», ä½†æ˜¯ç”±äºæ‹†åˆ†å¼€äº†, ä¸ºæ•°æ®åº“æ“ä½œå¢æ·»äº†è®¸å¤šä¸ä¾¿, å±äºå®Œå…¨å¤šä½™çš„è®¾è®¡, è¿˜ä¸ºæ­¤å†™äº†å¾ˆå¤šå±å±±ä»£ç .

ã€€ã€€CTFçš„é¢˜ç›®ç±»å‹æ¯”è¾ƒå¤šæ ·, æœ‰é™æ€é™„ä»¶é¢˜ç›®, åŠ¨æ€å®¹å™¨é¢˜ç›®, è¿˜æœ‰ä¹‹å‰ä¸ºäº†åä½œå¼Šå®ç°çš„åŠ¨æ€é™„ä»¶é¢˜ç›®, ç”šè‡³è¿˜åŒ…æ‹¬ä¸€äº›éœ€è¦è¯„æµ‹çš„ACMé¢˜, æ€»ä½“æ¥è¯´éœ€æ±‚å„ä¸ç›¸åŒ. äºæ˜¯æˆ‘è®¾è®¡äº†â€œcheckerâ€æ¥è¡¨ç¤ºä¸åŒçš„é¢˜ç›®ç±»å‹, é¢˜ç›®å¯ä»¥é€šè¿‡å¤šæ€å…³è”åˆ°æŸä¸ªç‰¹å®šç±»å‹çš„ checker ä¸Š, ç„¶åä¸ checker ç›¸å…³çš„æ•°æ®å°±ç›´æ¥å­˜åœ¨å¯¹åº” checker å®ç°ä¸­. è€Œ checker åœ¨å…·ä½“ä½¿ç”¨ä¸­ä¹Ÿè¦æœ‰é’ˆå¯¹ challenge çš„æ•°æ®å­˜å‚¨ä¸é’ˆå¯¹ user çš„æ•°æ®å­˜å‚¨, æˆ‘åœ¨è¿™é‡Œè®¾è®¡äº† checkerConfig å’Œ checkerSession . å‰è€…ç”¨æ¥ä¸challengeä¸€å¯¹ä¸€å…³è”, å­˜å‚¨è¯¥ç±»å‹é¢˜ç›®çš„ç›¸å…³è®¾å®š, ä¾‹å¦‚é™æ€ flag ã€åŠ¨æ€ flag æ¨¡æ¿ã€é™æ€é™„ä»¶ã€å®¹å™¨é¢˜ç›®çš„ docker é•œåƒä¸é…ç½®ç­‰ç­‰ç­‰, è€Œ session åˆ™æ˜¯ä¸ challenge+user è¿›è¡Œå”¯ä¸€å…³è”, å½“ user å°è¯•è®¿é—® challenge çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨å»ºç«‹æ­¤æ¨¡å‹, é‡Œé¢å¯ä»¥å­˜æ”¾ä¸€æ¬¡æ€§ç”Ÿæˆçš„åŠ¨æ€flagã€å·²å¯åŠ¨å®¹å™¨çš„çŠ¶æ€ä¸è®¿é—®æ–¹å¼ç­‰ç­‰ç­‰.

ã€€ã€€checker çš„ç»„ç»‡æ–¹å¼ä¸ CTFd ç¨æœ‰ä¸åŒ, CTFd å°† é¢˜ç›®ã€flagç±»å‹ ç­‰éƒ½é€šè¿‡æš´éœ²å†…éƒ¨APIçš„æ–¹å¼æä¾›ç»™æ’ä»¶å®ç°, æˆ‘è§‰å¾—ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆå¿…è¦, ç´¢æ€§å°±ç»„åˆæˆä¸ºä¸€ä¸ª checker. åŒæ—¶ CTFd æ˜¯ä¸å…·å¤‡ session ç®¡ç†èƒ½åŠ›çš„, éœ€è¦åœ¨æ’ä»¶ä¸­è‡ªè¡Œç®¡ç†æ•°æ®åº“, æ—¢ç„¶è¿™æ ·ä¸å¦‚ç›´æ¥æŠŠè¿™ä¸ªæ¦‚å¿µä¸€èµ·åšè¿›å».

## å¼€å‘æ—¥è®° 01

> **ğŸ‘´è„‘å­çœŸçš„æ˜¯æŠ½æŠ½äº†æ‰ä¼šç”¨ GORM**

ã€€ã€€æ—¶é—´å›åˆ°å…­æœˆ, ğŸ‘´å¥½ä¸å®¹æ˜“å¿™å®Œæ‰‹å¤´çš„päº‹, æ‰“ç®—å¼€å¹². å…ˆæ˜¯èŠ±åŠå¤©æ—¶é—´ç¡®å®šäº†æŠ€æœ¯æ ˆã€æ¡†æ¶ä¹‹ç±»çš„ä¸œè¥¿, ç„¶åè®¾è®¡äº†ä¸€ä¸‹æ•°æ®åº“ç»“æ„, å°±å¼€å§‹ä¸Šæ‰‹å†™åç«¯.

ã€€ã€€åœ¨å†™çš„æ—¶å€™ä¸ºäº†å›¾æ–¹ä¾¿, å°±æ‰¾äº†ä¸€ä¸ªçœ‹ä¼¼å¾ˆå¥½ç”¨å¾ˆnbçš„ [GORM](https://gorm.io/). ç»“æœå†™å››è¡Œä»£ç èƒ½è¸©ä¿©å‘.

> ä¸ºä»€ä¹ˆæ˜¯å››è¡Œä»£ç ï¼Ÿæœ‰ä¸‰è¡Œæ˜¯ `if err != nil { return nil, err }`â€‹

ã€€ã€€é¦–å…ˆ, GORM çš„APIå¹¶ä¸æ˜¯ç»Ÿä¸€çš„:

```go
// è¿”å›å€¼æ˜¯ *Cmd, å¯ä»¥ç»§ç»­å¾€åé“¾å¼è°ƒç”¨, è™½ç„¶ä¸çŸ¥é“éƒ½å†™åˆ°Firstäº†åé¢è¿˜èƒ½æœ‰ä»€ä¹ˆ
// å¦‚æœæƒ³è·å–åˆ°è¿™ä¸€è¡Œçš„é”™è¯¯æ—¶, è¦ä½¿ç”¨ *Cmd.Error, è¿”å›ç±»å‹ä¸º errors.Error
err := db.Model(&models.User{}).Where("name = ? and verified = ?", name, true).First(&user).Error

// ä½†æ˜¯åœ¨ Association API ä¸­, è¿”å›å€¼ç›´æ¥å°±æ˜¯ errors.Error, è¿™ä¸ªæ—¶å€™å¦‚æœå†å¾€åé¢æ¥ä¸€ä¸ª Error(), ç»“æœå°±æ˜¯errå­—ç¬¦ä¸²
err := db.Model(&models.Team{}).Where("id = ?", teamID).Association("Users").Find(&users)
```

ã€€ã€€å…¶æ¬¡, ä»–è‡ªå·±æ–‡æ¡£é‡Œçš„å®ä¾‹è·‘ä¸åŠ¨:

ã€€ã€€[GORM: Customize Data Types](https://gorm.io/docs/data_types.html)

```go
// é‡Œé¢æœ‰è¿™ä¹ˆä¸€æ®µç”¨æ¥è‡ªå®šä¹‰JSONå­—æ®µçš„ä¸œè¥¿
type JSON json.RawMessage

// Scan scan value into Jsonb, implements sql.Scanner interface
func (j *JSON) Scan(value interface{}) error {
  // è¿™é‡Œå°±æœ‰é—®é¢˜, å®é™…ä¸Š value æ˜¯ä¸ªstr, äºæ˜¯è½¬æ¢å¤±è´¥ç›´æ¥å¯„äº†
  bytes, ok := value.([]byte)
  if !ok {
    return errors.New(fmt.Sprint("Failed to unmarshal JSONB value:", value))
  }

  result := json.RawMessage{}
  err := json.Unmarshal(bytes, &result)
  *j = JSON(result)
  return err
}

func (j JSON) Value() (driver.Value, error) {
  if len(j) == 0 {
    return nil, nil
  }

  // ä½†æ˜¯å¾ˆå¥‡æ€ªçš„æ˜¯è¿™é‡Œåå‡ºå»çš„æ˜¯ä¸ª []byte, ğŸ‘´æ€€ç–‘æ˜¯ä»–ä»æ•°æ®åº“é‡Œå–æ•°æ®çš„æ—¶å€™æ²¡æœ‰ä¿è¯å‰åä¸€è‡´
  return json.RawMessage(j).MarshalJSON()
}
```

ã€€ã€€å†ç„¶å, é‚£ä¸ª[å…³è”æ¨¡å¼ (Association Mode)](https://gorm.io/docs/associations.html)å°±æ˜¯ä¸ªåŠæˆå“.

ã€€ã€€æ ¹æ®ğŸ‘´ä¸å¤šçš„æ•°æ®åº“åŸç†åˆ†æ•°, ğŸ‘´æƒ³èµ·æ¥æ•°æ®åº“çš„å…³ç³»æ¨¡å‹åˆ†ä¸ºä¸‰ç§: ä¸€å¯¹ä¸€, ä¸€å¯¹å¤š, å¤šå¯¹å¤š. ç»“æœæ‰“å¼€æ–‡æ¡£ä¸€çœ‹æœ‰å››ç§: `belongs to`â€‹, `has one`â€‹, `has many`â€‹, `many to many`â€‹, å“å¾—æˆ‘åˆå»æœäº†ä¸€ä¸‹`what is the difference between has one and belongs to?`â€‹å‡ºæ¥çš„é“¾æ¥é™¤äº†ç¬¬ä¸€ä¸ªæ˜¯ ThinkPHP5, å‰©ä¸‹å…¨æ˜¯ GORM.

> ğŸ‘´: è‰, æˆ‘æ•°æ®åº“åŸç†ç™½å­¦äº†
>
> (æœ)
>
> ğŸ‘´: . . .
>
> ğŸ‘´: ä»€ä¹ˆè‡ªåˆ›å…³ç³»æ¨¡å‹

ã€€ã€€ç„¶åğŸ‘´æƒ³ç€åº”è¯¥å¤§å·®ä¸å·®, å‡­æ„Ÿè§‰å†™ä¸€å†™, åœ¨ä¹‹å‰çš„è®¾è®¡ä¸­, submissionå’Œuserä¸challengeéƒ½æ˜¯ä¸€å¯¹å¤šå…³ç³», åœ¨ä½¿ç”¨åœºæ™¯ä¸‹ä¹Ÿéœ€è¦æ ¹æ®submissionæŸ¥useræˆ–è€…æ ¹æ®useræŸ¥submission.

> ğŸ‘´: é‚£ submission belongs to challenge, challenge has many submissions
>
> ğŸ‘´: æ²¡æ¯›ç—…
>
> (å†™ã€è·‘ã€å¯„äº†, è‰)
>
> ğŸ‘´: ï¼Ÿ

ã€€ã€€ä»”ç»†è¯»äº†ä¸€éæ–‡æ¡£, å‘ç° belongs to å’Œ has one éƒ½å±äºä¸€å¯¹ä¸€å…³ç³», çœ‹æ¥æ˜¯ğŸ‘´è¯»æ–‡æ¡£ä¸ä»”ç»†, æŒ¨ä¸€é”¤.

ã€€ã€€äºæ˜¯ğŸ‘´ä»”ç»†çœ‹äº†çœ‹ä¸¤ä¸ªä¸€å¯¹ä¸€å…³ç³»æœ‰å•¥åŒºåˆ«:

```go
// æ–‡æ¡£é‡Œè¿™ä¸ªå« belongs to
type Game struct {
  ID uint
  ...
  Category *Category // <-
  CategoryID uint
}

type Category {
  ID uint
  ...
}

// è¿™ä¸ªå« has one
type Game struct {
  ID uint
  ...
  CategoryID uint
}

type Category {
  ID uint
  ...
  Game *Game // <-
}
```

ã€€ã€€å»ºå‡ºæ¥çš„æ•°æ®è¡¨éƒ½æ˜¯ `games`â€‹ ä¸­æœ‰ä¸€ä¸ª `category_id`â€‹ åˆ—, å’Œå®Œå…¨ç›¸åŒçš„å…³è”çº¦æŸ, åŒºåˆ«åªæ˜¯ä¸€ä¸ªGameç»“æ„ä½“é‡ŒåŒ…å«Category, ä¸€ä¸ªCategoryç»“æ„ä½“é‡ŒåŒ…å«Game.

> ğŸ‘´: è¿™æœ‰å•¥åŒºåˆ«ï¼Ÿå¥‡æ€ªçš„featureğŸ
>
> ğŸ‘´: é‚£ğŸ‘´åªå†™ä¸€ä¸ªé”®, åœ¨ä¸¤è¾¹éƒ½å†…ç½®ä¸€ä¸ªå¯¹é¢çš„ç»“æ„ä½“æŒ‡é’ˆåº”è¯¥æ²¡äº‹å§, è¿™é‡Œé¢è¦åŠ è½½å¦ä¸€ä¸ªè¡¨éœ€è¦æ˜¾å¼preloadçš„, å€’ä¹Ÿä¸ä¼šå¾ªç¯å¼•ç”¨
>
> (å†™ã€è·‘ã€å¯„äº†, è‰)
>
> ğŸ‘´: ********************

ã€€ã€€äºæ˜¯å‡ºç°äº†ä¸€ä¸ªå°´å°¬çš„æƒ…å†µ, æ— è®ºç”¨å“ªç§æ–¹å¼, éƒ½åªèƒ½åœ¨ä¸€ä¸ªæ•°æ®æ¨¡å‹ä¸Šä½¿ç”¨ Association Mode, å¦ä¸€ä¸ªæ¨¡å‹åªèƒ½æ‰‹åŠ¨è¿‡æ»¤åˆ—:

```go
// ç”¨ Association é€šè¿‡ game æŸ¥ category, å½³äº
db.Model(&models.Game{}).Where("id = ?", gameID).Association(&models.Category{}).First(&category)
// ç”¨ Association é€šè¿‡category æŸ¥ game, çœŸä¸å½³äº
db.Model(&models.Category{}).Joins("inner join games on games.category_id = categories.id and categories.id = ?", categoryID).First(&game)
// é‚£ğŸ‘´å¹²å˜›ä¸è¿™æ ·å†™
db.Model(&models.Game{}).Where("category_id = ?", categoryID).First(&category)
// ğŸ‘´: è¿™ Association Mode å­˜åœ¨çš„æ„ä¹‰æ˜¯å•¥
```

ã€€ã€€åŒç†, has many ä¹Ÿæœ‰è¿™æ ·çš„é—®é¢˜.

ã€€ã€€åœ¨åé¢å¼€å‘çš„æ—¶å€™ğŸ‘´åŸºæœ¬ä¸Šæ˜¯å¼€ç€Debugæ¨¡å¼ä¸€è·¯å†™è¿‡å»çš„, æ¯æ¬¡å†™å®Œéƒ½è¦è·‘ä¸€æ¬¡è®©GORMè¾“å‡ºä¸€ä¸‹ä»–æ„é€ å¥½çš„SQLé•¿ä»€ä¹ˆæ ·, ç¬¦ä¸ç¬¦åˆğŸ‘´çš„é¢„æœŸ, ç„¶åå‘ç°äº†ä¸€å¤§å †å„ç§å„æ ·çš„å¥‡æ€ªé—®é¢˜, è¿™é‡Œå°±ä¸è¯¦è¿°äº†.

> ğŸ‘´: å•¥å•¥å•¥, è¿™å†™çš„æ˜¯ä¸ªå•¥, æ€ä¹ˆUseré‡Œ[åˆ›å»ºçš„æ—¶å€™æœ‰ä¸ªLanguages](https://gorm.io/docs/associations.html#Skip-Auto-Create-x2F-Update)ä¸€ä¼šå„¿[è¿‡æ»¤çš„æ—¶å€™åˆå˜æˆäº†codes](https://gorm.io/docs/associations.html#Find-Associations), ä½ ä»¬å†™æ–‡æ¡£éƒ½ä¸å¸¦ğŸ§ æ”¾ä¸€ä¸‹åŸå§‹ç»“æ„ä½“åˆ°åº•é•¿å•¥æ ·ğŸ
